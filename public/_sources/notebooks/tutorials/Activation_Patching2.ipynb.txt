{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "tnzOT25swIPW"
      },
      "source": [
        "# Activation Patching\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "gli-i24lnP65"
      },
      "source": [
        "üìó You can find an interactive Colab version of this tutorial here.\n",
        "\n",
        "**Activation patching** is a technique used to understand how different parts of a model contribute to its behavior. In an activation patching experiment, we modify or \"patch\" the activations of certain model components and observe the impact on model output.\n",
        "\n",
        "**Activation patching experiments typically follow these steps:**\n",
        "\n",
        "1.   **Baseline Run:** Run the model and record original activations.\n",
        "2.   **Corrupted Run:** Run the model with with a counterfactual (i.e., corrupted) prompt and record the difference in activations.\n",
        "3.   **Patching:** Replace activations at the model component of interest with alternate activations (or zeros, which is sometimes referred to as ablation)."
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "sXQNTqehsbOf"
      },
      "source": [
        "By systematically testing different components this way, researchers can determine how information flows through the model. One common use case is **circuit identification**, where a circuit is a subgraph of a full model that is responsible for a specific and human-interpretable task (e.g., detecting whether an input is in English). Activation patching can help identify which model components are essential for model performance on a given task.\n",
        "\n",
        "\n",
        "In this tutorial, we use `nnsight` to perform a simple activation patching experiment using an indirect object identification (IOI) task."
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "pbcxjuJj9BWa"
      },
      "source": [
        "## Note: IOI Task\n",
        "\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "qFeF4rnSnMfG"
      },
      "source": [
        "Activation patching was used to find the [Indirect Object Identification](https://openreview.net/forum?id=NpsVSN6o4ul) (IOI) circuit in GPT-2 small. IOI is a natural language task in which a model predicts the indirect object in a sentence. IOI tasks typically involve identifying the indirect object from two names introduced in an initial dependent clause. One name (e.g. \"Mary\") is the subject (S1), and the other name (e.g. \"John\") is the indirect object (IO). In the main clause, a second occurrence of the subject (S2) typically performs an action involving the exchange of an item. The sentence always ends with the preposition \"to,\" and the task is to correctly complete it by identifying the non-repeated name (IO).\n",
        "\n",
        "In this exercise, we will use the following 'clean' prompt:\n",
        "\n",
        "```\n",
        "\"After John and Mary went to the store, Mary gave a bottle of milk to\"\n",
        "```\n",
        "This prompt's correct answer (and thus its indirect object) is: `\" John\"`\n",
        "\n",
        "We will also use a corrupted prompt to test how activation patching works. This corrupted prompt will switch the identity of the indirect object, so we can test how the model responds to this change.\n",
        "```\n",
        "\"After John and Mary went to the store, John gave a bottle of milk to\"\n",
        "```\n",
        "This prompt's correct answer (and thus its indirect object) is: `\" Mary\"`"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "MdqVQzIxyKKt"
      },
      "source": [
        "![](images/Activation_patching-figure1.png)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "7WBa0Bg9tIR5"
      },
      "source": [
        "![](https://drive.google.com/uc?export=view&id=1U0vHF35nPSU_BUL0h9g9aJBAPXSpBOJ1)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "hA0AmNS_9eBT"
      },
      "source": [
        "# Set Up"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 1,
      "metadata": {
        "id": "lzr3BglC-2VL"
      },
      "outputs": [],
      "source": [
        "from IPython.display import clear_output\n",
        "!pip install -U nnsight\n",
        "\n",
        "clear_output()"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "rzkBzBNH-0OY"
      },
      "source": [
        "Let's start with our imports:"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 2,
      "metadata": {
        "id": "l8WfCzQhwFM0"
      },
      "outputs": [],
      "source": [
        "import plotly.express as px\n",
        "import plotly.io as pio\n",
        "pio.renderers.default = \"plotly_mimetype+notebook_connected+colab\"\n",
        "from nnsight import LanguageModel, util\n",
        "from nnsight.tracing.Proxy import Proxy"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 4,
      "metadata": {
        "id": "qLmX2tdZmgiz"
      },
      "outputs": [],
      "source": [
        "# Load gpt2\n",
        "model = LanguageModel(\"openai-community/gpt2\", device_map=\"auto\")\n",
        "clear_output()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 5,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "dXoRKLdtmtmN",
        "outputId": "14bbc80f-c6d1-48ce-a3ba-712d7edff9bb"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "GPT2LMHeadModel(\n",
            "  (transformer): GPT2Model(\n",
            "    (wte): Embedding(50257, 768)\n",
            "    (wpe): Embedding(1024, 768)\n",
            "    (drop): Dropout(p=0.1, inplace=False)\n",
            "    (h): ModuleList(\n",
            "      (0-11): 12 x GPT2Block(\n",
            "        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n",
            "        (attn): GPT2SdpaAttention(\n",
            "          (c_attn): Conv1D()\n",
            "          (c_proj): Conv1D()\n",
            "          (attn_dropout): Dropout(p=0.1, inplace=False)\n",
            "          (resid_dropout): Dropout(p=0.1, inplace=False)\n",
            "        )\n",
            "        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n",
            "        (mlp): GPT2MLP(\n",
            "          (c_fc): Conv1D()\n",
            "          (c_proj): Conv1D()\n",
            "          (act): NewGELUActivation()\n",
            "          (dropout): Dropout(p=0.1, inplace=False)\n",
            "        )\n",
            "      )\n",
            "    )\n",
            "    (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n",
            "  )\n",
            "  (lm_head): Linear(in_features=768, out_features=50257, bias=False)\n",
            "  (generator): WrapperModule()\n",
            ")\n"
          ]
        }
      ],
      "source": [
        "print(model)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "Y_pAjqKL96NK"
      },
      "source": [
        "Next up, we define our clean prompt and our corrupted prompt. As prompts may be associated with many different feature circuits (i.e., circuits responsible for IOI, deciding if the language is English, or prompt refusal), choosing a counterfactual prompt with only changes directly related your feature of interest is essential.\n",
        "\n",
        "Here, we switch the name of the repeated subject, thus swapping out the indirect object for our IOI task:"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 6,
      "metadata": {
        "id": "7FrduLBCmhOp"
      },
      "outputs": [],
      "source": [
        "clean_prompt = \"After John and Mary went to the store, Mary gave a bottle of milk to\"\n",
        "corrupted_prompt = (\n",
        "    \"After John and Mary went to the store, John gave a bottle of milk to\"\n",
        ")"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "cxyrVWSJ-Goc"
      },
      "source": [
        "We then use the tokenizer on the two words of interest (‚ÄúJohn‚Äù and ‚ÄúMary‚Äù) to find the token that represents them. That way we can grab the prediction for these two tokens and compare. Because our prompts don't end in a space, make sure to add a space before each word (i.e., the combined space + word token is what we're looking for).\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 7,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "IgB5EzZZmkFU",
        "outputId": "85eb468b-d12f-42f5-d9ad-32d7986bcea2"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "' John': 1757\n",
            "' Mary': 5335\n"
          ]
        }
      ],
      "source": [
        "correct_index = model.tokenizer(\" John\")[\"input_ids\"][0] # includes a space\n",
        "incorrect_index = model.tokenizer(\" Mary\")[\"input_ids\"][0] # includes a space\n",
        "\n",
        "print(f\"' John': {correct_index}\")\n",
        "print(f\"' Mary': {incorrect_index}\")"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "gJEspN58_MwI"
      },
      "source": [
        "# Patching Experiment\n",
        "Now we can run the actual patching intervention! What does this even mean?\n",
        "\n",
        "We now have two prompts, a \"clean\" one and a \"corrupted\" one. Intuitively, the model output for each of these prompts should be different: we'd expect the model to answer \"John\" for the clean prompt and \"Mary\" for the corrupted prompt.\n",
        "\n",
        "\n",
        "In this experiment, we run the model with the clean prompt as an input and then (1) get each layer's output value (i.e., residual stream) and (2) calculate the logit difference between the correct and incorrect answers for this run. Next, we calculate the logit difference between the correct and incorrect answers for the corrupted prompt."
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "Mz0cqHkYAoCf"
      },
      "source": [
        "## Step 1: Clean Run"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "C0cdZm8LBCQR"
      },
      "source": [
        "First, we run the model with the **clean prompt**:\n",
        "\n",
        "`\"After John and Mary went to the store, Mary gave a bottle of milk to\"`\n",
        "\n",
        "During this clean run, we collect the final output of each layer. We also record the logit difference in the final model output between the correct answer token `\" John\"` and the incorrect token `\" Mary\"`."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 8,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 119,
          "referenced_widgets": [
            "f079ab3fa1134359b74cc7067b31ec2c",
            "45dbf06de8484628871dc530bd315972",
            "fdda7734cb2748b5a4c7bcfddcd07746",
            "896f138acb7c43bd85719203ce768e76",
            "a6c9c22f75764763bf3c5dd55820e587",
            "0c6ded3e7db74a8da985523bd7d2a6f1",
            "9c7ee0204d6c4b2ca435a989b98de661",
            "6179ed1bccc44989a94553920cc74c9e",
            "ea293e974aa14858ab422586abbd8b93",
            "599f3b7e473b4f7995a563213809c7f8",
            "c6240e4b5e1c43808ace93a3b3d2e448",
            "7a5f64126ec74db3bb9d04013fde3b45",
            "ee797c3fb6f741fd8b1efa12d8e97797",
            "29005f86684c442cb6ab02dbb14b5e4e",
            "87ada532e0d3401c97245392f9a939b7",
            "9b5c932896a5428a938ffd93db39278d",
            "70a5e90548774a71bdb7612d5aeb06c6",
            "63d58245a1c04c4db74bd0b3313bc223",
            "ee68c445fe0042b4875091aafe690480",
            "58d3a28df74e4ad0857afad43bf772c9",
            "7b2a0288b78b46f48641c510634ae797",
            "c78f29d579c541bb8f5f4ed1cf69b2fb"
          ]
        },
        "id": "b5nPZ1ZxABUg",
        "outputId": "e7d2ac36-0df1-4c9f-f74e-012c41c32f0c"
      },
      "outputs": [
        {
          "data": {
            "application/vnd.jupyter.widget-view+json": {
              "model_id": "f079ab3fa1134359b74cc7067b31ec2c",
              "version_major": 2,
              "version_minor": 0
            },
            "text/plain": [
              "model.safetensors:   0%|          | 0.00/548M [00:00<?, ?B/s]"
            ]
          },
          "metadata": {},
          "output_type": "display_data"
        },
        {
          "data": {
            "application/vnd.jupyter.widget-view+json": {
              "model_id": "7a5f64126ec74db3bb9d04013fde3b45",
              "version_major": 2,
              "version_minor": 0
            },
            "text/plain": [
              "generation_config.json:   0%|          | 0.00/124 [00:00<?, ?B/s]"
            ]
          },
          "metadata": {},
          "output_type": "display_data"
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.\n"
          ]
        }
      ],
      "source": [
        "N_LAYERS = len(model.transformer.h)\n",
        "\n",
        "# Clean run\n",
        "with model.trace(clean_prompt) as tracer:\n",
        "    clean_tokens = tracer.invoker.inputs[0]['input_ids'][0]\n",
        "\n",
        "    # Get hidden states of all layers in the network.\n",
        "    # We index the output at 0 because it's a tuple where the first index is the hidden state.\n",
        "\n",
        "    clean_hs = [\n",
        "        model.transformer.h[layer_idx].output[0].save()\n",
        "        for layer_idx in range(N_LAYERS)\n",
        "    ]\n",
        "\n",
        "    # Get logits from the lm_head.\n",
        "    clean_logits = model.lm_head.output\n",
        "\n",
        "    # Calculate the difference between the correct answer and incorrect answer for the clean run and save it.\n",
        "    clean_logit_diff = (\n",
        "        clean_logits[0, -1, correct_index] - clean_logits[0, -1, incorrect_index]\n",
        "    ).save()"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "KlSpu0GUBOJq"
      },
      "source": [
        "## Step 2: Corrupted Run"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "_hURjVzMBVrD"
      },
      "source": [
        "Next, we run the model using the **corrupted** input prompt:\n",
        "\n",
        " `\"After John and Mary went to the store, John gave a bottle of milk to\"`\n",
        "\n",
        " During this corrupted run, we collect the logit difference in the final model output between the correct and incorrect answer tokens\n",
        "\n",
        " Note: because we are testing changes induced by the corrupted prompt, the target answers remain the same as in the clean run. That is, the correct token is still `\" John\"` and the incorrect token is still `\" Mary\"`."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 9,
      "metadata": {
        "id": "JodVtd5VAuo2"
      },
      "outputs": [],
      "source": [
        "# Corrupted run\n",
        "with model.trace(corrupted_prompt) as tracer:\n",
        "    corrupted_logits = model.lm_head.output\n",
        "\n",
        "    # Calculate the difference between the correct answer and incorrect answer for the corrupted run and save it.\n",
        "    corrupted_logit_diff = (\n",
        "        corrupted_logits[0, -1, correct_index]\n",
        "        - corrupted_logits[0, -1, incorrect_index]\n",
        "    ).save()"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "N21Sjtz5BQV5"
      },
      "source": [
        "## Step 3: Activation Patching Intervention"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "1b-aAj7m-2pK"
      },
      "source": [
        "Finally, we perform our **activation patching** procedure. For each token position in the clean prompt, we loop through all layers of the model. Within each layer, we run a forward pass using the corrupted prompt, and patch in the corresponding activation from our clean run at the given token position. We then collect the final output difference between the correct and incorrect answer tokens for each patched activation."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 10,
      "metadata": {
        "id": "1vuK3rEMAug_"
      },
      "outputs": [],
      "source": [
        "# Activation Patching Intervention\n",
        "ioi_patching_results = []\n",
        "\n",
        "# Iterate through all the layers\n",
        "for layer_idx in range(len(model.transformer.h)):\n",
        "    _ioi_patching_results = []\n",
        "\n",
        "    # Iterate through all tokens\n",
        "    for token_idx in range(len(clean_tokens)):\n",
        "        # Patching corrupted run at given layer and token\n",
        "        with model.trace(corrupted_prompt) as tracer:\n",
        "            # Apply the patch from the clean hidden states to the corrupted hidden states.\n",
        "            model.transformer.h[layer_idx].output[0][:, token_idx, :] = clean_hs[layer_idx][:, token_idx, :]\n",
        "\n",
        "            patched_logits = model.lm_head.output\n",
        "\n",
        "            patched_logit_diff = (\n",
        "                patched_logits[0, -1, correct_index]\n",
        "                - patched_logits[0, -1, incorrect_index]\n",
        "            )\n",
        "\n",
        "            # Calculate the improvement in the correct token after patching.\n",
        "            patched_result = (patched_logit_diff - corrupted_logit_diff) / (\n",
        "                clean_logit_diff - corrupted_logit_diff\n",
        "            )\n",
        "\n",
        "            _ioi_patching_results.append(patched_result.save())\n",
        "\n",
        "    ioi_patching_results.append(_ioi_patching_results)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "EhhSwrEL_z69"
      },
      "source": [
        "### Note: Optimize workflow with NNsight batching"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "UqHhcwsOBLPn"
      },
      "source": [
        "Although we broke up the workflow for ease of understanding, we can use `nnsight` to further speed up computation.\n",
        "\n",
        "Thanks to `nnsight`, the whole experiment can happen in one forward pass by breaking up inputs into multiple invocation calls and batching them."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 11,
      "metadata": {
        "id": "G60gi4ZUmxlG"
      },
      "outputs": [],
      "source": [
        "N_LAYERS = len(model.transformer.h)\n",
        "\n",
        "# Enter nnsight tracing context\n",
        "with model.trace() as tracer:\n",
        "\n",
        "    # Clean run\n",
        "    with tracer.invoke(clean_prompt) as invoker:\n",
        "        clean_tokens = invoker.inputs[0]['input_ids'][0]\n",
        "\n",
        "        # No need to call .save() as we don't need the values after the run, just within the experiment run.\n",
        "        clean_hs = [\n",
        "            model.transformer.h[layer_idx].output[0]\n",
        "            for layer_idx in range(N_LAYERS)\n",
        "        ]\n",
        "\n",
        "        # Get logits from the lm_head.\n",
        "        clean_logits = model.lm_head.output\n",
        "\n",
        "        # Calculate the difference between the correct answer and incorrect answer for the clean run and save it.\n",
        "        clean_logit_diff = (\n",
        "            clean_logits[0, -1, correct_index] - clean_logits[0, -1, incorrect_index]\n",
        "        ).save()\n",
        "\n",
        "    # Corrupted run\n",
        "    with tracer.invoke(corrupted_prompt) as invoker:\n",
        "        corrupted_logits = model.lm_head.output\n",
        "\n",
        "        # Calculate the difference between the correct answer and incorrect answer for the corrupted run and save it.\n",
        "        corrupted_logit_diff = (\n",
        "            corrupted_logits[0, -1, correct_index]\n",
        "            - corrupted_logits[0, -1, incorrect_index]\n",
        "        ).save()\n",
        "\n",
        "    ioi_patching_results = []\n",
        "\n",
        "    # Iterate through all the layers\n",
        "    for layer_idx in range(len(model.transformer.h)):\n",
        "        _ioi_patching_results = []\n",
        "\n",
        "        # Iterate through all tokens\n",
        "        for token_idx in range(len(clean_tokens)):\n",
        "            # Patching corrupted run at given layer and token\n",
        "            with tracer.invoke(corrupted_prompt) as invoker:\n",
        "                # Apply the patch from the clean hidden states to the corrupted hidden states.\n",
        "                model.transformer.h[layer_idx].output[0][:, token_idx, :] = clean_hs[layer_idx][:, token_idx, :]\n",
        "\n",
        "                patched_logits = model.lm_head.output\n",
        "\n",
        "                patched_logit_diff = (\n",
        "                    patched_logits[0, -1, correct_index]\n",
        "                    - patched_logits[0, -1, incorrect_index]\n",
        "                )\n",
        "\n",
        "                # Calculate the improvement in the correct token after patching.\n",
        "                patched_result = (patched_logit_diff - corrupted_logit_diff) / (\n",
        "                    clean_logit_diff - corrupted_logit_diff\n",
        "                )\n",
        "\n",
        "                _ioi_patching_results.append(patched_result.save())\n",
        "\n",
        "        ioi_patching_results.append(_ioi_patching_results)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "keP4Xhl9A4pV"
      },
      "source": [
        "## Visualize Results"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "pnyt3T0HnJoD"
      },
      "source": [
        "Let's define a function to plot our activation patching results."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 12,
      "metadata": {
        "id": "EaHSh6ctnJFl"
      },
      "outputs": [],
      "source": [
        "def plot_ioi_patching_results(model,\n",
        "                              ioi_patching_results,\n",
        "                              x_labels,\n",
        "                              plot_title=\"Normalized Logit Difference After Patching Residual Stream on the IOI Task\"):\n",
        "\n",
        "    ioi_patching_results = util.apply(ioi_patching_results, lambda x: x.value.item(), Proxy)\n",
        "    fig = px.imshow(\n",
        "        ioi_patching_results,\n",
        "        color_continuous_midpoint=0.0,\n",
        "        color_continuous_scale=\"RdBu\",\n",
        "        labels={\"x\": \"Position\", \"y\": \"Layer\",\"color\":\"Norm. Logit Diff\"},\n",
        "        x=x_labels,\n",
        "        title=plot_title,\n",
        "    )\n",
        "\n",
        "    # fig.show()\n",
        "    return fig"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "1BYi7ceZCAvB"
      },
      "source": [
        "Let's see how the patching intervention changes the logit difference! Let's use a heatmap to examine how the logit difference changes after patching each layer's output across token positions."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 13,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 578
        },
        "id": "hcYwRtSvmyVm",
        "outputId": "1ee9ed9a-ac21-4346-cfb9-a53988b5ae1f"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Clean logit difference: 4.124\n",
            "Corrupted logit difference: -2.272\n"
          ]
        },
        {
          "data": {
            "text/html": [
              "        <script type=\"text/javascript\">\n",
              "        window.PlotlyConfig = {MathJaxConfig: 'local'};\n",
              "        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\n",
              "        if (typeof require !== 'undefined') {\n",
              "        require.undef(\"plotly\");\n",
              "        requirejs.config({\n",
              "            paths: {\n",
              "                'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']\n",
              "            }\n",
              "        });\n",
              "        require(['plotly'], function(Plotly) {\n",
              "            window._Plotly = Plotly;\n",
              "        });\n",
              "        }\n",
              "        </script>\n",
              "        "
            ]
          },
          "metadata": {},
          "output_type": "display_data"
        },
        {
          "data": {
            "application/vnd.plotly.v1+json": {
              "config": {
                "plotlyServerURL": "https://plot.ly"
              },
              "data": [
                {
                  "coloraxis": "coloraxis",
                  "hovertemplate": "Position: %{x}<br>Layer: %{y}<br>Norm. Logit Diff: %{z}<extra></extra>",
                  "name": "0",
                  "type": "heatmap",
                  "x": [
                    "After_0",
                    " John_1",
                    " and_2",
                    " Mary_3",
                    " went_4",
                    " to_5",
                    " the_6",
                    " store_7",
                    ",_8",
                    " Mary_9",
                    " gave_10",
                    " a_11",
                    " bottle_12",
                    " of_13",
                    " milk_14",
                    " to_15"
                  ],
                  "xaxis": "x",
                  "yaxis": "y",
                  "z": [
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.997467577457428,
                      0.0017654082039371133,
                      -0.00017415513866581023,
                      0.0008946325397118926,
                      0.00002624255466798786,
                      -0.0010878732427954674,
                      -0.00046998029574751854
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.997134804725647,
                      0.0026147128082811832,
                      -0.0004890657728537917,
                      0.0006286284769885242,
                      -0.00006083501284592785,
                      -0.00043658068170771003,
                      -0.0009232608135789633
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.9951009750366211,
                      0.004566204734146595,
                      -0.00023499014787375927,
                      0.0005880718235857785,
                      0.00006202785880304873,
                      -0.00032326055224984884,
                      -0.002199603244662285
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.9868739247322083,
                      0.020100604742765427,
                      0.0006429426139220595,
                      0.0011260441970080137,
                      0.00015506964700762182,
                      0.0006238570786081254,
                      -0.001915706554427743
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.9520822763442993,
                      0.07812169939279556,
                      0.0025813132524490356,
                      0.002135189715772867,
                      0.00046401607687585056,
                      0.0003220677317585796,
                      -0.0014457262586802244
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.9528301954269409,
                      0.07888512313365936,
                      0.0019836986903101206,
                      0.00023260446323547512,
                      0.0002147118211723864,
                      0.00024214721634052694,
                      -0.0049705784767866135
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.9087963700294495,
                      0.10826008021831512,
                      0.004000796936452389,
                      -0.000375745672499761,
                      0.00021709750581067055,
                      0.0005677934386767447,
                      0.00981829408556223
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.6858420372009277,
                      0.03584136441349983,
                      0.0005200797459110618,
                      -0.0008087478345260024,
                      0.00005606363993138075,
                      0.0013085491955280304,
                      0.4153647720813751
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.10977857559919357,
                      0.024683509021997452,
                      0.0003017893759533763,
                      -0.0003566601953934878,
                      0.00027554683038033545,
                      0.0014051694888621569,
                      0.8544576168060303
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.01986919343471527,
                      0.015401993878185749,
                      -0.0001848907268140465,
                      -0.00009542747284285724,
                      0.00002862824112526141,
                      0.0006584495422430336,
                      0.9079399108886719
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.01997893489897251,
                      0.006295827683061361,
                      0.00020994043734390289,
                      -0.0007407557568512857,
                      -0.000040556675230618566,
                      0.0005737576866522431,
                      0.9069057106971741
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      1
                    ]
                  ]
                }
              ],
              "layout": {
                "coloraxis": {
                  "cmid": 0,
                  "colorbar": {
                    "title": {
                      "text": "Norm. Logit Diff"
                    }
                  },
                  "colorscale": [
                    [
                      0,
                      "rgb(103,0,31)"
                    ],
                    [
                      0.1,
                      "rgb(178,24,43)"
                    ],
                    [
                      0.2,
                      "rgb(214,96,77)"
                    ],
                    [
                      0.3,
                      "rgb(244,165,130)"
                    ],
                    [
                      0.4,
                      "rgb(253,219,199)"
                    ],
                    [
                      0.5,
                      "rgb(247,247,247)"
                    ],
                    [
                      0.6,
                      "rgb(209,229,240)"
                    ],
                    [
                      0.7,
                      "rgb(146,197,222)"
                    ],
                    [
                      0.8,
                      "rgb(67,147,195)"
                    ],
                    [
                      0.9,
                      "rgb(33,102,172)"
                    ],
                    [
                      1,
                      "rgb(5,48,97)"
                    ]
                  ]
                },
                "template": {
                  "data": {
                    "bar": [
                      {
                        "error_x": {
                          "color": "#2a3f5f"
                        },
                        "error_y": {
                          "color": "#2a3f5f"
                        },
                        "marker": {
                          "line": {
                            "color": "#E5ECF6",
                            "width": 0.5
                          },
                          "pattern": {
                            "fillmode": "overlay",
                            "size": 10,
                            "solidity": 0.2
                          }
                        },
                        "type": "bar"
                      }
                    ],
                    "barpolar": [
                      {
                        "marker": {
                          "line": {
                            "color": "#E5ECF6",
                            "width": 0.5
                          },
                          "pattern": {
                            "fillmode": "overlay",
                            "size": 10,
                            "solidity": 0.2
                          }
                        },
                        "type": "barpolar"
                      }
                    ],
                    "carpet": [
                      {
                        "aaxis": {
                          "endlinecolor": "#2a3f5f",
                          "gridcolor": "white",
                          "linecolor": "white",
                          "minorgridcolor": "white",
                          "startlinecolor": "#2a3f5f"
                        },
                        "baxis": {
                          "endlinecolor": "#2a3f5f",
                          "gridcolor": "white",
                          "linecolor": "white",
                          "minorgridcolor": "white",
                          "startlinecolor": "#2a3f5f"
                        },
                        "type": "carpet"
                      }
                    ],
                    "choropleth": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "type": "choropleth"
                      }
                    ],
                    "contour": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "colorscale": [
                          [
                            0,
                            "#0d0887"
                          ],
                          [
                            0.1111111111111111,
                            "#46039f"
                          ],
                          [
                            0.2222222222222222,
                            "#7201a8"
                          ],
                          [
                            0.3333333333333333,
                            "#9c179e"
                          ],
                          [
                            0.4444444444444444,
                            "#bd3786"
                          ],
                          [
                            0.5555555555555556,
                            "#d8576b"
                          ],
                          [
                            0.6666666666666666,
                            "#ed7953"
                          ],
                          [
                            0.7777777777777778,
                            "#fb9f3a"
                          ],
                          [
                            0.8888888888888888,
                            "#fdca26"
                          ],
                          [
                            1,
                            "#f0f921"
                          ]
                        ],
                        "type": "contour"
                      }
                    ],
                    "contourcarpet": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "type": "contourcarpet"
                      }
                    ],
                    "heatmap": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "colorscale": [
                          [
                            0,
                            "#0d0887"
                          ],
                          [
                            0.1111111111111111,
                            "#46039f"
                          ],
                          [
                            0.2222222222222222,
                            "#7201a8"
                          ],
                          [
                            0.3333333333333333,
                            "#9c179e"
                          ],
                          [
                            0.4444444444444444,
                            "#bd3786"
                          ],
                          [
                            0.5555555555555556,
                            "#d8576b"
                          ],
                          [
                            0.6666666666666666,
                            "#ed7953"
                          ],
                          [
                            0.7777777777777778,
                            "#fb9f3a"
                          ],
                          [
                            0.8888888888888888,
                            "#fdca26"
                          ],
                          [
                            1,
                            "#f0f921"
                          ]
                        ],
                        "type": "heatmap"
                      }
                    ],
                    "heatmapgl": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "colorscale": [
                          [
                            0,
                            "#0d0887"
                          ],
                          [
                            0.1111111111111111,
                            "#46039f"
                          ],
                          [
                            0.2222222222222222,
                            "#7201a8"
                          ],
                          [
                            0.3333333333333333,
                            "#9c179e"
                          ],
                          [
                            0.4444444444444444,
                            "#bd3786"
                          ],
                          [
                            0.5555555555555556,
                            "#d8576b"
                          ],
                          [
                            0.6666666666666666,
                            "#ed7953"
                          ],
                          [
                            0.7777777777777778,
                            "#fb9f3a"
                          ],
                          [
                            0.8888888888888888,
                            "#fdca26"
                          ],
                          [
                            1,
                            "#f0f921"
                          ]
                        ],
                        "type": "heatmapgl"
                      }
                    ],
                    "histogram": [
                      {
                        "marker": {
                          "pattern": {
                            "fillmode": "overlay",
                            "size": 10,
                            "solidity": 0.2
                          }
                        },
                        "type": "histogram"
                      }
                    ],
                    "histogram2d": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "colorscale": [
                          [
                            0,
                            "#0d0887"
                          ],
                          [
                            0.1111111111111111,
                            "#46039f"
                          ],
                          [
                            0.2222222222222222,
                            "#7201a8"
                          ],
                          [
                            0.3333333333333333,
                            "#9c179e"
                          ],
                          [
                            0.4444444444444444,
                            "#bd3786"
                          ],
                          [
                            0.5555555555555556,
                            "#d8576b"
                          ],
                          [
                            0.6666666666666666,
                            "#ed7953"
                          ],
                          [
                            0.7777777777777778,
                            "#fb9f3a"
                          ],
                          [
                            0.8888888888888888,
                            "#fdca26"
                          ],
                          [
                            1,
                            "#f0f921"
                          ]
                        ],
                        "type": "histogram2d"
                      }
                    ],
                    "histogram2dcontour": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "colorscale": [
                          [
                            0,
                            "#0d0887"
                          ],
                          [
                            0.1111111111111111,
                            "#46039f"
                          ],
                          [
                            0.2222222222222222,
                            "#7201a8"
                          ],
                          [
                            0.3333333333333333,
                            "#9c179e"
                          ],
                          [
                            0.4444444444444444,
                            "#bd3786"
                          ],
                          [
                            0.5555555555555556,
                            "#d8576b"
                          ],
                          [
                            0.6666666666666666,
                            "#ed7953"
                          ],
                          [
                            0.7777777777777778,
                            "#fb9f3a"
                          ],
                          [
                            0.8888888888888888,
                            "#fdca26"
                          ],
                          [
                            1,
                            "#f0f921"
                          ]
                        ],
                        "type": "histogram2dcontour"
                      }
                    ],
                    "mesh3d": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "type": "mesh3d"
                      }
                    ],
                    "parcoords": [
                      {
                        "line": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "parcoords"
                      }
                    ],
                    "pie": [
                      {
                        "automargin": true,
                        "type": "pie"
                      }
                    ],
                    "scatter": [
                      {
                        "fillpattern": {
                          "fillmode": "overlay",
                          "size": 10,
                          "solidity": 0.2
                        },
                        "type": "scatter"
                      }
                    ],
                    "scatter3d": [
                      {
                        "line": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scatter3d"
                      }
                    ],
                    "scattercarpet": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scattercarpet"
                      }
                    ],
                    "scattergeo": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scattergeo"
                      }
                    ],
                    "scattergl": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scattergl"
                      }
                    ],
                    "scattermapbox": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scattermapbox"
                      }
                    ],
                    "scatterpolar": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scatterpolar"
                      }
                    ],
                    "scatterpolargl": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scatterpolargl"
                      }
                    ],
                    "scatterternary": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scatterternary"
                      }
                    ],
                    "surface": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "colorscale": [
                          [
                            0,
                            "#0d0887"
                          ],
                          [
                            0.1111111111111111,
                            "#46039f"
                          ],
                          [
                            0.2222222222222222,
                            "#7201a8"
                          ],
                          [
                            0.3333333333333333,
                            "#9c179e"
                          ],
                          [
                            0.4444444444444444,
                            "#bd3786"
                          ],
                          [
                            0.5555555555555556,
                            "#d8576b"
                          ],
                          [
                            0.6666666666666666,
                            "#ed7953"
                          ],
                          [
                            0.7777777777777778,
                            "#fb9f3a"
                          ],
                          [
                            0.8888888888888888,
                            "#fdca26"
                          ],
                          [
                            1,
                            "#f0f921"
                          ]
                        ],
                        "type": "surface"
                      }
                    ],
                    "table": [
                      {
                        "cells": {
                          "fill": {
                            "color": "#EBF0F8"
                          },
                          "line": {
                            "color": "white"
                          }
                        },
                        "header": {
                          "fill": {
                            "color": "#C8D4E3"
                          },
                          "line": {
                            "color": "white"
                          }
                        },
                        "type": "table"
                      }
                    ]
                  },
                  "layout": {
                    "annotationdefaults": {
                      "arrowcolor": "#2a3f5f",
                      "arrowhead": 0,
                      "arrowwidth": 1
                    },
                    "autotypenumbers": "strict",
                    "coloraxis": {
                      "colorbar": {
                        "outlinewidth": 0,
                        "ticks": ""
                      }
                    },
                    "colorscale": {
                      "diverging": [
                        [
                          0,
                          "#8e0152"
                        ],
                        [
                          0.1,
                          "#c51b7d"
                        ],
                        [
                          0.2,
                          "#de77ae"
                        ],
                        [
                          0.3,
                          "#f1b6da"
                        ],
                        [
                          0.4,
                          "#fde0ef"
                        ],
                        [
                          0.5,
                          "#f7f7f7"
                        ],
                        [
                          0.6,
                          "#e6f5d0"
                        ],
                        [
                          0.7,
                          "#b8e186"
                        ],
                        [
                          0.8,
                          "#7fbc41"
                        ],
                        [
                          0.9,
                          "#4d9221"
                        ],
                        [
                          1,
                          "#276419"
                        ]
                      ],
                      "sequential": [
                        [
                          0,
                          "#0d0887"
                        ],
                        [
                          0.1111111111111111,
                          "#46039f"
                        ],
                        [
                          0.2222222222222222,
                          "#7201a8"
                        ],
                        [
                          0.3333333333333333,
                          "#9c179e"
                        ],
                        [
                          0.4444444444444444,
                          "#bd3786"
                        ],
                        [
                          0.5555555555555556,
                          "#d8576b"
                        ],
                        [
                          0.6666666666666666,
                          "#ed7953"
                        ],
                        [
                          0.7777777777777778,
                          "#fb9f3a"
                        ],
                        [
                          0.8888888888888888,
                          "#fdca26"
                        ],
                        [
                          1,
                          "#f0f921"
                        ]
                      ],
                      "sequentialminus": [
                        [
                          0,
                          "#0d0887"
                        ],
                        [
                          0.1111111111111111,
                          "#46039f"
                        ],
                        [
                          0.2222222222222222,
                          "#7201a8"
                        ],
                        [
                          0.3333333333333333,
                          "#9c179e"
                        ],
                        [
                          0.4444444444444444,
                          "#bd3786"
                        ],
                        [
                          0.5555555555555556,
                          "#d8576b"
                        ],
                        [
                          0.6666666666666666,
                          "#ed7953"
                        ],
                        [
                          0.7777777777777778,
                          "#fb9f3a"
                        ],
                        [
                          0.8888888888888888,
                          "#fdca26"
                        ],
                        [
                          1,
                          "#f0f921"
                        ]
                      ]
                    },
                    "colorway": [
                      "#636efa",
                      "#EF553B",
                      "#00cc96",
                      "#ab63fa",
                      "#FFA15A",
                      "#19d3f3",
                      "#FF6692",
                      "#B6E880",
                      "#FF97FF",
                      "#FECB52"
                    ],
                    "font": {
                      "color": "#2a3f5f"
                    },
                    "geo": {
                      "bgcolor": "white",
                      "lakecolor": "white",
                      "landcolor": "#E5ECF6",
                      "showlakes": true,
                      "showland": true,
                      "subunitcolor": "white"
                    },
                    "hoverlabel": {
                      "align": "left"
                    },
                    "hovermode": "closest",
                    "mapbox": {
                      "style": "light"
                    },
                    "paper_bgcolor": "white",
                    "plot_bgcolor": "#E5ECF6",
                    "polar": {
                      "angularaxis": {
                        "gridcolor": "white",
                        "linecolor": "white",
                        "ticks": ""
                      },
                      "bgcolor": "#E5ECF6",
                      "radialaxis": {
                        "gridcolor": "white",
                        "linecolor": "white",
                        "ticks": ""
                      }
                    },
                    "scene": {
                      "xaxis": {
                        "backgroundcolor": "#E5ECF6",
                        "gridcolor": "white",
                        "gridwidth": 2,
                        "linecolor": "white",
                        "showbackground": true,
                        "ticks": "",
                        "zerolinecolor": "white"
                      },
                      "yaxis": {
                        "backgroundcolor": "#E5ECF6",
                        "gridcolor": "white",
                        "gridwidth": 2,
                        "linecolor": "white",
                        "showbackground": true,
                        "ticks": "",
                        "zerolinecolor": "white"
                      },
                      "zaxis": {
                        "backgroundcolor": "#E5ECF6",
                        "gridcolor": "white",
                        "gridwidth": 2,
                        "linecolor": "white",
                        "showbackground": true,
                        "ticks": "",
                        "zerolinecolor": "white"
                      }
                    },
                    "shapedefaults": {
                      "line": {
                        "color": "#2a3f5f"
                      }
                    },
                    "ternary": {
                      "aaxis": {
                        "gridcolor": "white",
                        "linecolor": "white",
                        "ticks": ""
                      },
                      "baxis": {
                        "gridcolor": "white",
                        "linecolor": "white",
                        "ticks": ""
                      },
                      "bgcolor": "#E5ECF6",
                      "caxis": {
                        "gridcolor": "white",
                        "linecolor": "white",
                        "ticks": ""
                      }
                    },
                    "title": {
                      "x": 0.05
                    },
                    "xaxis": {
                      "automargin": true,
                      "gridcolor": "white",
                      "linecolor": "white",
                      "ticks": "",
                      "title": {
                        "standoff": 15
                      },
                      "zerolinecolor": "white",
                      "zerolinewidth": 2
                    },
                    "yaxis": {
                      "automargin": true,
                      "gridcolor": "white",
                      "linecolor": "white",
                      "ticks": "",
                      "title": {
                        "standoff": 15
                      },
                      "zerolinecolor": "white",
                      "zerolinewidth": 2
                    }
                  }
                },
                "title": {
                  "text": "Patching GPT-2-small Residual Stream on IOI task"
                },
                "xaxis": {
                  "anchor": "y",
                  "constrain": "domain",
                  "domain": [
                    0,
                    1
                  ],
                  "scaleanchor": "y",
                  "title": {
                    "text": "Position"
                  }
                },
                "yaxis": {
                  "anchor": "x",
                  "autorange": "reversed",
                  "constrain": "domain",
                  "domain": [
                    0,
                    1
                  ],
                  "title": {
                    "text": "Layer"
                  }
                }
              }
            },
            "text/html": [
              "<html>\n",
              "<head><meta charset=\"utf-8\" /></head>\n",
              "<body>\n",
              "    <div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
              "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-2.35.2.min.js\"></script>                <div id=\"281e8d19-0a9a-42c7-96f5-0e4d112b27bb\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"281e8d19-0a9a-42c7-96f5-0e4d112b27bb\")) {                    Plotly.newPlot(                        \"281e8d19-0a9a-42c7-96f5-0e4d112b27bb\",                        [{\"coloraxis\":\"coloraxis\",\"name\":\"0\",\"x\":[\"After_0\",\" John_1\",\" and_2\",\" Mary_3\",\" went_4\",\" to_5\",\" the_6\",\" store_7\",\",_8\",\" Mary_9\",\" gave_10\",\" a_11\",\" bottle_12\",\" of_13\",\" milk_14\",\" to_15\"],\"z\":[[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.997467577457428,0.0017654082039371133,-0.00017415513866581023,0.0008946325397118926,0.00002624255466798786,-0.0010878732427954674,-0.00046998029574751854],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.997134804725647,0.0026147128082811832,-0.0004890657728537917,0.0006286284769885242,-0.00006083501284592785,-0.00043658068170771003,-0.0009232608135789633],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.9951009750366211,0.004566204734146595,-0.00023499014787375927,0.0005880718235857785,0.00006202785880304873,-0.00032326055224984884,-0.002199603244662285],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.9868739247322083,0.020100604742765427,0.0006429426139220595,0.0011260441970080137,0.00015506964700762182,0.0006238570786081254,-0.001915706554427743],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.9520822763442993,0.07812169939279556,0.0025813132524490356,0.002135189715772867,0.00046401607687585056,0.0003220677317585796,-0.0014457262586802244],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.9528301954269409,0.07888512313365936,0.0019836986903101206,0.00023260446323547512,0.0002147118211723864,0.00024214721634052694,-0.0049705784767866135],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.9087963700294495,0.10826008021831512,0.004000796936452389,-0.000375745672499761,0.00021709750581067055,0.0005677934386767447,0.00981829408556223],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.6858420372009277,0.03584136441349983,0.0005200797459110618,-0.0008087478345260024,0.00005606363993138075,0.0013085491955280304,0.4153647720813751],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.10977857559919357,0.024683509021997452,0.0003017893759533763,-0.0003566601953934878,0.00027554683038033545,0.0014051694888621569,0.8544576168060303],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.01986919343471527,0.015401993878185749,-0.0001848907268140465,-0.00009542747284285724,0.00002862824112526141,0.0006584495422430336,0.9079399108886719],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.01997893489897251,0.006295827683061361,0.00020994043734390289,-0.0007407557568512857,-0.000040556675230618566,0.0005737576866522431,0.9069057106971741],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0]],\"type\":\"heatmap\",\"xaxis\":\"x\",\"yaxis\":\"y\",\"hovertemplate\":\"Position: %{x}\\u003cbr\\u003eLayer: %{y}\\u003cbr\\u003eNorm. Logit Diff: %{z}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmapgl\":[{\"type\":\"heatmapgl\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"scaleanchor\":\"y\",\"constrain\":\"domain\",\"title\":{\"text\":\"Position\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"autorange\":\"reversed\",\"constrain\":\"domain\",\"title\":{\"text\":\"Layer\"}},\"coloraxis\":{\"colorbar\":{\"title\":{\"text\":\"Norm. Logit Diff\"}},\"colorscale\":[[0.0,\"rgb(103,0,31)\"],[0.1,\"rgb(178,24,43)\"],[0.2,\"rgb(214,96,77)\"],[0.3,\"rgb(244,165,130)\"],[0.4,\"rgb(253,219,199)\"],[0.5,\"rgb(247,247,247)\"],[0.6,\"rgb(209,229,240)\"],[0.7,\"rgb(146,197,222)\"],[0.8,\"rgb(67,147,195)\"],[0.9,\"rgb(33,102,172)\"],[1.0,\"rgb(5,48,97)\"]],\"cmid\":0.0},\"title\":{\"text\":\"Patching GPT-2-small Residual Stream on IOI task\"}},                        {\"responsive\": true}                    ).then(function(){\n",
              "                            \n",
              "var gd = document.getElementById('281e8d19-0a9a-42c7-96f5-0e4d112b27bb');\n",
              "var x = new MutationObserver(function (mutations, observer) {{\n",
              "        var display = window.getComputedStyle(gd).display;\n",
              "        if (!display || display === 'none') {{\n",
              "            console.log([gd, 'removed!']);\n",
              "            Plotly.purge(gd);\n",
              "            observer.disconnect();\n",
              "        }}\n",
              "}});\n",
              "\n",
              "// Listen for the removal of the full notebook cells\n",
              "var notebookContainer = gd.closest('#notebook-container');\n",
              "if (notebookContainer) {{\n",
              "    x.observe(notebookContainer, {childList: true});\n",
              "}}\n",
              "\n",
              "// Listen for the clearing of the current output cell\n",
              "var outputEl = gd.closest('.output');\n",
              "if (outputEl) {{\n",
              "    x.observe(outputEl, {childList: true});\n",
              "}}\n",
              "\n",
              "                        })                };                            </script>        </div>\n",
              "</body>\n",
              "</html>"
            ]
          },
          "metadata": {},
          "output_type": "display_data"
        }
      ],
      "source": [
        "print(f\"Clean logit difference: {clean_logit_diff.value:.3f}\")\n",
        "print(f\"Corrupted logit difference: {corrupted_logit_diff.value:.3f}\")\n",
        "\n",
        "clean_decoded_tokens = [model.tokenizer.decode(token) for token in clean_tokens]\n",
        "token_labels = [f\"{token}_{index}\" for index, token in enumerate(clean_decoded_tokens)]\n",
        "\n",
        "fig = plot_ioi_patching_results(model, ioi_patching_results,token_labels,\"Patching GPT-2-small Residual Stream on IOI task\")\n",
        "fig.show()"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "W6qf4SVYnmn5"
      },
      "source": [
        "In the above plot, we see that patching the clean residual stream into the corrupted model does not change much in the final token difference for input tokens 0-9. This is expected, as there is no difference in the clean vs. corrupted prompt for these tokens, so patching in the clean activations at this point shouldn't change the model prediction.\n",
        "\n",
        "However, when we get to token #10, \"Mary\", where the subject is introduced for the second time, there is a sharp increase in output logit difference, indicating that the patch changes how the model predicts the outcome downstream, particularly for the earlier layers. There is also a transition in the middle layers of the network where the logit difference starts decreasing. We are thus seeing how the network is tracking information about the indirect object as the layers progress.\n",
        "\n",
        "A similar but opposite effect is observed when the activations for the final prompt token are patched: the normalized logit difference increases after a transition period in the middle layers."
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "lEBpCbYZFOPo"
      },
      "source": [
        "# Limitations\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "3NQxIY9Unp-3"
      },
      "source": [
        "Although activation patching is an effective technique for circuit localization, it requires running a forward pass through the model for every patch, making it computationally expensive.\n",
        "\n",
        "**Attribution patching** is an approximation of activation patching that helps scale the technique to larger experiments and models. See our tutorial on attribution patching to try it out!"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "uWz57ylReSna"
      },
      "source": [
        "# Trying on a bigger model"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "e9XRRbaMez3T"
      },
      "source": [
        "Although the original IOI experiment was performed on GPT-2 small, NDIF allows researchers to explore similar problems on largescale models!\n",
        "\n",
        "Let's see how the residual stream of Llama 3.1-8B contributes to the IOI task using activation patching with NDIF's remote infrastructure.\n",
        "\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "T_Z5Xp6AB8Kz"
      },
      "source": [
        "### NNsight Remote Setup\n",
        "Make sure you have obtained your [NDIF API key](https://login.ndif.us/) and configured your workspace for [remote execution](https://nnsight.net/notebooks/features/remote_execution/)."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 14,
      "metadata": {
        "id": "2AHdnHc0l8Cj"
      },
      "outputs": [],
      "source": [
        "from google.colab import userdata\n",
        "from nnsight import CONFIG\n",
        "\n",
        "CONFIG.set_default_api_key('546253536da74e51a1ccdfe887eafcea')\n",
        "\n",
        "!huggingface-cli login --token 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\n",
        "clear_output()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 15,
      "metadata": {
        "id": "fppg2PwAOZOh"
      },
      "outputs": [],
      "source": [
        "import torch\n",
        "import nnsight"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 16,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 645,
          "referenced_widgets": [
            "6c68f3baea974294ada248d5c7d13dea",
            "1e49ae6793a14321aba8207d8772318f",
            "8be48e18bce14ae9b7036d3606e6ae14",
            "6173f84c7d5242ab88c451efac96b64a",
            "2e7b5869b36f41b3907bd9082f09b5de",
            "3963c65fe2a84bf3ad648feed499b7d3",
            "3f95484661a346bcb7582822593e23ff",
            "bcb9240ae0c249d3a70fbe93c4f90dbd",
            "38e7582db57641acaa5b4f9b128623ac",
            "aceff3c62acd4ac7a830e47b3cf3eb2f",
            "5918d0ae0d634ecd932b7468be53f4e2",
            "3e3b18652e3e495797d7bc29d8e09fa4",
            "ed2b8eb47db2427eb2b37abb6dfa1675",
            "df53d8d0150a451993653498e7f14922",
            "5030286cf09345d1b4b7d1b610b09aef",
            "e9d367c973904a3aab42d88c84f87503",
            "75f77c87cfa948c092840845f2767cfc",
            "437d8be7f184450ab88d3b2ccbab4985",
            "61b058c2f75c4640be4a1bb7401ddf8d",
            "66ca6abda0704a3e9e4c154a2cf58d8a",
            "f9d3b3feee00438f8b4eaaa5d7441a1e",
            "3e175b1197d44c78955960dc39e8d6c4",
            "8a71d6a0477640e5a3ccd2b34593498c",
            "206291aef2c546d38fe020aa009bd0d4",
            "8d34ba2288b942e38a34452b087fa3c8",
            "424cdc54e7c54637a9b847e59b892a87",
            "c6c9199028e74f438406c19d0dcce39f",
            "c71871240060494a918e444e69845350",
            "fadcf1276348481ea0e7c93bd9f04fee",
            "d688719b4925479dad7a7ddd8437dbdd",
            "8a52e2e0a0be483d84d5a03e1cf2ca82",
            "cfcd3c63b4934c61a7e7712f1112f152",
            "324381b074f74581b3766b17a7410964",
            "3925e93110404a69a2fbc84b5f76c23d",
            "572ad0dc446b44db818eed2800cfba2b",
            "a261cf4ba7484657b7bb75eb0b0ab026",
            "1f1bc29799d244b891a79212405832fa",
            "2f6e0113a69e4329a801e55dd6928974",
            "54ab440b03474657b52ab4e977bc1d15",
            "714dff0ccba84c658c6b8e590f1b3a87",
            "a7dd27bea8c94f6fa672e0c9a857ba2d",
            "06119adf2b49466ea5c1fb5f3224a0fe",
            "38770f0e2bb94fb29c6ee5be1d9dea80",
            "5e60a060ea7e4ad289ad976f02b7c9c4"
          ]
        },
        "id": "kyZQkHg59pGb",
        "outputId": "30b1e52c-84ac-4617-a15a-ca89ab70ee74"
      },
      "outputs": [
        {
          "data": {
            "application/vnd.jupyter.widget-view+json": {
              "model_id": "6c68f3baea974294ada248d5c7d13dea",
              "version_major": 2,
              "version_minor": 0
            },
            "text/plain": [
              "config.json:   0%|          | 0.00/826 [00:00<?, ?B/s]"
            ]
          },
          "metadata": {},
          "output_type": "display_data"
        },
        {
          "data": {
            "application/vnd.jupyter.widget-view+json": {
              "model_id": "3e3b18652e3e495797d7bc29d8e09fa4",
              "version_major": 2,
              "version_minor": 0
            },
            "text/plain": [
              "tokenizer_config.json:   0%|          | 0.00/50.5k [00:00<?, ?B/s]"
            ]
          },
          "metadata": {},
          "output_type": "display_data"
        },
        {
          "data": {
            "application/vnd.jupyter.widget-view+json": {
              "model_id": "8a71d6a0477640e5a3ccd2b34593498c",
              "version_major": 2,
              "version_minor": 0
            },
            "text/plain": [
              "tokenizer.json:   0%|          | 0.00/9.09M [00:00<?, ?B/s]"
            ]
          },
          "metadata": {},
          "output_type": "display_data"
        },
        {
          "data": {
            "application/vnd.jupyter.widget-view+json": {
              "model_id": "3925e93110404a69a2fbc84b5f76c23d",
              "version_major": 2,
              "version_minor": 0
            },
            "text/plain": [
              "special_tokens_map.json:   0%|          | 0.00/73.0 [00:00<?, ?B/s]"
            ]
          },
          "metadata": {},
          "output_type": "display_data"
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "LlamaForCausalLM(\n",
            "  (model): LlamaModel(\n",
            "    (embed_tokens): Embedding(128256, 4096)\n",
            "    (layers): ModuleList(\n",
            "      (0-31): 32 x LlamaDecoderLayer(\n",
            "        (self_attn): LlamaSdpaAttention(\n",
            "          (q_proj): Linear(in_features=4096, out_features=4096, bias=False)\n",
            "          (k_proj): Linear(in_features=4096, out_features=1024, bias=False)\n",
            "          (v_proj): Linear(in_features=4096, out_features=1024, bias=False)\n",
            "          (o_proj): Linear(in_features=4096, out_features=4096, bias=False)\n",
            "          (rotary_emb): LlamaRotaryEmbedding()\n",
            "        )\n",
            "        (mlp): LlamaMLP(\n",
            "          (gate_proj): Linear(in_features=4096, out_features=14336, bias=False)\n",
            "          (up_proj): Linear(in_features=4096, out_features=14336, bias=False)\n",
            "          (down_proj): Linear(in_features=14336, out_features=4096, bias=False)\n",
            "          (act_fn): SiLU()\n",
            "        )\n",
            "        (input_layernorm): LlamaRMSNorm((4096,), eps=1e-05)\n",
            "        (post_attention_layernorm): LlamaRMSNorm((4096,), eps=1e-05)\n",
            "      )\n",
            "    )\n",
            "    (norm): LlamaRMSNorm((4096,), eps=1e-05)\n",
            "    (rotary_emb): LlamaRotaryEmbedding()\n",
            "  )\n",
            "  (lm_head): Linear(in_features=4096, out_features=128256, bias=False)\n",
            "  (generator): WrapperModule()\n",
            ")\n"
          ]
        }
      ],
      "source": [
        "# Load model\n",
        "llm = LanguageModel(\"meta-llama/Meta-Llama-3.1-8B\")\n",
        "print(llm)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "DD0F391XGwra"
      },
      "source": [
        "Define some IOI prompts. Each of these prompts can be used as a 'clean' and as a 'corrupted' prompt, as each prompt has a related corrupted version with the IO switched out."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 17,
      "metadata": {
        "id": "q9NSOwiL1k2V"
      },
      "outputs": [],
      "source": [
        "prompts = [\n",
        "    \"When Lisa and Sarah went to the cinema, Lisa gave the ticket to\",\n",
        "    \"When Lisa and Sarah went to the cinema, Sarah gave the ticket to\"\n",
        "]"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "HbZQ8m4UGzuU"
      },
      "source": [
        "Define the answers to these prompts, formatted as `(correct, incorrect)`"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 18,
      "metadata": {
        "id": "MMmQOD1P1fRP"
      },
      "outputs": [],
      "source": [
        "answers = [\n",
        "    (\" Sarah\", \" Lisa\"),\n",
        "    (\" Lisa\", \" Sarah\")\n",
        "]"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 19,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "VtKEdMP-1epd",
        "outputId": "7c6f28b1-131b-4773-b6da-b9d03847993f"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "answer_tokens =  [[21077, 29656], [29656, 21077]]\n"
          ]
        }
      ],
      "source": [
        "# Tokenize clean and corrupted inputs:\n",
        "clean_tokens = llm.tokenizer(prompts, return_tensors=\"pt\")[\"input_ids\"]\n",
        "corrupted_tokens = clean_tokens[\n",
        "    [(i + 1 if i % 2 == 0 else i - 1) for i in range(len(clean_tokens))]\n",
        "]\n",
        "\n",
        "# Tokenize answers for each prompt:\n",
        "answer_token_indices = [\n",
        "        [llm.tokenizer(answers[i][j])[\"input_ids\"][1] for j in range(2)]\n",
        "        for i in range(len(answers))\n",
        "]\n",
        "\n",
        "print(\"answer_tokens = \" , answer_token_indices)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "S7n7fr2OCCPX"
      },
      "source": [
        "### Patching Attention Heads"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "-2Nw_YdSCZsI"
      },
      "source": [
        "The residual stream isn't the only model component you can apply activation patching on: let's try patching Llama's attention heads to see how they influence the IOI task! Here, we apply our patching intervention on the attention output, `o_proj.output` in Llama models.\n",
        "\n",
        "Because the multihead attention of Llama models are stored in a projection matrix containing all attention heads, we will need to resize the tensor to reveal individual attention head contributions. The `einops` library is a handy way to resize tensors."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 20,
      "metadata": {
        "id": "Eava539mV7zr"
      },
      "outputs": [],
      "source": [
        "import einops"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "QU6MirnnevAC"
      },
      "source": [
        "Okay, now let's apply our three activation patching steps to our attention heads during an IOI task."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 21,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "hXhQuD8R8UjD",
        "outputId": "c3764234-5dbe-4794-a19a-0cd01a364bee"
      },
      "outputs": [
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "2024-11-01 19:00:33,499 4c93c9b6-95cb-438d-992b-de8862802d4b - RECEIVED: Your job has been received and is waiting approval.\n",
            "INFO:nnsight_remote:4c93c9b6-95cb-438d-992b-de8862802d4b - RECEIVED: Your job has been received and is waiting approval.\n",
            "2024-11-01 19:00:33,502 4c93c9b6-95cb-438d-992b-de8862802d4b - APPROVED: Your job was approved and is waiting to be run.\n",
            "INFO:nnsight_remote:4c93c9b6-95cb-438d-992b-de8862802d4b - APPROVED: Your job was approved and is waiting to be run.\n",
            "2024-11-01 19:00:33,505 4c93c9b6-95cb-438d-992b-de8862802d4b - RUNNING: Your job has started running.\n",
            "INFO:nnsight_remote:4c93c9b6-95cb-438d-992b-de8862802d4b - RUNNING: Your job has started running.\n",
            "2024-11-01 19:00:48,552 4c93c9b6-95cb-438d-992b-de8862802d4b - COMPLETED: Your job has been completed.\n",
            "INFO:nnsight_remote:4c93c9b6-95cb-438d-992b-de8862802d4b - COMPLETED: Your job has been completed.\n",
            "Downloading result: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 276k/276k [00:00<00:00, 307kB/s]\n"
          ]
        }
      ],
      "source": [
        "# Enter nnsight tracing context\n",
        "N_LAYERS = len(llm.model.layers)\n",
        "batch = 1\n",
        "seq = len(prompts[0]) #15 length of input tokens\n",
        "N_HEADS = 32 #32 attention heads\n",
        "D_MODEL = int(4096) #4096 size of model hidden\n",
        "D_HEADS = int(D_MODEL/N_HEADS) #128 size of attention head\n",
        "\n",
        "ioi_patching_results_all = []\n",
        "prompt_id = 0\n",
        "corrupt_id = (prompt_id + 1 if prompt_id % 2 == 0 else prompt_id - 1)\n",
        "\n",
        "with llm.trace(remote = True) as tracer:\n",
        "    # STEP 1: Clean run, grab clean activations for each attention head\n",
        "    with tracer.invoke(prompts[prompt_id]) as invoker:\n",
        "        clean_tokens = invoker.inputs[0]['input_ids'][0]\n",
        "\n",
        "        # Get clean attention output for later patching\n",
        "        z_hs = {}\n",
        "        for layer_idx in range(N_LAYERS):\n",
        "            # attention output for llama models needs to be reshaped to look at individual heads\n",
        "            z = llm.model.layers[layer_idx].self_attn.o_proj.input # dimensions [1x15x4096] [batch x seq x D_MODEL]\n",
        "            z_reshaped = einops.rearrange(z, 'b s (nh dh) -> b s nh dh',nh=32)\n",
        "            for head_idx in range(N_HEADS):\n",
        "                z_hs[layer_idx,head_idx] = z_reshaped[:,:,head_idx,:]\n",
        "\n",
        "        # Get logits from the lm_head.\n",
        "        clean_logits = llm.lm_head.output\n",
        "        clean_logit_diff = (\n",
        "            clean_logits[0, -1, answer_token_indices[prompt_id][0]] - clean_logits[0, -1, answer_token_indices[prompt_id][1]]\n",
        "        ).save()\n",
        "\n",
        "    # STEP 2: Corrupted run, grab corrupted logits for later comparison.\n",
        "    with tracer.invoke(prompts[corrupt_id]) as invoker:\n",
        "        corrupted_tokens = invoker.inputs[0]['input_ids'][0]\n",
        "        corrupted_logits = llm.lm_head.output\n",
        "\n",
        "        # Calculate the difference between the correct answer and incorrect answer for the corrupted run and save it.\n",
        "        corrupted_logit_diff = (\n",
        "            corrupted_logits[0, -1, answer_token_indices[prompt_id][0]] - corrupted_logits[0, -1, answer_token_indices[prompt_id][1]]\n",
        "        ).save()\n",
        "\n",
        "    # STEP 3: Patching runs, apply 'clean' model state at each layer and head,\n",
        "    ioi_patching_results = []\n",
        "\n",
        "    # Patching: Iterate through all the layers\n",
        "    for layer_idx in range(len(llm.model.layers)):\n",
        "        _ioi_patching_results = []\n",
        "        # Iterate through all attention heads\n",
        "        for head_idx in range(N_HEADS):\n",
        "            # Patching corrupted run at given layer and token\n",
        "            with tracer.invoke(prompts[corrupt_id]) as invoker:\n",
        "                # Apply the patch from the clean hidden states to the corrupted hidden state for given layer and head.\n",
        "                z_corrupt = llm.model.layers[layer_idx].self_attn.o_proj.input\n",
        "                z_corrupt = einops.rearrange(z_corrupt, 'b s (nh dh) -> b s nh dh',nh=32)\n",
        "                z_corrupt[:,:,head_idx,:] = z_hs[layer_idx,head_idx]\n",
        "                z_corrupt = einops.rearrange(z_corrupt, 'b s nh dh -> b s (nh dh)', nh=32)\n",
        "                llm.model.layers[layer_idx].self_attn.o_proj.input = z_corrupt\n",
        "\n",
        "                patched_logits = llm.lm_head.output\n",
        "                patched_logit_diff = (\n",
        "                    patched_logits[0, -1, answer_token_indices[prompt_id][0]]\n",
        "                    - patched_logits[0, -1, answer_token_indices[prompt_id][1]]\n",
        "                )\n",
        "\n",
        "                # Calculate the improvement in the correct token after patching.\n",
        "                patched_result = (patched_logit_diff - corrupted_logit_diff) / (\n",
        "                    clean_logit_diff - corrupted_logit_diff\n",
        "                )\n",
        "\n",
        "                _ioi_patching_results.append(patched_result.save())\n",
        "\n",
        "        ioi_patching_results.append(_ioi_patching_results)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "G8Ef7F9tCKKu"
      },
      "source": [
        "### Visualize Results"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "P0n9EbK1CM9V"
      },
      "source": [
        "Let's use the same plotting function from earlier to visualize how patching the Llama-3.1-8B attention heads influenced model output during the IOI task."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 22,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 578
        },
        "id": "RH2ms_7dUoFs",
        "outputId": "88461803-7f4a-4e31-e986-8d5203f55aab"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Clean logit difference: 5.125\n",
            "Corrupted logit difference: -4.438\n"
          ]
        },
        {
          "data": {
            "application/vnd.plotly.v1+json": {
              "config": {
                "plotlyServerURL": "https://plot.ly"
              },
              "data": [
                {
                  "coloraxis": "coloraxis",
                  "hovertemplate": "Position: %{x}<br>Layer: %{y}<br>Norm. Logit Diff: %{z}<extra></extra>",
                  "name": "0",
                  "type": "heatmap",
                  "x": [
                    "Head 0",
                    "Head 1",
                    "Head 2",
                    "Head 3",
                    "Head 4",
                    "Head 5",
                    "Head 6",
                    "Head 7",
                    "Head 8",
                    "Head 9",
                    "Head 10",
                    "Head 11",
                    "Head 12",
                    "Head 13",
                    "Head 14",
                    "Head 15",
                    "Head 16",
                    "Head 17",
                    "Head 18",
                    "Head 19",
                    "Head 20",
                    "Head 21",
                    "Head 22",
                    "Head 23",
                    "Head 24",
                    "Head 25",
                    "Head 26",
                    "Head 27",
                    "Head 28",
                    "Head 29",
                    "Head 30",
                    "Head 31"
                  ],
                  "xaxis": "x",
                  "yaxis": "y",
                  "z": [
                    [
                      0.00653076171875,
                      -0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.0130615234375,
                      -0.00653076171875,
                      -0.00653076171875,
                      0.00653076171875,
                      0,
                      -0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0.0130615234375,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      -0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0,
                      0.0130615234375,
                      0.00653076171875,
                      0.00653076171875
                    ],
                    [
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0,
                      -0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      -0.00653076171875,
                      -0.00653076171875,
                      0.0130615234375,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.0130615234375,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0
                    ],
                    [
                      0,
                      0,
                      0.00653076171875,
                      0.0130615234375,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0.0130615234375,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      -0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      -0.00653076171875,
                      0.00653076171875
                    ],
                    [
                      0.00653076171875,
                      -0.00653076171875,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      -0.0130615234375
                    ],
                    [
                      0,
                      0.0130615234375,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0.00653076171875,
                      0.11767578125,
                      0,
                      0,
                      0,
                      0.0130615234375,
                      0.00653076171875,
                      -0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0.0130615234375
                    ],
                    [
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      -0.00653076171875,
                      0,
                      0.0130615234375,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      -0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0,
                      0,
                      -0.00653076171875,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875
                    ],
                    [
                      0.00653076171875,
                      0,
                      0.0130615234375,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      -0.0130615234375,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      -0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0
                    ],
                    [
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0,
                      -0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      -0.00653076171875,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0
                    ],
                    [
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      -0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      -0.0196533203125,
                      0,
                      -0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0.0130615234375,
                      0,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      -0.00653076171875,
                      0,
                      0,
                      -0.00653076171875,
                      0,
                      -0.00653076171875,
                      0,
                      0,
                      0.00653076171875
                    ],
                    [
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0.0130615234375,
                      0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      -0.0130615234375,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875
                    ],
                    [
                      0.026123046875,
                      -0.026123046875,
                      -0.0196533203125,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      -0.00653076171875,
                      -0.00653076171875,
                      -0.0130615234375,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      -0.0130615234375,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875
                    ],
                    [
                      0,
                      0,
                      -0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      -0.0130615234375,
                      0,
                      -0.00653076171875,
                      0.00653076171875,
                      -0.0130615234375,
                      -0.00653076171875,
                      0,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      -0.00653076171875,
                      0.0130615234375,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875
                    ],
                    [
                      -0.00653076171875,
                      0,
                      0,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      -0.00653076171875,
                      0.0130615234375,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0.0196533203125,
                      -0.0130615234375,
                      -0.00653076171875,
                      0.00653076171875,
                      0,
                      -0.00653076171875,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.0130615234375,
                      -0.00653076171875,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875
                    ],
                    [
                      -0.00653076171875,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0.0130615234375,
                      0.00653076171875,
                      0,
                      -0.00653076171875,
                      0,
                      0,
                      -0.00653076171875,
                      0,
                      0,
                      -0.00653076171875,
                      0,
                      0.0130615234375,
                      0,
                      0,
                      0.00653076171875,
                      0.0130615234375,
                      0.00653076171875,
                      0,
                      0
                    ],
                    [
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      -0.00653076171875,
                      0.045654296875,
                      0,
                      0,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.058837890625,
                      0,
                      0.00653076171875,
                      0.07177734375,
                      0,
                      0.0196533203125,
                      -0.00653076171875,
                      0,
                      0,
                      0,
                      -0.00653076171875,
                      0,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      -0.00653076171875
                    ],
                    [
                      0,
                      0,
                      0,
                      -0.00653076171875,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0.0130615234375,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0.1240234375,
                      0,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      -0.00653076171875
                    ],
                    [
                      -0.0130615234375,
                      0.058837890625,
                      0.03271484375,
                      -0.0196533203125,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      -0.058837890625,
                      0.03271484375,
                      0,
                      0,
                      0,
                      0,
                      0.0849609375,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.039306640625,
                      0.00653076171875,
                      -0.03271484375,
                      0
                    ],
                    [
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.039306640625,
                      -0.0196533203125,
                      0,
                      0.169921875,
                      0,
                      0,
                      0.00653076171875,
                      0.00653076171875
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      -0.00653076171875,
                      0,
                      -0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      -0.0130615234375,
                      0,
                      0.00653076171875,
                      -0.00653076171875,
                      -0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      -0.0130615234375,
                      0.09814453125,
                      0.00653076171875,
                      0
                    ],
                    [
                      0,
                      0,
                      0.00653076171875,
                      -0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      -0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      -0.045654296875,
                      0,
                      0,
                      0.0849609375,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0
                    ],
                    [
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.0130615234375,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      -0.111328125,
                      0.0849609375,
                      -0.248046875,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875
                    ],
                    [
                      0,
                      0,
                      0.0196533203125,
                      -0.03271484375,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      -0.00653076171875,
                      0,
                      0.03271484375,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875
                    ],
                    [
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.03271484375,
                      0,
                      -0.0196533203125,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      -0.03271484375,
                      0.169921875,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.0130615234375,
                      0.00653076171875
                    ],
                    [
                      0,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.0130615234375,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0.0130615234375,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0.0130615234375,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0,
                      0
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.039306640625,
                      0.00653076171875,
                      0.00653076171875,
                      0.00653076171875,
                      0
                    ],
                    [
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.0130615234375,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.1044921875,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0
                    ],
                    [
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.1376953125,
                      0,
                      0,
                      -0.0654296875,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0
                    ],
                    [
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      -0.0130615234375,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.1630859375,
                      0.0130615234375,
                      0.0196533203125,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0
                    ],
                    [
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0.0130615234375,
                      -0.05224609375,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.0196533203125,
                      0,
                      -0.1044921875,
                      0.039306640625,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0
                    ],
                    [
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.0130615234375,
                      0.09130859375,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      -0.07861328125,
                      0.0130615234375,
                      0.0196533203125,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0.00653076171875
                    ],
                    [
                      0,
                      0.00653076171875,
                      -0.00653076171875,
                      0.0130615234375,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0.00653076171875,
                      0,
                      0.00653076171875,
                      0,
                      0,
                      0,
                      0,
                      0,
                      -0.0130615234375,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0,
                      0
                    ]
                  ]
                }
              ],
              "layout": {
                "coloraxis": {
                  "cmid": 0,
                  "colorbar": {
                    "title": {
                      "text": "Norm. Logit Diff"
                    }
                  },
                  "colorscale": [
                    [
                      0,
                      "rgb(103,0,31)"
                    ],
                    [
                      0.1,
                      "rgb(178,24,43)"
                    ],
                    [
                      0.2,
                      "rgb(214,96,77)"
                    ],
                    [
                      0.3,
                      "rgb(244,165,130)"
                    ],
                    [
                      0.4,
                      "rgb(253,219,199)"
                    ],
                    [
                      0.5,
                      "rgb(247,247,247)"
                    ],
                    [
                      0.6,
                      "rgb(209,229,240)"
                    ],
                    [
                      0.7,
                      "rgb(146,197,222)"
                    ],
                    [
                      0.8,
                      "rgb(67,147,195)"
                    ],
                    [
                      0.9,
                      "rgb(33,102,172)"
                    ],
                    [
                      1,
                      "rgb(5,48,97)"
                    ]
                  ]
                },
                "template": {
                  "data": {
                    "bar": [
                      {
                        "error_x": {
                          "color": "#2a3f5f"
                        },
                        "error_y": {
                          "color": "#2a3f5f"
                        },
                        "marker": {
                          "line": {
                            "color": "#E5ECF6",
                            "width": 0.5
                          },
                          "pattern": {
                            "fillmode": "overlay",
                            "size": 10,
                            "solidity": 0.2
                          }
                        },
                        "type": "bar"
                      }
                    ],
                    "barpolar": [
                      {
                        "marker": {
                          "line": {
                            "color": "#E5ECF6",
                            "width": 0.5
                          },
                          "pattern": {
                            "fillmode": "overlay",
                            "size": 10,
                            "solidity": 0.2
                          }
                        },
                        "type": "barpolar"
                      }
                    ],
                    "carpet": [
                      {
                        "aaxis": {
                          "endlinecolor": "#2a3f5f",
                          "gridcolor": "white",
                          "linecolor": "white",
                          "minorgridcolor": "white",
                          "startlinecolor": "#2a3f5f"
                        },
                        "baxis": {
                          "endlinecolor": "#2a3f5f",
                          "gridcolor": "white",
                          "linecolor": "white",
                          "minorgridcolor": "white",
                          "startlinecolor": "#2a3f5f"
                        },
                        "type": "carpet"
                      }
                    ],
                    "choropleth": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "type": "choropleth"
                      }
                    ],
                    "contour": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "colorscale": [
                          [
                            0,
                            "#0d0887"
                          ],
                          [
                            0.1111111111111111,
                            "#46039f"
                          ],
                          [
                            0.2222222222222222,
                            "#7201a8"
                          ],
                          [
                            0.3333333333333333,
                            "#9c179e"
                          ],
                          [
                            0.4444444444444444,
                            "#bd3786"
                          ],
                          [
                            0.5555555555555556,
                            "#d8576b"
                          ],
                          [
                            0.6666666666666666,
                            "#ed7953"
                          ],
                          [
                            0.7777777777777778,
                            "#fb9f3a"
                          ],
                          [
                            0.8888888888888888,
                            "#fdca26"
                          ],
                          [
                            1,
                            "#f0f921"
                          ]
                        ],
                        "type": "contour"
                      }
                    ],
                    "contourcarpet": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "type": "contourcarpet"
                      }
                    ],
                    "heatmap": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "colorscale": [
                          [
                            0,
                            "#0d0887"
                          ],
                          [
                            0.1111111111111111,
                            "#46039f"
                          ],
                          [
                            0.2222222222222222,
                            "#7201a8"
                          ],
                          [
                            0.3333333333333333,
                            "#9c179e"
                          ],
                          [
                            0.4444444444444444,
                            "#bd3786"
                          ],
                          [
                            0.5555555555555556,
                            "#d8576b"
                          ],
                          [
                            0.6666666666666666,
                            "#ed7953"
                          ],
                          [
                            0.7777777777777778,
                            "#fb9f3a"
                          ],
                          [
                            0.8888888888888888,
                            "#fdca26"
                          ],
                          [
                            1,
                            "#f0f921"
                          ]
                        ],
                        "type": "heatmap"
                      }
                    ],
                    "heatmapgl": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "colorscale": [
                          [
                            0,
                            "#0d0887"
                          ],
                          [
                            0.1111111111111111,
                            "#46039f"
                          ],
                          [
                            0.2222222222222222,
                            "#7201a8"
                          ],
                          [
                            0.3333333333333333,
                            "#9c179e"
                          ],
                          [
                            0.4444444444444444,
                            "#bd3786"
                          ],
                          [
                            0.5555555555555556,
                            "#d8576b"
                          ],
                          [
                            0.6666666666666666,
                            "#ed7953"
                          ],
                          [
                            0.7777777777777778,
                            "#fb9f3a"
                          ],
                          [
                            0.8888888888888888,
                            "#fdca26"
                          ],
                          [
                            1,
                            "#f0f921"
                          ]
                        ],
                        "type": "heatmapgl"
                      }
                    ],
                    "histogram": [
                      {
                        "marker": {
                          "pattern": {
                            "fillmode": "overlay",
                            "size": 10,
                            "solidity": 0.2
                          }
                        },
                        "type": "histogram"
                      }
                    ],
                    "histogram2d": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "colorscale": [
                          [
                            0,
                            "#0d0887"
                          ],
                          [
                            0.1111111111111111,
                            "#46039f"
                          ],
                          [
                            0.2222222222222222,
                            "#7201a8"
                          ],
                          [
                            0.3333333333333333,
                            "#9c179e"
                          ],
                          [
                            0.4444444444444444,
                            "#bd3786"
                          ],
                          [
                            0.5555555555555556,
                            "#d8576b"
                          ],
                          [
                            0.6666666666666666,
                            "#ed7953"
                          ],
                          [
                            0.7777777777777778,
                            "#fb9f3a"
                          ],
                          [
                            0.8888888888888888,
                            "#fdca26"
                          ],
                          [
                            1,
                            "#f0f921"
                          ]
                        ],
                        "type": "histogram2d"
                      }
                    ],
                    "histogram2dcontour": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "colorscale": [
                          [
                            0,
                            "#0d0887"
                          ],
                          [
                            0.1111111111111111,
                            "#46039f"
                          ],
                          [
                            0.2222222222222222,
                            "#7201a8"
                          ],
                          [
                            0.3333333333333333,
                            "#9c179e"
                          ],
                          [
                            0.4444444444444444,
                            "#bd3786"
                          ],
                          [
                            0.5555555555555556,
                            "#d8576b"
                          ],
                          [
                            0.6666666666666666,
                            "#ed7953"
                          ],
                          [
                            0.7777777777777778,
                            "#fb9f3a"
                          ],
                          [
                            0.8888888888888888,
                            "#fdca26"
                          ],
                          [
                            1,
                            "#f0f921"
                          ]
                        ],
                        "type": "histogram2dcontour"
                      }
                    ],
                    "mesh3d": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "type": "mesh3d"
                      }
                    ],
                    "parcoords": [
                      {
                        "line": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "parcoords"
                      }
                    ],
                    "pie": [
                      {
                        "automargin": true,
                        "type": "pie"
                      }
                    ],
                    "scatter": [
                      {
                        "fillpattern": {
                          "fillmode": "overlay",
                          "size": 10,
                          "solidity": 0.2
                        },
                        "type": "scatter"
                      }
                    ],
                    "scatter3d": [
                      {
                        "line": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scatter3d"
                      }
                    ],
                    "scattercarpet": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scattercarpet"
                      }
                    ],
                    "scattergeo": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scattergeo"
                      }
                    ],
                    "scattergl": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scattergl"
                      }
                    ],
                    "scattermapbox": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scattermapbox"
                      }
                    ],
                    "scatterpolar": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scatterpolar"
                      }
                    ],
                    "scatterpolargl": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scatterpolargl"
                      }
                    ],
                    "scatterternary": [
                      {
                        "marker": {
                          "colorbar": {
                            "outlinewidth": 0,
                            "ticks": ""
                          }
                        },
                        "type": "scatterternary"
                      }
                    ],
                    "surface": [
                      {
                        "colorbar": {
                          "outlinewidth": 0,
                          "ticks": ""
                        },
                        "colorscale": [
                          [
                            0,
                            "#0d0887"
                          ],
                          [
                            0.1111111111111111,
                            "#46039f"
                          ],
                          [
                            0.2222222222222222,
                            "#7201a8"
                          ],
                          [
                            0.3333333333333333,
                            "#9c179e"
                          ],
                          [
                            0.4444444444444444,
                            "#bd3786"
                          ],
                          [
                            0.5555555555555556,
                            "#d8576b"
                          ],
                          [
                            0.6666666666666666,
                            "#ed7953"
                          ],
                          [
                            0.7777777777777778,
                            "#fb9f3a"
                          ],
                          [
                            0.8888888888888888,
                            "#fdca26"
                          ],
                          [
                            1,
                            "#f0f921"
                          ]
                        ],
                        "type": "surface"
                      }
                    ],
                    "table": [
                      {
                        "cells": {
                          "fill": {
                            "color": "#EBF0F8"
                          },
                          "line": {
                            "color": "white"
                          }
                        },
                        "header": {
                          "fill": {
                            "color": "#C8D4E3"
                          },
                          "line": {
                            "color": "white"
                          }
                        },
                        "type": "table"
                      }
                    ]
                  },
                  "layout": {
                    "annotationdefaults": {
                      "arrowcolor": "#2a3f5f",
                      "arrowhead": 0,
                      "arrowwidth": 1
                    },
                    "autotypenumbers": "strict",
                    "coloraxis": {
                      "colorbar": {
                        "outlinewidth": 0,
                        "ticks": ""
                      }
                    },
                    "colorscale": {
                      "diverging": [
                        [
                          0,
                          "#8e0152"
                        ],
                        [
                          0.1,
                          "#c51b7d"
                        ],
                        [
                          0.2,
                          "#de77ae"
                        ],
                        [
                          0.3,
                          "#f1b6da"
                        ],
                        [
                          0.4,
                          "#fde0ef"
                        ],
                        [
                          0.5,
                          "#f7f7f7"
                        ],
                        [
                          0.6,
                          "#e6f5d0"
                        ],
                        [
                          0.7,
                          "#b8e186"
                        ],
                        [
                          0.8,
                          "#7fbc41"
                        ],
                        [
                          0.9,
                          "#4d9221"
                        ],
                        [
                          1,
                          "#276419"
                        ]
                      ],
                      "sequential": [
                        [
                          0,
                          "#0d0887"
                        ],
                        [
                          0.1111111111111111,
                          "#46039f"
                        ],
                        [
                          0.2222222222222222,
                          "#7201a8"
                        ],
                        [
                          0.3333333333333333,
                          "#9c179e"
                        ],
                        [
                          0.4444444444444444,
                          "#bd3786"
                        ],
                        [
                          0.5555555555555556,
                          "#d8576b"
                        ],
                        [
                          0.6666666666666666,
                          "#ed7953"
                        ],
                        [
                          0.7777777777777778,
                          "#fb9f3a"
                        ],
                        [
                          0.8888888888888888,
                          "#fdca26"
                        ],
                        [
                          1,
                          "#f0f921"
                        ]
                      ],
                      "sequentialminus": [
                        [
                          0,
                          "#0d0887"
                        ],
                        [
                          0.1111111111111111,
                          "#46039f"
                        ],
                        [
                          0.2222222222222222,
                          "#7201a8"
                        ],
                        [
                          0.3333333333333333,
                          "#9c179e"
                        ],
                        [
                          0.4444444444444444,
                          "#bd3786"
                        ],
                        [
                          0.5555555555555556,
                          "#d8576b"
                        ],
                        [
                          0.6666666666666666,
                          "#ed7953"
                        ],
                        [
                          0.7777777777777778,
                          "#fb9f3a"
                        ],
                        [
                          0.8888888888888888,
                          "#fdca26"
                        ],
                        [
                          1,
                          "#f0f921"
                        ]
                      ]
                    },
                    "colorway": [
                      "#636efa",
                      "#EF553B",
                      "#00cc96",
                      "#ab63fa",
                      "#FFA15A",
                      "#19d3f3",
                      "#FF6692",
                      "#B6E880",
                      "#FF97FF",
                      "#FECB52"
                    ],
                    "font": {
                      "color": "#2a3f5f"
                    },
                    "geo": {
                      "bgcolor": "white",
                      "lakecolor": "white",
                      "landcolor": "#E5ECF6",
                      "showlakes": true,
                      "showland": true,
                      "subunitcolor": "white"
                    },
                    "hoverlabel": {
                      "align": "left"
                    },
                    "hovermode": "closest",
                    "mapbox": {
                      "style": "light"
                    },
                    "paper_bgcolor": "white",
                    "plot_bgcolor": "#E5ECF6",
                    "polar": {
                      "angularaxis": {
                        "gridcolor": "white",
                        "linecolor": "white",
                        "ticks": ""
                      },
                      "bgcolor": "#E5ECF6",
                      "radialaxis": {
                        "gridcolor": "white",
                        "linecolor": "white",
                        "ticks": ""
                      }
                    },
                    "scene": {
                      "xaxis": {
                        "backgroundcolor": "#E5ECF6",
                        "gridcolor": "white",
                        "gridwidth": 2,
                        "linecolor": "white",
                        "showbackground": true,
                        "ticks": "",
                        "zerolinecolor": "white"
                      },
                      "yaxis": {
                        "backgroundcolor": "#E5ECF6",
                        "gridcolor": "white",
                        "gridwidth": 2,
                        "linecolor": "white",
                        "showbackground": true,
                        "ticks": "",
                        "zerolinecolor": "white"
                      },
                      "zaxis": {
                        "backgroundcolor": "#E5ECF6",
                        "gridcolor": "white",
                        "gridwidth": 2,
                        "linecolor": "white",
                        "showbackground": true,
                        "ticks": "",
                        "zerolinecolor": "white"
                      }
                    },
                    "shapedefaults": {
                      "line": {
                        "color": "#2a3f5f"
                      }
                    },
                    "ternary": {
                      "aaxis": {
                        "gridcolor": "white",
                        "linecolor": "white",
                        "ticks": ""
                      },
                      "baxis": {
                        "gridcolor": "white",
                        "linecolor": "white",
                        "ticks": ""
                      },
                      "bgcolor": "#E5ECF6",
                      "caxis": {
                        "gridcolor": "white",
                        "linecolor": "white",
                        "ticks": ""
                      }
                    },
                    "title": {
                      "x": 0.05
                    },
                    "xaxis": {
                      "automargin": true,
                      "gridcolor": "white",
                      "linecolor": "white",
                      "ticks": "",
                      "title": {
                        "standoff": 15
                      },
                      "zerolinecolor": "white",
                      "zerolinewidth": 2
                    },
                    "yaxis": {
                      "automargin": true,
                      "gridcolor": "white",
                      "linecolor": "white",
                      "ticks": "",
                      "title": {
                        "standoff": 15
                      },
                      "zerolinecolor": "white",
                      "zerolinewidth": 2
                    }
                  }
                },
                "title": {
                  "text": "Patching Llama Attention Heads on IOI task"
                },
                "xaxis": {
                  "anchor": "y",
                  "constrain": "domain",
                  "domain": [
                    0,
                    1
                  ],
                  "scaleanchor": "y",
                  "title": {
                    "text": "Position"
                  }
                },
                "yaxis": {
                  "anchor": "x",
                  "autorange": "reversed",
                  "constrain": "domain",
                  "domain": [
                    0,
                    1
                  ],
                  "title": {
                    "text": "Layer"
                  }
                }
              }
            },
            "text/html": [
              "<html>\n",
              "<head><meta charset=\"utf-8\" /></head>\n",
              "<body>\n",
              "    <div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
              "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-2.35.2.min.js\"></script>                <div id=\"bf25c91a-837b-4756-a944-a36eb729c800\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"bf25c91a-837b-4756-a944-a36eb729c800\")) {                    Plotly.newPlot(                        \"bf25c91a-837b-4756-a944-a36eb729c800\",                        [{\"coloraxis\":\"coloraxis\",\"name\":\"0\",\"x\":[\"Head 0\",\"Head 1\",\"Head 2\",\"Head 3\",\"Head 4\",\"Head 5\",\"Head 6\",\"Head 7\",\"Head 8\",\"Head 9\",\"Head 10\",\"Head 11\",\"Head 12\",\"Head 13\",\"Head 14\",\"Head 15\",\"Head 16\",\"Head 17\",\"Head 18\",\"Head 19\",\"Head 20\",\"Head 21\",\"Head 22\",\"Head 23\",\"Head 24\",\"Head 25\",\"Head 26\",\"Head 27\",\"Head 28\",\"Head 29\",\"Head 30\",\"Head 31\"],\"z\":[[0.00653076171875,-0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.0130615234375,-0.00653076171875,-0.00653076171875,0.00653076171875,0.0,-0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,-0.00653076171875,0.0130615234375,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.00653076171875,-0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.0,0.0130615234375,0.00653076171875,0.00653076171875],[0.0,0.00653076171875,0.00653076171875,-0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.0,0.00653076171875,0.00653076171875,-0.00653076171875,0.0,-0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.0,-0.00653076171875,-0.00653076171875,0.0130615234375,0.0,0.00653076171875,0.00653076171875,0.00653076171875,0.0130615234375,0.0,0.00653076171875,0.00653076171875,0.0],[0.0,0.0,0.00653076171875,0.0130615234375,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.0,0.00653076171875,0.0130615234375,0.0,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,-0.00653076171875,0.0,0.00653076171875,-0.00653076171875,0.00653076171875,-0.00653076171875,0.0,0.00653076171875,0.0,0.00653076171875,0.0,0.00653076171875,0.0,-0.00653076171875,0.00653076171875],[0.00653076171875,-0.00653076171875,-0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.0,0.00653076171875,0.0,0.0,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,-0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.00653076171875,-0.00653076171875,0.00653076171875,0.00653076171875,0.0,-0.0130615234375],[0.0,0.0130615234375,0.00653076171875,0.0,0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.00653076171875,-0.00653076171875,0.00653076171875,0.11767578125,0.0,0.0,0.0,0.0130615234375,0.00653076171875,-0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.00653076171875,-0.00653076171875,0.0130615234375],[0.0,0.00653076171875,0.00653076171875,0.0,-0.00653076171875,0.0,0.0130615234375,0.0,0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.0,-0.00653076171875,0.00653076171875,-0.00653076171875,0.0,0.0,-0.00653076171875,0.0,0.0,0.0,0.00653076171875,0.00653076171875,0.0,0.0,0.00653076171875,0.0,0.0,0.00653076171875],[0.00653076171875,0.0,0.0130615234375,0.0,0.00653076171875,0.00653076171875,0.0,-0.0130615234375,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.0,-0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.0,0.00653076171875,-0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.0],[0.00653076171875,0.00653076171875,0.0,0.0,-0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.0,0.0,0.00653076171875,0.00653076171875,-0.00653076171875,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.0,-0.00653076171875,-0.00653076171875,0.0,0.00653076171875,0.0,0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.00653076171875,0.0],[0.0,0.00653076171875,0.0,0.0,0.00653076171875,0.0,0.0,0.00653076171875,-0.00653076171875,0.00653076171875,0.00653076171875,-0.0196533203125,0.0,-0.00653076171875,0.0,0.0,0.0,0.0,0.0130615234375,0.0,-0.00653076171875,0.0,0.00653076171875,-0.00653076171875,0.0,0.0,-0.00653076171875,0.0,-0.00653076171875,0.0,0.0,0.00653076171875],[0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.00653076171875,0.0,0.0,0.00653076171875,0.0130615234375,0.00653076171875,0.00653076171875,-0.00653076171875,0.00653076171875,0.00653076171875,0.0,-0.0130615234375,0.00653076171875,0.0,0.0,0.00653076171875,0.0,0.0,0.00653076171875,0.00653076171875,0.0,0.00653076171875],[0.026123046875,-0.026123046875,-0.0196533203125,0.0,0.00653076171875,0.0,0.0,0.0,0.00653076171875,0.0,0.00653076171875,0.0,0.0,0.0,0.0,-0.00653076171875,-0.00653076171875,-0.0130615234375,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.00653076171875,-0.00653076171875,0.0,0.00653076171875,-0.0130615234375,-0.00653076171875,0.0,0.00653076171875,0.00653076171875],[0.0,0.0,-0.00653076171875,0.0,0.0,0.00653076171875,-0.0130615234375,0.0,-0.00653076171875,0.00653076171875,-0.0130615234375,-0.00653076171875,0.0,-0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.00653076171875,-0.00653076171875,0.00653076171875,0.00653076171875,-0.00653076171875,0.0130615234375,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00653076171875],[-0.00653076171875,0.0,0.0,-0.00653076171875,0.0,0.00653076171875,-0.00653076171875,0.0130615234375,0.00653076171875,0.0,0.00653076171875,0.0,0.0196533203125,-0.0130615234375,-0.00653076171875,0.00653076171875,0.0,-0.00653076171875,0.0,0.0,0.0,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.0130615234375,-0.00653076171875,-0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.00653076171875],[-0.00653076171875,0.0,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.00653076171875,0.0,0.0,0.00653076171875,0.0130615234375,0.00653076171875,0.0,-0.00653076171875,0.0,0.0,-0.00653076171875,0.0,0.0,-0.00653076171875,0.0,0.0130615234375,0.0,0.0,0.00653076171875,0.0130615234375,0.00653076171875,0.0,0.0],[0.0,0.0,0.00653076171875,0.0,0.00653076171875,-0.00653076171875,0.045654296875,0.0,0.0,-0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.058837890625,0.0,0.00653076171875,0.07177734375,0.0,0.0196533203125,-0.00653076171875,0.0,0.0,0.0,-0.00653076171875,0.0,-0.00653076171875,0.0,0.00653076171875,-0.00653076171875],[0.0,0.0,0.0,-0.00653076171875,0.0,0.0,0.0,0.00653076171875,0.0130615234375,0.0,0.00653076171875,0.0,0.00653076171875,0.0,0.0,0.00653076171875,0.1240234375,0.0,-0.00653076171875,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.0,-0.00653076171875],[-0.0130615234375,0.058837890625,0.03271484375,-0.0196533203125,0.0,0.0,0.0,0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.0,0.0,0.00653076171875,0.0,0.0,-0.058837890625,0.03271484375,0.0,0.0,0.0,0.0,0.0849609375,0.0,0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.039306640625,0.00653076171875,-0.03271484375,0.0],[0.00653076171875,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.00653076171875,0.0,0.00653076171875,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.039306640625,-0.0196533203125,0.0,0.169921875,0.0,0.0,0.00653076171875,0.00653076171875],[0.0,0.0,0.0,0.0,0.0,0.00653076171875,0.0,0.00653076171875,-0.00653076171875,0.0,-0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.0130615234375,0.0,0.00653076171875,-0.00653076171875,-0.00653076171875,0.0,0.00653076171875,0.00653076171875,-0.0130615234375,0.09814453125,0.00653076171875,0.0],[0.0,0.0,0.00653076171875,-0.00653076171875,0.0,0.0,0.00653076171875,0.0,0.00653076171875,0.00653076171875,0.0,0.0,0.00653076171875,0.0,0.0,-0.00653076171875,0.0,0.0,0.0,0.0,-0.045654296875,0.0,0.0,0.0849609375,0.00653076171875,0.0,0.0,0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.0],[0.00653076171875,0.0,0.00653076171875,0.0130615234375,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00653076171875,-0.111328125,0.0849609375,-0.248046875,0.0,0.00653076171875,0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00653076171875,0.0,0.00653076171875,0.0,0.00653076171875],[0.0,0.0,0.0196533203125,-0.03271484375,0.0,0.0,0.00653076171875,0.0,-0.00653076171875,0.0,0.03271484375,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00653076171875],[0.0,0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.03271484375,0.0,-0.0196533203125,0.00653076171875,0.00653076171875,0.0,-0.03271484375,0.169921875,0.0,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.00653076171875,0.0,0.00653076171875,0.0130615234375,0.00653076171875],[0.0,0.0,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.0130615234375,0.00653076171875,0.0,0.00653076171875,0.0,0.0,0.00653076171875,0.0130615234375,0.0,0.0,0.0,0.00653076171875,0.0,0.0,0.00653076171875,0.0,0.0,0.00653076171875,0.0130615234375,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00653076171875,0.00653076171875,0.00653076171875,0.00653076171875,0.0,0.00653076171875,0.0,0.00653076171875,0.0,0.00653076171875,0.0,0.00653076171875,0.039306640625,0.00653076171875,0.00653076171875,0.00653076171875,0.0],[0.0,0.0,0.00653076171875,0.0,0.0,0.0130615234375,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.1044921875,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.00653076171875,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.00653076171875,0.0,0.0],[0.0,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.1376953125,0.0,0.0,-0.0654296875,0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.0],[0.00653076171875,0.0,0.0,0.0,0.0,0.0,-0.0130615234375,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.1630859375,0.0130615234375,0.0196533203125,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00653076171875,0.0],[0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00653076171875,0.0130615234375,-0.05224609375,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0196533203125,0.0,-0.1044921875,0.039306640625,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0130615234375,0.09130859375,0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00653076171875,-0.07861328125,0.0130615234375,0.0196533203125,0.00653076171875,0.0,0.00653076171875,0.00653076171875],[0.0,0.00653076171875,-0.00653076171875,0.0130615234375,0.0,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.0,0.00653076171875,0.0,0.00653076171875,0.0,0.0,0.0,0.0,0.0,-0.0130615234375,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]],\"type\":\"heatmap\",\"xaxis\":\"x\",\"yaxis\":\"y\",\"hovertemplate\":\"Position: %{x}\\u003cbr\\u003eLayer: %{y}\\u003cbr\\u003eNorm. Logit Diff: %{z}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmapgl\":[{\"type\":\"heatmapgl\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"scaleanchor\":\"y\",\"constrain\":\"domain\",\"title\":{\"text\":\"Position\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"autorange\":\"reversed\",\"constrain\":\"domain\",\"title\":{\"text\":\"Layer\"}},\"coloraxis\":{\"colorbar\":{\"title\":{\"text\":\"Norm. Logit Diff\"}},\"colorscale\":[[0.0,\"rgb(103,0,31)\"],[0.1,\"rgb(178,24,43)\"],[0.2,\"rgb(214,96,77)\"],[0.3,\"rgb(244,165,130)\"],[0.4,\"rgb(253,219,199)\"],[0.5,\"rgb(247,247,247)\"],[0.6,\"rgb(209,229,240)\"],[0.7,\"rgb(146,197,222)\"],[0.8,\"rgb(67,147,195)\"],[0.9,\"rgb(33,102,172)\"],[1.0,\"rgb(5,48,97)\"]],\"cmid\":0.0},\"title\":{\"text\":\"Patching Llama Attention Heads on IOI task\"}},                        {\"responsive\": true}                    ).then(function(){\n",
              "                            \n",
              "var gd = document.getElementById('bf25c91a-837b-4756-a944-a36eb729c800');\n",
              "var x = new MutationObserver(function (mutations, observer) {{\n",
              "        var display = window.getComputedStyle(gd).display;\n",
              "        if (!display || display === 'none') {{\n",
              "            console.log([gd, 'removed!']);\n",
              "            Plotly.purge(gd);\n",
              "            observer.disconnect();\n",
              "        }}\n",
              "}});\n",
              "\n",
              "// Listen for the removal of the full notebook cells\n",
              "var notebookContainer = gd.closest('#notebook-container');\n",
              "if (notebookContainer) {{\n",
              "    x.observe(notebookContainer, {childList: true});\n",
              "}}\n",
              "\n",
              "// Listen for the clearing of the current output cell\n",
              "var outputEl = gd.closest('.output');\n",
              "if (outputEl) {{\n",
              "    x.observe(outputEl, {childList: true});\n",
              "}}\n",
              "\n",
              "                        })                };                            </script>        </div>\n",
              "</body>\n",
              "</html>"
            ]
          },
          "metadata": {},
          "output_type": "display_data"
        }
      ],
      "source": [
        "print(f\"Clean logit difference: {clean_logit_diff.value:.3f}\")\n",
        "print(f\"Corrupted logit difference: {corrupted_logit_diff.value:.3f}\")\n",
        "\n",
        "x_labels = [f\"Head {i}\" for i in range(N_HEADS)]\n",
        "\n",
        "fig2 = plot_ioi_patching_results(model, ioi_patching_results,x_labels,\"Patching Llama Attention Heads on IOI task\")\n",
        "fig2.show()"
      ]
    }
  ],
  "metadata": {
    "accelerator": "GPU",
    "colab": {
      "gpuType": "T4",
      "provenance": [],
      "toc_visible": true
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    },
    "widgets": {
      "application/vnd.jupyter.widget-state+json": {
        "06119adf2b49466ea5c1fb5f3224a0fe": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "ProgressStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "0c6ded3e7db74a8da985523bd7d2a6f1": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "1e49ae6793a14321aba8207d8772318f": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HTMLModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_3963c65fe2a84bf3ad648feed499b7d3",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_3f95484661a346bcb7582822593e23ff",
            "value": "config.json:‚Äá100%"
          }
        },
        "1f1bc29799d244b891a79212405832fa": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HTMLModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_38770f0e2bb94fb29c6ee5be1d9dea80",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_5e60a060ea7e4ad289ad976f02b7c9c4",
            "value": "‚Äá73.0/73.0‚Äá[00:00&lt;00:00,‚Äá4.33kB/s]"
          }
        },
        "206291aef2c546d38fe020aa009bd0d4": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HTMLModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_c71871240060494a918e444e69845350",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_fadcf1276348481ea0e7c93bd9f04fee",
            "value": "tokenizer.json:‚Äá100%"
          }
        },
        "29005f86684c442cb6ab02dbb14b5e4e": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "FloatProgressModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_ee68c445fe0042b4875091aafe690480",
            "max": 124,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_58d3a28df74e4ad0857afad43bf772c9",
            "value": 124
          }
        },
        "2e7b5869b36f41b3907bd9082f09b5de": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "2f6e0113a69e4329a801e55dd6928974": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "324381b074f74581b3766b17a7410964": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "38770f0e2bb94fb29c6ee5be1d9dea80": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "38e7582db57641acaa5b4f9b128623ac": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "ProgressStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "3925e93110404a69a2fbc84b5f76c23d": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HBoxModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_572ad0dc446b44db818eed2800cfba2b",
              "IPY_MODEL_a261cf4ba7484657b7bb75eb0b0ab026",
              "IPY_MODEL_1f1bc29799d244b891a79212405832fa"
            ],
            "layout": "IPY_MODEL_2f6e0113a69e4329a801e55dd6928974"
          }
        },
        "3963c65fe2a84bf3ad648feed499b7d3": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "3e175b1197d44c78955960dc39e8d6c4": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "3e3b18652e3e495797d7bc29d8e09fa4": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HBoxModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_ed2b8eb47db2427eb2b37abb6dfa1675",
              "IPY_MODEL_df53d8d0150a451993653498e7f14922",
              "IPY_MODEL_5030286cf09345d1b4b7d1b610b09aef"
            ],
            "layout": "IPY_MODEL_e9d367c973904a3aab42d88c84f87503"
          }
        },
        "3f95484661a346bcb7582822593e23ff": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "424cdc54e7c54637a9b847e59b892a87": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HTMLModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_cfcd3c63b4934c61a7e7712f1112f152",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_324381b074f74581b3766b17a7410964",
            "value": "‚Äá9.09M/9.09M‚Äá[00:01&lt;00:00,‚Äá8.60MB/s]"
          }
        },
        "437d8be7f184450ab88d3b2ccbab4985": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "45dbf06de8484628871dc530bd315972": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HTMLModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_0c6ded3e7db74a8da985523bd7d2a6f1",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_9c7ee0204d6c4b2ca435a989b98de661",
            "value": "model.safetensors:‚Äá100%"
          }
        },
        "5030286cf09345d1b4b7d1b610b09aef": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HTMLModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_f9d3b3feee00438f8b4eaaa5d7441a1e",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_3e175b1197d44c78955960dc39e8d6c4",
            "value": "‚Äá50.5k/50.5k‚Äá[00:00&lt;00:00,‚Äá927kB/s]"
          }
        },
        "54ab440b03474657b52ab4e977bc1d15": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "572ad0dc446b44db818eed2800cfba2b": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HTMLModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_54ab440b03474657b52ab4e977bc1d15",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_714dff0ccba84c658c6b8e590f1b3a87",
            "value": "special_tokens_map.json:‚Äá100%"
          }
        },
        "58d3a28df74e4ad0857afad43bf772c9": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "ProgressStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "5918d0ae0d634ecd932b7468be53f4e2": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "599f3b7e473b4f7995a563213809c7f8": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "5e60a060ea7e4ad289ad976f02b7c9c4": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "6173f84c7d5242ab88c451efac96b64a": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HTMLModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_aceff3c62acd4ac7a830e47b3cf3eb2f",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_5918d0ae0d634ecd932b7468be53f4e2",
            "value": "‚Äá826/826‚Äá[00:00&lt;00:00,‚Äá17.9kB/s]"
          }
        },
        "6179ed1bccc44989a94553920cc74c9e": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "61b058c2f75c4640be4a1bb7401ddf8d": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "63d58245a1c04c4db74bd0b3313bc223": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "66ca6abda0704a3e9e4c154a2cf58d8a": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "ProgressStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "6c68f3baea974294ada248d5c7d13dea": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HBoxModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_1e49ae6793a14321aba8207d8772318f",
              "IPY_MODEL_8be48e18bce14ae9b7036d3606e6ae14",
              "IPY_MODEL_6173f84c7d5242ab88c451efac96b64a"
            ],
            "layout": "IPY_MODEL_2e7b5869b36f41b3907bd9082f09b5de"
          }
        },
        "70a5e90548774a71bdb7612d5aeb06c6": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "714dff0ccba84c658c6b8e590f1b3a87": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "75f77c87cfa948c092840845f2767cfc": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "7a5f64126ec74db3bb9d04013fde3b45": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HBoxModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_ee797c3fb6f741fd8b1efa12d8e97797",
              "IPY_MODEL_29005f86684c442cb6ab02dbb14b5e4e",
              "IPY_MODEL_87ada532e0d3401c97245392f9a939b7"
            ],
            "layout": "IPY_MODEL_9b5c932896a5428a938ffd93db39278d"
          }
        },
        "7b2a0288b78b46f48641c510634ae797": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "87ada532e0d3401c97245392f9a939b7": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HTMLModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_7b2a0288b78b46f48641c510634ae797",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_c78f29d579c541bb8f5f4ed1cf69b2fb",
            "value": "‚Äá124/124‚Äá[00:00&lt;00:00,‚Äá6.43kB/s]"
          }
        },
        "896f138acb7c43bd85719203ce768e76": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HTMLModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_599f3b7e473b4f7995a563213809c7f8",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_c6240e4b5e1c43808ace93a3b3d2e448",
            "value": "‚Äá548M/548M‚Äá[00:02&lt;00:00,‚Äá178MB/s]"
          }
        },
        "8a52e2e0a0be483d84d5a03e1cf2ca82": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "ProgressStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "8a71d6a0477640e5a3ccd2b34593498c": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HBoxModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_206291aef2c546d38fe020aa009bd0d4",
              "IPY_MODEL_8d34ba2288b942e38a34452b087fa3c8",
              "IPY_MODEL_424cdc54e7c54637a9b847e59b892a87"
            ],
            "layout": "IPY_MODEL_c6c9199028e74f438406c19d0dcce39f"
          }
        },
        "8be48e18bce14ae9b7036d3606e6ae14": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "FloatProgressModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_bcb9240ae0c249d3a70fbe93c4f90dbd",
            "max": 826,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_38e7582db57641acaa5b4f9b128623ac",
            "value": 826
          }
        },
        "8d34ba2288b942e38a34452b087fa3c8": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "FloatProgressModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_d688719b4925479dad7a7ddd8437dbdd",
            "max": 9085658,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_8a52e2e0a0be483d84d5a03e1cf2ca82",
            "value": 9085658
          }
        },
        "9b5c932896a5428a938ffd93db39278d": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "9c7ee0204d6c4b2ca435a989b98de661": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "a261cf4ba7484657b7bb75eb0b0ab026": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "FloatProgressModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_a7dd27bea8c94f6fa672e0c9a857ba2d",
            "max": 73,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_06119adf2b49466ea5c1fb5f3224a0fe",
            "value": 73
          }
        },
        "a6c9c22f75764763bf3c5dd55820e587": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "a7dd27bea8c94f6fa672e0c9a857ba2d": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "aceff3c62acd4ac7a830e47b3cf3eb2f": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "bcb9240ae0c249d3a70fbe93c4f90dbd": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "c6240e4b5e1c43808ace93a3b3d2e448": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "c6c9199028e74f438406c19d0dcce39f": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "c71871240060494a918e444e69845350": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "c78f29d579c541bb8f5f4ed1cf69b2fb": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "cfcd3c63b4934c61a7e7712f1112f152": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "d688719b4925479dad7a7ddd8437dbdd": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "df53d8d0150a451993653498e7f14922": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "FloatProgressModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_61b058c2f75c4640be4a1bb7401ddf8d",
            "max": 50500,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_66ca6abda0704a3e9e4c154a2cf58d8a",
            "value": 50500
          }
        },
        "e9d367c973904a3aab42d88c84f87503": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "ea293e974aa14858ab422586abbd8b93": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "ProgressStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "ed2b8eb47db2427eb2b37abb6dfa1675": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HTMLModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_75f77c87cfa948c092840845f2767cfc",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_437d8be7f184450ab88d3b2ccbab4985",
            "value": "tokenizer_config.json:‚Äá100%"
          }
        },
        "ee68c445fe0042b4875091aafe690480": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "ee797c3fb6f741fd8b1efa12d8e97797": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HTMLModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_70a5e90548774a71bdb7612d5aeb06c6",
            "placeholder": "‚Äã",
            "style": "IPY_MODEL_63d58245a1c04c4db74bd0b3313bc223",
            "value": "generation_config.json:‚Äá100%"
          }
        },
        "f079ab3fa1134359b74cc7067b31ec2c": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "HBoxModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_45dbf06de8484628871dc530bd315972",
              "IPY_MODEL_fdda7734cb2748b5a4c7bcfddcd07746",
              "IPY_MODEL_896f138acb7c43bd85719203ce768e76"
            ],
            "layout": "IPY_MODEL_a6c9c22f75764763bf3c5dd55820e587"
          }
        },
        "f9d3b3feee00438f8b4eaaa5d7441a1e": {
          "model_module": "@jupyter-widgets/base",
          "model_module_version": "1.2.0",
          "model_name": "LayoutModel",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "fadcf1276348481ea0e7c93bd9f04fee": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "fdda7734cb2748b5a4c7bcfddcd07746": {
          "model_module": "@jupyter-widgets/controls",
          "model_module_version": "1.5.0",
          "model_name": "FloatProgressModel",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_6179ed1bccc44989a94553920cc74c9e",
            "max": 548105171,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_ea293e974aa14858ab422586abbd8b93",
            "value": 548105171
          }
        }
      }
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}
