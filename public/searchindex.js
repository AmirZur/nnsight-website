Search.setIndex({"docnames": ["about", "documentation", "documentation/contexts", "documentation/intervention", "documentation/models", "documentation/module", "documentation/patching", "documentation/tracing", "documentation/util", "features", "index", "notebooks/features/cross_prompt", "notebooks/features/getting", "notebooks/features/gradients", "notebooks/features/modules", "notebooks/features/multiple_token", "notebooks/features/operations", "notebooks/features/remote_execution", "notebooks/features/setting", "notebooks/features/token_indexing", "notebooks/tutorials/attribution_patching", "notebooks/tutorials/dictionary_learning", "notebooks/tutorials/function_vectors", "notebooks/tutorials/future_lens", "notebooks/tutorials/ioi_patching", "notebooks/tutorials/logit_lens", "notebooks/tutorials/sae", "notebooks/walkthrough", "start", "tutorials"], "filenames": ["about.rst", "documentation.rst", "documentation/contexts.rst", "documentation/intervention.rst", "documentation/models.rst", "documentation/module.rst", "documentation/patching.rst", "documentation/tracing.rst", "documentation/util.rst", "features.rst", "index.rst", "notebooks/features/cross_prompt.ipynb", "notebooks/features/getting.ipynb", "notebooks/features/gradients.ipynb", "notebooks/features/modules.ipynb", "notebooks/features/multiple_token.ipynb", "notebooks/features/operations.ipynb", "notebooks/features/remote_execution.ipynb", "notebooks/features/setting.ipynb", "notebooks/features/token_indexing.ipynb", "notebooks/tutorials/attribution_patching.ipynb", "notebooks/tutorials/dictionary_learning.ipynb", "notebooks/tutorials/function_vectors.ipynb", "notebooks/tutorials/future_lens.ipynb", "notebooks/tutorials/ioi_patching.ipynb", "notebooks/tutorials/logit_lens.ipynb", "notebooks/tutorials/sae.ipynb", "notebooks/walkthrough.ipynb", "start.rst", "tutorials.rst"], "titles": ["About nnsight", "Documentation", "nnsight.contexts", "nnsight.intervention", "nnsight.models", "nnsight.module", "nnsight.patching", "nnsight.tracing", "nnsight.util", "Features", "nnsight", "Cross-Prompt Intervention", "Getting Values", "Working With Gradients", "Applying Modules", "Multiple Token Generation", "Applying Operations", "Remote Execution", "Setting Values", "Token Based Indexing", "Attribution Patching", "Dictionary Learning", "Function Vectors", "Future Lens", "Activation Patching", "Logit Lens", "Dictionary Learning", "Walkthrough", "Getting Started", "Tutorials"], "terms": {"can": [0, 2, 3, 4, 5, 7, 11, 13, 14, 16, 18, 24, 26, 27], "studi": 0, "intern": [0, 10, 27, 28], "deep": [0, 28], "network": [0, 10, 24], "i": [0, 2, 3, 4, 5, 7, 8, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27, 28], "too": 0, "larg": [0, 10], "run": [0, 2, 4, 5, 7, 8, 24], "In": [0, 2, 4, 11, 13, 16, 18, 19, 27], "thi": [0, 2, 3, 4, 5, 7, 8, 11, 13, 16, 18, 19, 27], "era": 0, "scale": 0, "learn": [0, 28, 29], "most": [0, 2, 5, 16], "interest": [0, 24, 26], "model": [0, 1, 2, 3, 5, 7, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 28], "ar": [0, 2, 3, 4, 5, 7, 8, 12, 13, 16, 19, 27], "massiv": 0, "hard": 0, "ordinari": 0, "commerci": 0, "infer": [0, 4, 13, 20], "servic": 0, "let": [0, 19, 20, 24, 27], "interact": [0, 3, 4, 7, 13], "huge": 0, "thei": [0, 2, 7], "do": [0, 2, 3, 7, 13, 14, 20, 24, 27], "see": [0, 4, 13, 16, 18, 19, 20, 26, 27, 28], "The": [0, 2, 3, 4, 5, 6, 7, 12, 14, 15, 16, 18, 19, 27], "librari": 0, "differ": [0, 2, 19, 24], "give": [0, 4, 8, 27], "full": 0, "access": [0, 2, 3, 4, 5, 10, 12, 13], "all": [0, 2, 3, 4, 5, 7, 8, 13, 24], "neural": [0, 10], "when": [0, 2, 3, 4, 7, 15, 19, 20], "togeth": [0, 2], "remot": [0, 2, 9], "like": [0, 2, 4, 10, 13, 14, 27], "nation": 0, "facil": 0, "ndif": [0, 2], "experi": [0, 24], "open": 0, "easili": [0, 3, 27], "also": [0, 2, 4, 5, 6, 11, 13, 14, 27], "terrif": 0, "smaller": 0, "local": [0, 4, 27], "overview": 0, "pipelin": 0, "research": 0, "write": 0, "simpl": [0, 4, 8], "python": [0, 7, 19], "code": [0, 10], "along": [0, 3], "unlik": 0, "read": 0, "ani": [0, 2, 3, 4, 6, 7, 8, 10, 14, 27], "state": [0, 3, 4, 12, 13, 14, 15, 16, 18, 19, 24, 27], "being": [0, 7, 27], "creat": [0, 2, 4, 5, 7, 18, 27], "comput": [0, 2, 3, 4, 7, 8, 14, 16, 18, 27], "graph": [0, 2, 3, 4, 5, 7, 16, 27], "sent": 0, "interleav": [0, 3, 4, 7], "execut": [0, 2, 3, 4, 5, 7, 8, 9, 13, 27], "built": [0, 2, 7], "pytorch": [0, 4], "veri": 0, "similar": [0, 13], "your": [0, 27], "own": [0, 7, 27], "workstat": 0, "fact": [0, 27], "same": [0, 2, 7, 8, 11, 27], "small": 0, "just": [0, 7, 13, 19, 24, 27], "chang": [0, 16, 18, 27], "few": [0, 27], "argument": [0, 2, 3, 4, 7, 8], "between": [0, 11, 24], "normal": [0, 4, 13, 19, 24, 27], "treat": [0, 27], "opaqu": 0, "instead": [0, 8, 27], "set": [0, 2, 3, 5, 7, 9, 10, 27], "up": [0, 10, 24, 26], "context": [0, 1, 3, 4, 5, 6, 10, 12, 13, 24, 27], "enabl": [0, 3, 4, 10], "get": [0, 2, 5, 7, 8, 9, 10, 11, 13, 14, 15, 16, 19, 20, 24, 26, 27], "direct": [0, 4, 7], "while": [0, 8, 15], "here": [0, 2, 4, 11, 14, 15, 20, 24, 27], "look": [0, 14, 24], "from": [0, 2, 3, 4, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27], "import": [0, 4, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27], "languagemodel": [0, 2, 4, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27], "meta": [0, 2, 4, 5, 7], "llama": 0, "2": [0, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27], "70b": 0, "hf": 0, "forward": [0, 2, 4, 5, 7, 8, 12, 13, 19, 20, 24], "true": [0, 2, 4, 7, 8, 20, 26, 27], "runner": [0, 2, 3, 4, 13, 19, 20, 24, 27], "invok": [0, 2, 3, 4, 5, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27], "eiffel": [0, 2, 3, 4, 5, 12, 14, 15, 16, 18, 19], "tower": [0, 2, 3, 4, 5, 12, 14, 15, 16, 18, 19], "citi": [0, 2, 3, 4, 5, 11, 12, 14, 15, 16, 18, 19, 27], "hidden_st": [0, 2, 3, 5, 12, 13, 14, 16, 19], "layer": [0, 13, 14, 15, 20, 24, 26, 27], "10": [0, 15, 24, 27], "input": [0, 2, 3, 4, 5, 8, 12, 13, 19, 20, 24, 27], "save": [0, 2, 3, 4, 5, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27], "one": [0, 4, 5, 7, 8, 15, 24, 27], "hidden": [0, 3, 12, 13, 14, 15, 16, 18, 19, 24, 27], "11": [0, 4, 24, 27], "mlp": [0, 3, 4, 5, 26, 27], "output": [0, 2, 3, 4, 5, 7, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27], "0": [0, 2, 3, 4, 5, 7, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27], "modul": [0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 27], "print": [0, 2, 3, 4, 5, 8, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 27], "predict": [0, 4, 24], "wa": [0, 4, 27], "valu": [0, 2, 3, 4, 5, 7, 9, 11, 13, 14, 15, 16, 19, 20, 24, 26, 27], "easi": [0, 2], "huggingfac": [0, 4, 10, 27], "load": [0, 4, 24, 26], "object": [0, 2, 3, 4, 5, 6, 7, 8, 12, 24, 27], "wee": 0, "line": [0, 10, 27], "notic": [0, 19], "we": [0, 4, 5, 7, 11, 13, 14, 15, 16, 18, 19, 20, 24, 27], "70": [0, 14], "billion": 0, "paramet": [0, 2, 3, 4, 5, 6, 7, 8, 27], "which": [0, 2, 4, 5, 7, 8, 14, 27], "ordinarili": 0, "pretti": 0, "difficult": 0, "regular": 0, "sinc": [0, 8, 27], "would": [0, 3, 13, 26, 27], "take": [0, 3, 8], "140": 0, "280": 0, "gigabyt": 0, "gpu": [0, 4, 27], "ram": 0, "store": [0, 3, 7, 24, 27], "trick": 0, "u": [0, 14, 20, 26], "work": [0, 2, 3, 9, 11, 16, 27], "3": [0, 3, 4, 11, 12, 13, 15, 16, 18, 19, 20, 26, 27], "flag": 0, "indic": [0, 3, 7, 26, 27], "want": [0, 2, 13, 18, 27], "actual": [0, 2, 3, 4, 7, 14, 24, 27], "By": [0, 16], "default": [0, 2, 4, 7, 8], "If": [0, 2, 3, 4, 7, 8, 13, 27], "quickli": 0, "could": [0, 3, 11], "leav": 0, "fals": [0, 2, 4, 8, 13, 20, 26, 27], "Then": 0, "4": [0, 12, 16, 18, 19, 20, 24, 26, 27], "call": [0, 2, 3, 4, 5, 6, 7, 8, 11, 12, 13, 15, 19, 20, 24, 26, 27], "function": [0, 2, 3, 4, 5, 6, 7, 8, 19, 27, 28, 29], "manag": [0, 2, 3, 4, 6], "reason": [0, 16], "doe": [0, 5, 27], "provid": [0, 2, 3, 4, 13, 28], "5": [0, 12, 13, 16, 18, 20, 26, 27], "6": [0, 12, 16, 18, 20], "On": [0, 2, 27], "grab": [0, 11, 24], "insid": [0, 27], "transform": [0, 2, 3, 4, 5, 8, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24], "block": [0, 2, 10, 11], "calcul": [0, 13, 24], "outermost": 0, "complet": [0, 2, 3, 7, 27], "defin": [0, 8, 24], "cacul": 0, "server": [0, 2], "": [0, 2, 3, 4, 5, 7, 8, 12, 14, 19, 24, 26, 27], "done": [0, 3], "result": [0, 2, 3, 5, 7, 18, 19, 27], "shown": [0, 11], "7": [0, 12, 16, 18, 20], "8": [0, 12, 16, 18, 20, 26, 27], "help": 0, "understand": 0, "oper": [0, 2, 4, 5, 7, 9, 11, 18], "immedi": 0, "add": [0, 2, 3, 4, 5, 6, 7, 16, 18, 24], "intervent": [0, 1, 2, 4, 5, 9, 10, 15, 24], "alongsid": 0, "upon": [0, 3], "exit": [0, 2, 3, 12, 27], "exampl": [0, 2, 3, 4, 5, 13, 16, 18, 19], "seen": 0, "below": [0, 2, 5], "node": [0, 3, 5, 7], "depend": [0, 7], "well": [0, 2, 7], "other": [0, 4, 7, 27], "chosen": [0, 2], "request": [0, 5], "inject": 0, "basic": [0, 16, 28], "lot": 0, "insight": 0, "go": [0, 4], "For": [0, 3, 27], "logit": [0, 2, 3, 4, 5, 8, 13, 20, 24, 29], "len": [0, 20, 24, 29], "text": [0, 11, 13, 15, 19, 20, 26, 27], "And": 0, "causal": [0, 27], "trace": [0, 1, 2, 3, 4, 12, 13, 24], "path": [0, 3, 4, 5, 8], "patch": [0, 1, 29], "circuit": 0, "discoveri": 0, "method": [0, 2, 3, 4, 7, 8, 11, 13, 15, 19, 20, 26, 27], "locat": [0, 11, 27], "compon": [0, 27], "within": [0, 2, 4, 5, 8, 11, 13, 24], "plai": 0, "decis": 0, "role": 0, "make": [0, 2, 3, 24, 27], "thes": 0, "provi": 0, "gradient": [0, 9, 10], "optim": 0, "out": [0, 2, 4, 6, 7, 14, 27, 28], "order": [0, 2, 3, 4, 5, 7, 14, 27], "applic": [0, 27], "cross": [0, 8, 9], "prompt": [0, 2, 4, 9, 15, 20, 24, 26, 27], "mani": [0, 2, 7], "more": [0, 4, 7, 15, 27], "featur": [0, 2, 8, 10, 26, 27, 28], "start": [0, 2, 10, 27], "page": [0, 27], "inform": [0, 2, 4, 7, 18, 27], "project": 0, "current": [0, 2, 3, 7], "alpha": 0, "pre": [0, 2, 7, 11, 27], "releas": 0, "earli": 0, "user": [0, 3, 4, 5], "contributor": 0, "contribut": 0, "join": 0, "discord": 0, "updat": [0, 2, 3, 7, 8, 18, 20, 26], "bug": 0, "report": 0, "opportun": 0, "effort": 0, "nnsight": [1, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27, 28], "util": [1, 24], "contain": [2, 3, 4], "logic": [2, 3, 7], "primari": [2, 4], "two": [2, 4, 11, 13, 19, 24], "class": [2, 3, 4, 5, 6, 7, 8], "involv": [2, 3, 7], "tracer": [2, 5], "around": [2, 3, 4], "meta_model": [2, 4], "an": [2, 3, 4, 5, 6, 7, 8, 20, 26, 27], "abstractmodel": [2, 4, 5, 27], "track": [2, 4, 7, 27], "perform": [2, 4, 5, 7, 8, 19], "said": [2, 7], "expos": [2, 12], "attribut": [2, 3, 4, 5, 6, 7, 8, 12, 13, 29], "To": [2, 27, 28], "need": [2, 4, 7, 8, 24, 27], "know": 2, "about": [2, 26, 27], "so": [2, 3, 7, 12, 19, 27], "each": [2, 7, 15, 19, 27], "keep": 2, "batch_siz": [2, 3], "recent": [2, 5], "gener": [2, 3, 4, 5, 7, 9, 11, 12, 14, 16, 18, 27], "index": [2, 3, 7, 9, 20, 24, 27], "multi": [2, 4], "iter": [2, 3, 4, 24], "made": 2, "dure": [2, 3, 5, 7, 13, 14, 18], "its": [2, 4, 7, 10, 12], "batched_input": 2, "ad": [2, 3, 4, 7, 16, 27], "should": [2, 3, 7, 8, 15], "format": 2, "where": [2, 4, 7, 24], "batch": [2, 3, 4, 8, 20, 24], "allow": [2, 3, 4, 7, 13, 14], "thing": [2, 13, 14], "consist": [2, 27], "valid": [2, 7], "both": [2, 3, 4, 19], "becom": [2, 27], "case": [2, 4, 11, 27], "regardless": 2, "whether": 2, "string": [2, 5, 7, 8, 19], "process": [2, 7, 13, 27], "dictionari": [2, 29], "id": [2, 4, 8, 10, 27], "onli": [2, 3, 4, 5, 7, 8, 10, 18, 20, 27], "us": [2, 3, 4, 7, 8, 11, 13, 14, 15, 18, 19, 20, 24, 26, 27], "carri": [2, 6, 7], "what": [2, 18, 24], "accept": [2, 4], "parent": [2, 6, 7], "appropri": 2, "respect": [2, 5], "enter": [2, 4, 11, 24], "some": [2, 7, 8, 26, 27], "leverag": [2, 4], "prepar": [2, 4, 7], "version": [2, 4, 7], "size": [2, 3, 5, 8, 15, 27], "It": [2, 4, 7, 26], "through": [2, 3, 4, 5, 7, 8, 24, 27, 28], "dtype": [2, 5], "base": [2, 3, 7, 9], "characterist": 2, "come": [2, 11, 17, 21, 22, 23, 25], "implement": [2, 4, 7, 28], "_gener": [2, 4], "_forward": [2, 4], "rich": [2, 19], "new": [2, 7, 11, 18], "eventu": 2, "ha": [2, 4, 7, 8], "assum": 2, "arg": [2, 3, 4, 7, 8], "bool": [2, 4, 7, 8], "kwarg": [2, 4, 7, 8, 27], "given": [2, 7, 8, 24, 27], "_run_loc": 2, "show": [2, 5, 24, 27], "gpt2": [2, 4, 5, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24], "them": [2, 3, 4, 5, 7, 8, 11, 16, 24], "after": [2, 4, 7, 8, 12, 13, 15, 20, 24, 27], "lm_head": [2, 3, 4, 5, 13, 14, 20, 24], "zero": [2, 5, 27], "h": [2, 3, 4, 5, 8, 12, 13, 14, 15, 16, 18, 19, 20, 24], "otherwis": [2, 5, 7], "type": [2, 3, 4, 5, 6, 7, 8], "option": [2, 4, 7, 8], "hang": 2, "until": [2, 27], "job": 2, "return": [2, 3, 4, 5, 7, 8, 15, 20, 27], "you": [2, 3, 4, 7, 11, 12, 13, 15, 19, 20, 26, 27], "retriev": [2, 3, 8], "run_loc": 2, "local_model": [2, 4, 20], "th": 2, "later": [2, 27], "posit": [2, 3, 4, 7, 24, 27], "pass": [2, 4, 5, 7, 8, 10, 13, 24], "list": [2, 3, 4, 5, 6, 7, 27], "keyword": [2, 4, 7, 27], "dict": [2, 4, 7, 27], "str": [2, 3, 4, 5, 6, 7, 8], "proxi": [2, 3, 5, 7, 16, 24, 27], "int": [2, 4, 7], "batch_start": [2, 3], "generation_idx": [2, 7], "idx": [2, 3, 19], "__exit__": [2, 3, 6], "scan": 2, "meant": [2, 4], "tandem": [2, 4], "initi": [2, 4, 5, 15, 27], "post": [2, 7], "_prepare_input": 2, "_scan": 2, "potenti": [2, 3], "correctli": [2, 19, 27], "free": [2, 7], "wise": 2, "mai": [2, 27], "turn": [2, 13], "loop": 2, "shape": [2, 3, 5, 7, 8, 15, 18, 20, 27], "error": [2, 7], "have": [2, 3, 7, 11, 19, 26], "first": [2, 3, 4, 5, 7, 8, 11, 19, 20, 24, 27], "next": [2, 15], "increment": [2, 7], "1": [2, 4, 8, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27], "none": [2, 3, 4, 6, 7], "design": [2, 3], "subsequ": [2, 3, 15], "appli": [2, 3, 4, 8, 9, 15, 24, 27], "how": [2, 5, 15, 16, 19, 26, 27], "onc": [2, 12], "save_al": 2, "module_path": [2, 3, 5], "kei": [2, 3, 4, 6, 7, 10], "interventionproxi": [3, 5], "extend": 3, "fx": 3, "easier": 3, "interven": [3, 18], "entri": [3, 7], "hook": [3, 4, 5, 7, 8, 13, 27], "hookmodel": 3, "remov": [3, 7], "module_kei": 3, "input_hook": 3, "callabl": [3, 7, 8], "output_hook": 3, "backward_input_hook": 3, "backward_output_hook": 3, "regist": [3, 8], "__enter__": [3, 6], "root": [3, 4, 5, 7, 8], "torch": [3, 4, 5, 7, 8, 13, 14, 15, 16, 18, 20, 26, 27], "nn": [3, 4, 5, 7, 26], "tupl": [3, 7, 24, 27], "signatur": 3, "handl": [3, 6], "removablehandl": 3, "sub": [3, 4], "addit": 3, "delet": [3, 12], "listen": [3, 7], "had": 3, "been": [3, 8], "token": [3, 4, 8, 9, 11, 13, 14, 20, 24, 26, 27], "t": [3, 19, 24, 26, 27], "multipl": [3, 7, 9, 19, 24], "pad": [3, 11, 13, 15, 19, 20, 26, 27], "mean": [3, 20, 27], "shift": [3, 8], "care": [3, 8], "collect": [3, 8], "tensor": [3, 4, 5, 7, 8, 11, 12, 13, 14, 16, 18, 19, 20], "popul": [3, 5, 7, 12], "properti": [3, 5, 7], "union": [3, 4, 7], "tokenindex": 3, "alia": 3, "directli": [3, 4], "second": [3, 11], "dimens": [3, 26], "neg": 3, "left": [3, 19], "equival": 3, "helper": [3, 8, 19], "aid": 3, "activ": [3, 4, 10, 26, 27, 29], "form": [3, 4, 7], "check": [3, 4, 7, 27, 28], "argument_node_nam": [3, 7], "exist": [3, 5], "name": [3, 4, 7, 20], "narrow": 3, "select": 3, "relev": [3, 27], "view": [3, 7], "oppos": 3, "copi": 3, "downstream": [3, 4, 5, 27], "edit": [3, 18], "origin": [3, 6, 27], "prevent": [3, 26], "effect": 3, "bath": 3, "outsid": [3, 7], "preview": 3, "either": [3, 7], "rel": [3, 5], "denot": [3, 5, 15], "modifi": 3, "main": 4, "wrap": [4, 5, 7, 8], "repo": [4, 10, 27], "device_map": [4, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27], "cuda": [4, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27], "declar": 4, "entail": 4, "underli": [4, 27], "automodelforcausallm": [4, 27], "unus": 4, "acceler": 4, "packag": [4, 8, 10, 20, 26, 28], "encompass": 4, "displai": 4, "structur": [4, 27], "abil": 4, "itself": 4, "gpt2lmheadmodel": 4, "gpt2model": 4, "wte": [4, 11], "embed": [4, 11, 27], "50257": 4, "768": [4, 15], "wpe": 4, "1024": 4, "drop": 4, "dropout": [4, 27], "p": [4, 27], "inplac": [4, 27], "modulelist": [4, 5, 27], "12": [4, 14, 24, 27], "x": [4, 5, 8, 24, 27], "gpt2block": 4, "ln_1": 4, "layernorm": [4, 27], "ep": [4, 27], "1e": [4, 20, 27], "05": [4, 27], "elementwise_affin": [4, 27], "attn": [4, 20], "gpt2attentionalt": 4, "c_attn": 4, "conv1d": 4, "c_proj": 4, "attn_dropout": [4, 20], "resid_dropout": 4, "queri": 4, "wrappermodul": [4, 8], "ln_2": 4, "gpt2mlp": 4, "c_fc": 4, "act": [4, 5, 7, 27], "newgeluactiv": 4, "ln_f": [4, 14], "linear": [4, 26, 27], "in_featur": [4, 26, 27], "out_featur": [4, 26, 27], "bia": [4, 26, 27], "determin": 4, "behavior": 4, "three": [4, 15], "invoc": [4, 11, 19, 24], "languag": [4, 27], "over": [4, 27], "max_new_token": [4, 11, 15, 16, 18], "logits1": 4, "empir": 4, "build": 4, "logits2": 4, "repoid_path_model": 4, "dispatch": [4, 20, 27], "alter": 4, "abstract": 4, "wish": [4, 5], "gain": 4, "repoid_path_clsnam": 4, "hug": 4, "face": 4, "checkpoint": [4, 26], "custom": 4, "bee": 4, "yet": [4, 27], "init": 4, "custom_model": 4, "devic": [4, 7, 12, 13, 14, 16, 18, 19, 20, 27], "ran": [4, 7], "specif": [4, 5, 19, 27], "ultim": 4, "A": [4, 7], "doc": [4, 10], "limit": 4, "amount": 4, "anf": 4, "extra": 4, "fwd_arg": [4, 27], "rtype": 4, "node_nam": 4, "module_nam": 4, "_summary_": 4, "_description_": [4, 7], "automodel": 4, "auto": [4, 20, 26], "modeling_auto": 4, "wrapper": [4, 8, 27], "generationmixin": 4, "config": 4, "file": 4, "repositori": 4, "pretrainedconfig": 4, "lm": 4, "pretrainedtoken": 4, "pretrainedmodel": 4, "diffusermodel": 4, "diffus": 4, "entrypoint": 5, "interwoven": 5, "manipul": [5, 10, 28], "requir": [5, 26], "correct": [5, 7, 19, 24, 27], "tree": [5, 14, 27], "repres": [5, 6, 7, 24], "separ": [5, 8, 27], "e": [5, 7, 8], "reset": [5, 7], "output_shap": 5, "nest": 5, "output_typ": 5, "input_shap": 5, "input_typ": 5, "must": [5, 7], "manual": 5, "backward_input": [5, 13, 20], "therefor": [5, 7], "time": [5, 8, 26, 27], "refer": [5, 7], "alreadi": [5, 27], "backward_output": [5, 13], "static": [5, 7], "our": [5, 20, 24, 27], "data": [5, 7, 8, 27], "replac": [6, 7, 11], "obj": 6, "restor": [6, 27], "patcher": 6, "point": [7, 10, 14], "flow": [7, 18], "AND": 7, "proxy_valu": 7, "datatyp": 7, "set_valu": 7, "bi": 7, "convert": 7, "respons": 7, "similarli": 7, "ceas": 7, "destroi": 7, "memori": 7, "re": [7, 11, 13, 15, 19, 20, 26, 27], "remain": 7, "traceabl": 7, "magic": 7, "__torch_function__": 7, "find": [7, 24, 26], "shame": 7, "proxy_class": 7, "reserv": 7, "target": [7, 8], "There": [7, 13], "singl": 7, "__init__": [7, 8], "compil": 7, "whatev": [7, 16], "Their": 7, "map": 7, "These": [7, 27], "kick": 7, "swp": 7, "swap": 7, "null": 7, "never": [7, 26], "possibl": 7, "etc": 7, "name_idx": 7, "target_nam": 7, "number": [7, 26], "previou": 7, "uniqu": 7, "module_proxi": 7, "pull": 7, "rais": 7, "valueerror": 7, "than": [7, 11, 13, 15, 19, 20, 26, 27], "final": [7, 20, 27], "module_0": 7, "consid": [7, 27], "specifi": [7, 27], "desc": 7, "action": 7, "whole": [7, 24], "_proxy_devic": 7, "remaining_listen": 7, "remaining_depend": 7, "log": 7, "destruct": 7, "noth": [7, 26], "fulfil": 7, "prepare_input": 7, "move": [7, 27], "prepare_proxy_valu": 7, "proxy_devic": 7, "lazi": 7, "creation": 7, "redund": 7, "event": 7, "now": [7, 19, 24, 27], "proxy_wrapp": 7, "fn": [7, 8], "problemat": 7, "sometim": 7, "throughout": 8, "element": 8, "everi": [8, 26], "overridden": 8, "subclass": 8, "although": 8, "recip": 8, "instanc": 8, "afterward": 8, "former": 8, "latter": 8, "silent": 8, "ignor": 8, "cl": 8, "member": 8, "kind": 8, "cross_entropy_loss": 8, "target_id": 8, "avg_batch": 8, "avg_token": 8, "entropi": 8, "loss": 8, "n": 8, "last": [8, 13, 14, 15], "averag": 8, "across": [8, 15], "fetch_attr": 8, "hierarchi": 8, "level": 8, "fetch": 8, "func": 8, "lggr": 8, "decor": 8, "__class__": 8, "With": 9, "interpret": [10, 28], "\u025bn": [10, 28], "sa\u026at": [10, 28], "tutori": [10, 28], "integr": 10, "weight": [10, 26, 27], "intuit": 10, "coupl": [10, 13], "interoper": 10, "grad": [10, 13], "train": 10, "lora": 10, "probe": 10, "madison": 11, "squar": 11, "garden": 11, "_": [11, 24, 27], "decod": [11, 14, 20, 24, 26, 27], "39": [11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 26, 27], "gpt2tokenizerfast": [11, 13, 15, 19, 20], "pleas": [11, 13, 15, 19, 20, 26, 27], "note": [11, 13, 15, 19, 20, 26, 27], "fast": [11, 13, 15, 19, 20, 26, 27], "__call__": [11, 13, 15, 19, 20, 26, 27], "faster": [11, 13, 15, 19, 20, 26, 27], "encod": [11, 13, 15, 19, 20, 26, 27], "follow": [11, 13, 15, 19, 20, 26, 27], "york": 11, "desir": [12, 27], "0505": [12, 16], "1728": [12, 16], "1690": [12, 16], "0096": [12, 16], "1280": [12, 16], "0687": [12, 16], "7494": [12, 16], "9057": [12, 16], "3024": [12, 16], "0418": [12, 16], "2964": [12, 16], "8677": [12, 16], "2960": [12, 16], "6686": [12, 16], "6642": [12, 16], "2391": [12, 16], "6064": [12, 16], "2263": [12, 16], "1537": [12, 16], "8917": [12, 16], "8651": [12, 16], "0588": [12, 16], "9866": [12, 16], "9188": [12, 16], "4460": [12, 16], "4285": [12, 16], "9": [12, 16, 18, 24, 27], "3065": [12, 16], "0528": [12, 16], "7947": [12, 16], "5556": [12, 16], "6286": [12, 16], "7258": [12, 16], "7969": [12, 16], "6714": [12, 16], "0683": [12, 16], "0481": [12, 16], "wai": [13, 24, 26, 27], "backward": [13, 20, 27], "sum": [13, 16, 26], "off": [13, 26], "mode": 13, "hello": 13, "world": [13, 26], "5216": 13, "1755": 13, "4617": 13, "1919": 13, "0204": 13, "0075": 13, "9841": 13, "2175": 13, "5851": 13, "5212": 13, "2286": 13, "7334": 13, "grad_fn": 13, "lt": 13, "slicebackward0": 13, "gt": 13, "retain_grad": 13, "asstridedbackward0": 13, "28": 13, "7976": 13, "282": 13, "5977": 13, "868": 13, "7343": 13, "120": 13, "1742": 13, "52": 13, "2264": 13, "168": 13, "6447": 13, "79": 13, "4183": 13, "253": 13, "6227": 13, "1322": 13, "1290": 13, "208": 13, "3981": 13, "19": 13, "5544": 13, "509": 13, "9856": 13, "via": 13, "hidden_states_grad": 13, "anoth": [14, 27], "even": [14, 27], "usual": 14, "chain": 14, "vocabularli": 14, "space": [14, 24], "softmax": [14, 27], "argmax": 14, "vocabulari": 14, "dim": [14, 20, 26, 27], "36": 14, "2875": 14, "35": 14, "0115": 14, "38": 14, "0794": 14, "40": 14, "5164": 14, "41": 14, "3760": 14, "34": 14, "9194": 14, "68": 14, "8886": 14, "1562": 14, "71": 14, "8408": 14, "80": 14, "4194": 14, "78": 14, "2552": 14, "1206": 14, "82": 14, "2950": 14, "81": 14, "6519": 14, "83": 14, "9940": 14, "94": 14, "4878": 14, "5194": 14, "85": 14, "6997": 14, "113": 14, "8675": 14, "111": 14, "8628": 14, "6634": 14, "116": 14, "7652": 14, "114": 14, "8267": 14, "112": 14, "3621": 14, "8531": 14, "3007": 14, "91": 14, "8193": 14, "92": 14, "9943": 14, "89": 14, "8382": 14, "6898": 14, "103": 14, "9307": 14, "102": 14, "5054": 14, "105": 14, "1563": 14, "109": 14, "3099": 14, "110": 14, "4196": 14, "1395": 14, "198": 14, "417": 14, "8765": 14, "318": 14, "257": 14, "262": 14, "3504": 14, "7372": 14, "6342": 14, "el": 14, "middl": 14, "centr": 14, "pari": [14, 27], "hidden_states1": 15, "hidden_states2": 15, "hidden_states3": 15, "befor": [15, 24, 26, 27], "themselv": 16, "variou": 16, "step": [16, 26], "hidden_states_pr": [16, 18], "hs_sum": 16, "hs_edit": 16, "501": 16, "2947": 16, "3452": 16, "1219": 16, "1257": 16, "500": 16, "2851": 16, "4227": 16, "2260": 16, "510": 16, "0441": 16, "504": 16, "2004": 16, "506": 16, "5971": 16, "493": 16, "2528": 16, "502": 16, "5910": 16, "498": 16, "4269": 16, "5907": 16, "505": 16, "9633": 16, "497": 16, "6305": 16, "5338": 16, "6883": 16, "5210": 16, "503": 16, "4483": 16, "508": 16, "1864": 16, "1598": 16, "3535": 16, "499": 16, "3081": 16, "507": 16, "2135": 16, "8487": 16, "7232": 16, "491": 16, "9882": 16, "3475": 16, "5000": 16, "8503": 16, "9232": 16, "0205": 16, "0916": 16, "9661": 16, "3629": 16, "3428": 16, "soon": [17, 21, 22, 23, 25, 26], "often": 18, "happen": [18, 24], "nois": 18, "assig": 18, "001": 18, "randn": 18, "hidden_states_post": 18, "0197e": 18, "03": 18, "1157e": 18, "01": 18, "3560e": 18, "5050e": 18, "1737e": 18, "0768e": 18, "00": 18, "7405e": 18, "8481e": 18, "2863e": 18, "0872e": 18, "2464e": 18, "8597e": 18, "0816e": 18, "6882e": 18, "6241e": 18, "5548e": 18, "5845e": 18, "2085e": 18, "1914e": 18, "8865e": 18, "8589e": 18, "3585e": 18, "02": 18, "9566e": 18, "9064e": 18, "0466e": 18, "4140e": 18, "3035e": 18, "0717e": 18, "7665e": 18, "0897e": 18, "5553e": 18, "7157e": 18, "7861e": 18, "6273e": 18, "0340e": 18, "0660e": 18, "As": [19, 27], "preliminari": 19, "why": 19, "necessari": 19, "length": 19, "incorrectli": 19, "incorrect_a": 19, "incorrect_b": 19, "f": [19, 20, 24, 27], "shorter": 19, "longer": [19, 27], "50256": 19, "464": 19, "reciev": 19, "becaus": [19, 24, 27], "side": 19, "back": 19, "correct_a": 19, "correct_b": 19, "techniqu": [20, 27, 28], "circuitsvi": [20, 26], "cv": 20, "einop": 20, "share": [20, 26], "caden": [20, 26], "conda": [20, 26], "env": [20, 26], "interp": [20, 26], "lib": [20, 26], "python3": [20, 26], "site": [20, 26], "tqdm": [20, 26], "py": [20, 26], "21": [20, 26, 27], "tqdmwarn": [20, 26], "iprogress": [20, 26], "found": [20, 26], "jupyt": [20, 26], "ipywidget": [20, 26], "http": [20, 26], "readthedoc": [20, 26], "io": [20, 26], "en": [20, 26], "stabl": [20, 26], "user_instal": [20, 26], "html": [20, 26], "autonotebook": [20, 26], "notebook_tqdm": [20, 26], "john": [20, 24, 27], "mari": [20, 24, 27], "went": [20, 24, 27], "shop": 20, "gave": [20, 24], "bag": 20, "tom": 20, "jame": 20, "park": 20, "ball": 20, "dan": 20, "sid": 20, "appl": 20, "martin": 20, "ami": 20, "drink": 20, "answer": [20, 24, 27], "clean_token": [20, 24], "return_tensor": 20, "pt": [20, 26], "input_id": [20, 24, 27], "corrupted_token": 20, "els": 20, "rang": [20, 24, 27], "answer_token_indic": 20, "j": 20, "def": [20, 27], "ioi_metr": 20, "clean_baselin": 20, "corrupted_baselin": 20, "get_logit_diff": 20, "correct_logit": 20, "gather": 20, "unsqueez": 20, "incorrect_logit": 20, "clean_logit": [20, 24], "clean_logit_diff": [20, 24], "item": [20, 24, 26, 27], "clean_cach": 20, "clean_grad_cach": 20, "corrupted_logit": [20, 24], "corrupted_logit_diff": [20, 24], "corrupted_cach": 20, "corrupted_grad_cach": 20, "clean_valu": 20, "corrupted_valu": 20, "stack": [20, 26], "clean": [20, 24, 27], "corrupt": [20, 24, 27], "create_attention_attr": 20, "attention_attr": 20, "rearrang": 20, "head_index": 20, "dest": 20, "src": 20, "n_layer": [20, 27], "n_head": 20, "num_head": 20, "head_nam": 20, "l": 20, "head_names_sign": 20, "sign": 20, "head_names_qkv": 20, "act_nam": 20, "q": 20, "k": 20, "v": 20, "plot_attention_attr": 20, "top_k": 20, "20": [20, 26], "titl": [20, 24, 27], "attention_attr_po": 20, "clamp": 20, "min": 20, "attention_attr_neg": 20, "max": [20, 26], "attention_attr_sign": 20, "attention_attr_indic": 20, "argsort": 20, "descend": 20, "head_label": 20, "attent": [20, 27], "attention_head": 20, "attention_head_nam": 20, "l0h0": 20, "l0h1": 20, "l0h2": 20, "l0h3": 20, "l0h4": 20, "l0h0q": 20, "l0h0k": 20, "l0h0v": 20, "l0h1q": 20, "l0h1k": 20, "sequenc": 20, "indirect": 24, "identif": 24, "task": 24, "plotli": [24, 27], "express": [24, 27], "px": [24, 27], "clean_prompt": 24, "bottl": 24, "milk": [24, 27], "corrupted_prompt": 24, "word": 24, "That": 24, "compar": 24, "sure": 24, "combin": [24, 27], "were": 24, "don": 24, "end": 24, "correct_index": 24, "incorrect_index": 24, "1757": 24, "5335": 24, "thank": 24, "break": [24, 27], "No": 24, "clean_h": 24, "layer_idx": 24, "incorrect": 24, "ioi_patching_result": 24, "_ioi_patching_result": 24, "token_idx": 24, "patched_logit": 24, "patched_logit_diff": 24, "improv": 24, "patched_result": 24, "append": [24, 26, 27], "3f": [24, 27], "lambda": 24, "token_label": [24, 27], "enumer": [24, 27], "fig": [24, 27], "imshow": [24, 27], "color_continuous_midpoint": [24, 27], "color_continuous_scal": [24, 27], "rdbu": [24, 27], "label": [24, 27], "y": [24, 27], "residu": [24, 27], "stream": [24, 27], "ioi": 24, "124": 24, "272": 24, "dictionary_learn": 26, "autoencod": 26, "weights_path": 26, "pythia": [26, 27], "70m": 26, "dedup": 26, "mlp_out_layer0": 26, "0_8192": 26, "ae_99000": 26, "activation_dim": 26, "512": 26, "dictionary_s": 26, "16": [26, 27], "ae": 26, "load_state_dict": 26, "8192": [26, 27], "eleutherai": [26, 27], "me": 26, "ishmael": 26, "year": 26, "ago": 26, "mind": 26, "long": 26, "precis": 26, "littl": 26, "monei": 26, "my": 26, "purs": 26, "particular": 26, "shore": 26, "thought": 26, "sail": 26, "wateri": 26, "part": 26, "drive": 26, "spleen": 26, "regul": 26, "circul": 26, "whenev": 26, "myself": 26, "grow": 26, "grim": 26, "mouth": 26, "damp": 26, "drizzli": 26, "novemb": 26, "soul": 26, "involuntarili": 26, "paus": 26, "coffin": 26, "warehous": 26, "bring": 26, "rear": 26, "funer": 26, "meet": 26, "especi": 26, "hypo": 26, "upper": 26, "hand": [26, 27], "strong": 26, "moral": 26, "principl": 26, "deliber": 26, "street": 26, "knock": 26, "peopl": 26, "hat": 26, "account": 26, "high": 26, "sea": 26, "mlp_0": 26, "gpt_neox": [26, 27], "gptneoxtokenizerfast": [26, 27], "summed_activ": 26, "ab": 26, "sort": 26, "top_activations_indic": 26, "topk": [26, 27], "top": 26, "compound": 26, "cpu": 26, "colored_tokens_multi": 26, "str_token": 26, "pretrain": 27, "ll": 27, "1b": 27, "onto": 27, "abov": 27, "command": 27, "download": 27, "configur": 27, "machin": 27, "from_pretrain": 27, "diffusionmodel": 27, "imag": 27, "disffus": 27, "encourag": 27, "inherit": 27, "though": 27, "still": 27, "inspect": 27, "gptneoxforcausallm": 27, "gptneoxmodel": 27, "embed_in": 27, "50304": 27, "2048": 27, "emb_dropout": 27, "15": 27, "gptneoxlay": 27, "input_layernorm": 27, "post_attention_layernorm": 27, "post_attention_dropout": 27, "post_mlp_dropout": 27, "gptneoxattent": 27, "rotary_emb": 27, "gptneoxrotaryembed": 27, "query_key_valu": 27, "6144": 27, "dens": 27, "attention_dropout": 27, "gptneoxmlp": 27, "dense_h_to_4h": 27, "dense_4h_to_h": 27, "geluactiv": 27, "final_layer_norm": 27, "embed_out": 27, "extract": 27, "last_hidden_st": 27, "aren": 27, "13": 27, "down": 27, "tell": 27, "modif": 27, "detail": 27, "cach": 27, "simplest": 27, "inner": 27, "put": 27, "probabl": 27, "One": 27, "intermedi": 27, "crude": 27, "approxim": 27, "trigger": 27, "those": 27, "norm": 27, "unembed": 27, "all_prob": 27, "prob": 27, "distribut": 27, "evolv": 27, "mary_token": 27, "layer_prob": 27, "accord": 27, "suggest": 27, "begin": 27, "realiz": 27, "confid": 27, "countri": 27, "best": 27, "guess": 27, "franc": 27, "tok": 27, "zip": 27, "425": 27, "096": 27, "022": 27, "belgium": 27, "008": 27, "prov": 27, "007": 27, "luxem": 27, "saint": 27, "la": 27, "represent": 27, "confus": 27, "certain": 27, "caus": 27, "again": 27, "subject_idx": 27, "fourth": 27, "answer_token": 27, "0022770469076931477": 27, "all_hidden_st": 27, "record": 27, "n_token": 27, "intervened_prob": 27, "22": 27, "visual": 27, "token_id": 27, "squeez": 27, "meng": 27, "et": 27, "al": 27, "2022": 27, "document": 27, "readm": 27, "guid": 27, "pip": 28, "walkthrough": 28, "walk": 28, "common": 28, "futur": 29, "vector": 29}, "objects": {"nnsight": [[2, 0, 0, "-", "contexts"], [3, 0, 0, "-", "intervention"], [4, 0, 0, "-", "models"], [5, 0, 0, "-", "module"], [6, 0, 0, "-", "patching"], [7, 0, 0, "-", "tracing"], [8, 0, 0, "-", "util"]], "nnsight.contexts": [[2, 0, 0, "-", "Invoker"], [2, 0, 0, "-", "Runner"], [2, 0, 0, "-", "Tracer"]], "nnsight.contexts.Invoker": [[2, 1, 1, "", "Invoker"]], "nnsight.contexts.Invoker.Invoker": [[2, 2, 1, "", "args"], [2, 2, 1, "", "input"], [2, 2, 1, "", "kwargs"], [2, 3, 1, "", "next"], [2, 3, 1, "", "save_all"], [2, 2, 1, "", "scan"], [2, 2, 1, "", "tracer"]], "nnsight.contexts.Runner": [[2, 1, 1, "", "Runner"]], "nnsight.contexts.Runner.Runner": [[2, 2, 1, "", "blocking"], [2, 2, 1, "", "generation"], [2, 2, 1, "", "remote"], [2, 3, 1, "", "run_local"]], "nnsight.contexts.Tracer": [[2, 1, 1, "", "Tracer"]], "nnsight.contexts.Tracer.Tracer": [[2, 2, 1, "", "args"], [2, 2, 1, "", "batch_size"], [2, 2, 1, "", "batch_start"], [2, 2, 1, "", "generation_idx"], [2, 2, 1, "", "graph"], [2, 2, 1, "", "kwargs"], [2, 2, 1, "", "model"], [2, 2, 1, "", "output"]], "nnsight.intervention": [[3, 1, 1, "", "HookModel"], [3, 1, 1, "", "InterventionProxy"], [3, 1, 1, "", "TokenIndexer"], [3, 5, 1, "", "intervene"]], "nnsight.intervention.HookModel": [[3, 2, 1, "", "handles"], [3, 2, 1, "", "input_hook"], [3, 2, 1, "", "model"], [3, 2, 1, "", "modules"], [3, 2, 1, "", "output_hook"]], "nnsight.intervention.InterventionProxy": [[3, 3, 1, "", "save"], [3, 4, 1, "", "shape"], [3, 4, 1, "", "t"], [3, 4, 1, "", "token"], [3, 4, 1, "", "value"]], "nnsight.models": [[4, 0, 0, "-", "AbstractModel"], [4, 0, 0, "-", "DiffuserModel"], [4, 0, 0, "-", "LanguageModel"]], "nnsight.models.AbstractModel": [[4, 1, 1, "", "AbstractModel"]], "nnsight.models.AbstractModel.AbstractModel": [[4, 2, 1, "", "alter"], [4, 2, 1, "", "args"], [4, 2, 1, "", "custom_model"], [4, 2, 1, "", "dispatch"], [4, 2, 1, "", "dispatched"], [4, 3, 1, "", "forward"], [4, 3, 1, "", "generate"], [4, 3, 1, "", "invoke"], [4, 2, 1, "", "kwargs"], [4, 2, 1, "", "local_model"], [4, 2, 1, "", "meta_model"], [4, 3, 1, "", "modulize"], [4, 2, 1, "", "repoid_path_clsname"]], "nnsight.models.DiffuserModel": [[4, 1, 1, "", "Diffuser"], [4, 1, 1, "", "DiffuserModel"]], "nnsight.models.LanguageModel": [[4, 1, 1, "", "LanguageModel"]], "nnsight.models.LanguageModel.LanguageModel": [[4, 2, 1, "", "automodel"], [4, 2, 1, "", "config"], [4, 2, 1, "", "local_model"], [4, 2, 1, "", "meta_model"], [4, 2, 1, "", "tokenizer"]], "nnsight.module": [[5, 1, 1, "", "Module"]], "nnsight.module.Module": [[5, 4, 1, "", "backward_input"], [5, 4, 1, "", "backward_output"], [5, 4, 1, "id0", "input"], [5, 2, 1, "", "input_shape"], [5, 2, 1, "", "input_type"], [5, 2, 1, "", "module_path"], [5, 4, 1, "id1", "output"], [5, 2, 1, "", "output_shape"], [5, 2, 1, "", "output_type"], [5, 2, 1, "", "tracer"], [5, 3, 1, "", "wrap"]], "nnsight.patching": [[6, 1, 1, "", "Patch"], [6, 1, 1, "", "Patcher"]], "nnsight.patching.Patch": [[6, 2, 1, "", "obj"], [6, 2, 1, "", "parent"], [6, 3, 1, "", "patch"], [6, 2, 1, "", "replacement"], [6, 3, 1, "", "restore"]], "nnsight.patching.Patcher": [[6, 3, 1, "", "add"], [6, 2, 1, "", "patches"]], "nnsight.tracing": [[7, 0, 0, "-", "Graph"], [7, 0, 0, "-", "Node"], [7, 0, 0, "-", "Proxy"]], "nnsight.tracing.Graph": [[7, 1, 1, "", "Graph"]], "nnsight.tracing.Graph.Graph": [[7, 3, 1, "", "add"], [7, 2, 1, "", "argument_node_names"], [7, 3, 1, "", "compile"], [7, 2, 1, "", "generation_idx"], [7, 3, 1, "", "increment"], [7, 2, 1, "", "module_proxy"], [7, 2, 1, "", "name_idx"], [7, 2, 1, "", "nodes"], [7, 3, 1, "", "proxy"], [7, 2, 1, "", "proxy_class"], [7, 2, 1, "", "swap"], [7, 3, 1, "", "trace"], [7, 2, 1, "", "validate"], [7, 3, 1, "", "wrap"]], "nnsight.tracing.Node": [[7, 1, 1, "", "Node"]], "nnsight.tracing.Node.Node": [[7, 2, 1, "", "_proxy_device"], [7, 2, 1, "", "args"], [7, 3, 1, "", "compile"], [7, 2, 1, "", "dependencies"], [7, 3, 1, "", "destroy"], [7, 3, 1, "", "execute"], [7, 3, 1, "", "fulfilled"], [7, 2, 1, "", "graph"], [7, 2, 1, "", "kwargs"], [7, 2, 1, "", "listeners"], [7, 2, 1, "", "meta"], [7, 2, 1, "", "name"], [7, 3, 1, "", "prepare_inputs"], [7, 3, 1, "", "prepare_proxy_values"], [7, 4, 1, "", "proxy_device"], [7, 2, 1, "", "proxy_value"], [7, 3, 1, "", "redundant"], [7, 3, 1, "", "set_value"], [7, 2, 1, "", "target"], [7, 2, 1, "", "value"]], "nnsight.tracing.Proxy": [[7, 1, 1, "", "Proxy"], [7, 5, 1, "", "proxy_wrapper"]], "nnsight.tracing.Proxy.Proxy": [[7, 2, 1, "", "node"]], "nnsight.util": [[8, 1, 1, "", "WrapperModule"], [8, 5, 1, "", "apply"], [8, 5, 1, "", "cross_entropy_loss"], [8, 5, 1, "", "fetch_attr"], [8, 5, 1, "", "timed"], [8, 5, 1, "", "wrap"]], "nnsight.util.WrapperModule": [[8, 3, 1, "", "forward"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute", "3": "py:method", "4": "py:property", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "method", "Python method"], "4": ["py", "property", "Python property"], "5": ["py", "function", "Python function"]}, "titleterms": {"about": 0, "nnsight": [0, 2, 3, 4, 5, 6, 7, 8, 10], "an": 0, "api": 0, "transpar": 0, "scienc": 0, "black": 0, "box": 0, "ai": 0, "how": 0, "you": 0, "us": 0, "what": 0, "happen": 0, "behind": 0, "scene": 0, "document": 1, "context": 2, "intervent": [3, 11], "model": [4, 27], "modul": [5, 14], "patch": [6, 20, 24], "trace": 7, "util": 8, "featur": 9, "cross": 11, "prompt": 11, "get": [12, 28], "valu": [12, 18], "work": 13, "With": 13, "gradient": 13, "appli": [14, 16], "multipl": 15, "token": [15, 19], "gener": 15, "oper": 16, "remot": 17, "execut": 17, "set": 18, "base": 19, "index": 19, "attribut": 20, "dictionari": [21, 26], "learn": [21, 26], "function": 22, "vector": 22, "futur": 23, "len": [23, 25, 27], "activ": 24, "logit": [25, 27], "walkthrough": 27, "load": 27, "run": 27, "exampl": 27, "interven": 27, "dure": 27, "forward": 27, "pass": 27, "next": 27, "step": [27, 28], "start": 28, "instal": 28, "first": 28, "tutori": 29}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 60}, "alltitles": {"About nnsight": [[0, "about-nnsight"]], "An API for transparent science on black-box AI": [[0, "an-api-for-transparent-science-on-black-box-ai"]], "How you use nnsight": [[0, "how-you-use-nnsight"]], "What happens behind the scenes?": [[0, "what-happens-behind-the-scenes"]], "Documentation": [[1, "documentation"]], "nnsight.contexts": [[2, "module-nnsight.contexts"]], "nnsight.intervention": [[3, "module-nnsight.intervention"]], "nnsight.models": [[4, "module-nnsight.models"]], "nnsight.module": [[5, "module-nnsight.module"]], "nnsight.patching": [[6, "module-nnsight.patching"]], "nnsight.tracing": [[7, "module-nnsight.tracing"]], "nnsight.util": [[8, "module-nnsight.util"]], "Features": [[9, "features"]], "nnsight": [[10, "nnsight"]], "Cross-Prompt Intervention": [[11, "Cross-Prompt-Intervention"]], "Getting Values": [[12, "Getting-Values"]], "Working With Gradients": [[13, "Working-With-Gradients"]], "Applying Modules": [[14, "Applying-Modules"]], "Multiple Token Generation": [[15, "Multiple-Token-Generation"]], "Applying Operations": [[16, "Applying-Operations"]], "Remote Execution": [[17, "Remote-Execution"]], "Setting Values": [[18, "Setting-Values"]], "Token Based Indexing": [[19, "Token-Based-Indexing"]], "Attribution Patching": [[20, "Attribution-Patching"]], "Dictionary Learning": [[21, "Dictionary-Learning"], [26, "Dictionary-Learning"]], "Function Vectors": [[22, "Function-Vectors"]], "Future Lens": [[23, "Future-Lens"]], "Activation Patching": [[24, "Activation-Patching"]], "Logit Lens": [[25, "Logit-Lens"]], "Walkthrough": [[27, "Walkthrough"]], "Loading and Running Models": [[27, "Loading-and-Running-Models"]], "Example: Logit Lens": [[27, "Example:-Logit-Lens"]], "Intervening during a forward pass": [[27, "Intervening-during-a-forward-pass"]], "Next steps": [[27, "Next-steps"]], "Getting Started": [[28, "getting-started"]], "Installation": [[28, "installation"]], "First Steps": [[28, "first-steps"]], "Tutorials": [[29, "tutorials"]]}, "indexentries": {"invoker (class in nnsight.contexts.invoker)": [[2, "nnsight.contexts.Invoker.Invoker"]], "runner (class in nnsight.contexts.runner)": [[2, "nnsight.contexts.Runner.Runner"]], "tracer (class in nnsight.contexts.tracer)": [[2, "nnsight.contexts.Tracer.Tracer"]], "args (nnsight.contexts.invoker.invoker attribute)": [[2, "nnsight.contexts.Invoker.Invoker.args"]], "args (nnsight.contexts.tracer.tracer attribute)": [[2, "nnsight.contexts.Tracer.Tracer.args"]], "batch_size (nnsight.contexts.tracer.tracer attribute)": [[2, "nnsight.contexts.Tracer.Tracer.batch_size"]], "batch_start (nnsight.contexts.tracer.tracer attribute)": [[2, "nnsight.contexts.Tracer.Tracer.batch_start"]], "blocking (nnsight.contexts.runner.runner attribute)": [[2, "nnsight.contexts.Runner.Runner.blocking"]], "generation (nnsight.contexts.runner.runner attribute)": [[2, "nnsight.contexts.Runner.Runner.generation"]], "generation_idx (nnsight.contexts.tracer.tracer attribute)": [[2, "nnsight.contexts.Tracer.Tracer.generation_idx"]], "graph (nnsight.contexts.tracer.tracer attribute)": [[2, "nnsight.contexts.Tracer.Tracer.graph"]], "input (nnsight.contexts.invoker.invoker attribute)": [[2, "nnsight.contexts.Invoker.Invoker.input"]], "kwargs (nnsight.contexts.invoker.invoker attribute)": [[2, "nnsight.contexts.Invoker.Invoker.kwargs"]], "kwargs (nnsight.contexts.tracer.tracer attribute)": [[2, "nnsight.contexts.Tracer.Tracer.kwargs"]], "model (nnsight.contexts.tracer.tracer attribute)": [[2, "nnsight.contexts.Tracer.Tracer.model"]], "module": [[2, "module-nnsight.contexts"], [2, "module-nnsight.contexts.Invoker"], [2, "module-nnsight.contexts.Runner"], [2, "module-nnsight.contexts.Tracer"], [3, "module-nnsight.intervention"], [4, "module-nnsight.models"], [4, "module-nnsight.models.AbstractModel"], [4, "module-nnsight.models.DiffuserModel"], [4, "module-nnsight.models.LanguageModel"], [5, "module-nnsight.module"], [6, "module-nnsight.patching"], [7, "module-nnsight.tracing"], [7, "module-nnsight.tracing.Graph"], [7, "module-nnsight.tracing.Node"], [7, "module-nnsight.tracing.Proxy"], [8, "module-nnsight.util"]], "next() (nnsight.contexts.invoker.invoker method)": [[2, "nnsight.contexts.Invoker.Invoker.next"]], "nnsight.contexts": [[2, "module-nnsight.contexts"]], "nnsight.contexts.invoker": [[2, "module-nnsight.contexts.Invoker"]], "nnsight.contexts.runner": [[2, "module-nnsight.contexts.Runner"]], "nnsight.contexts.tracer": [[2, "module-nnsight.contexts.Tracer"]], "output (nnsight.contexts.tracer.tracer attribute)": [[2, "nnsight.contexts.Tracer.Tracer.output"]], "remote (nnsight.contexts.runner.runner attribute)": [[2, "nnsight.contexts.Runner.Runner.remote"]], "run_local() (nnsight.contexts.runner.runner method)": [[2, "nnsight.contexts.Runner.Runner.run_local"]], "save_all() (nnsight.contexts.invoker.invoker method)": [[2, "nnsight.contexts.Invoker.Invoker.save_all"]], "scan (nnsight.contexts.invoker.invoker attribute)": [[2, "nnsight.contexts.Invoker.Invoker.scan"]], "tracer (nnsight.contexts.invoker.invoker attribute)": [[2, "nnsight.contexts.Invoker.Invoker.tracer"]], "hookmodel (class in nnsight.intervention)": [[3, "nnsight.intervention.HookModel"]], "interventionproxy (class in nnsight.intervention)": [[3, "nnsight.intervention.InterventionProxy"]], "tokenindexer (class in nnsight.intervention)": [[3, "nnsight.intervention.TokenIndexer"]], "handles (nnsight.intervention.hookmodel attribute)": [[3, "nnsight.intervention.HookModel.handles"]], "input_hook (nnsight.intervention.hookmodel attribute)": [[3, "nnsight.intervention.HookModel.input_hook"]], "intervene() (in module nnsight.intervention)": [[3, "nnsight.intervention.intervene"]], "model (nnsight.intervention.hookmodel attribute)": [[3, "nnsight.intervention.HookModel.model"]], "modules (nnsight.intervention.hookmodel attribute)": [[3, "nnsight.intervention.HookModel.modules"]], "nnsight.intervention": [[3, "module-nnsight.intervention"]], "output_hook (nnsight.intervention.hookmodel attribute)": [[3, "nnsight.intervention.HookModel.output_hook"]], "save() (nnsight.intervention.interventionproxy method)": [[3, "nnsight.intervention.InterventionProxy.save"]], "shape (nnsight.intervention.interventionproxy property)": [[3, "nnsight.intervention.InterventionProxy.shape"]], "t (nnsight.intervention.interventionproxy property)": [[3, "nnsight.intervention.InterventionProxy.t"]], "token (nnsight.intervention.interventionproxy property)": [[3, "nnsight.intervention.InterventionProxy.token"]], "value (nnsight.intervention.interventionproxy property)": [[3, "nnsight.intervention.InterventionProxy.value"]], "abstractmodel (class in nnsight.models.abstractmodel)": [[4, "nnsight.models.AbstractModel.AbstractModel"]], "diffuser (class in nnsight.models.diffusermodel)": [[4, "nnsight.models.DiffuserModel.Diffuser"]], "diffusermodel (class in nnsight.models.diffusermodel)": [[4, "nnsight.models.DiffuserModel.DiffuserModel"]], "languagemodel (class in nnsight.models.languagemodel)": [[4, "nnsight.models.LanguageModel.LanguageModel"]], "alter (nnsight.models.abstractmodel.abstractmodel attribute)": [[4, "nnsight.models.AbstractModel.AbstractModel.alter"]], "args (nnsight.models.abstractmodel.abstractmodel attribute)": [[4, "nnsight.models.AbstractModel.AbstractModel.args"]], "automodel (nnsight.models.languagemodel.languagemodel attribute)": [[4, "nnsight.models.LanguageModel.LanguageModel.automodel"]], "config (nnsight.models.languagemodel.languagemodel attribute)": [[4, "nnsight.models.LanguageModel.LanguageModel.config"]], "custom_model (nnsight.models.abstractmodel.abstractmodel attribute)": [[4, "nnsight.models.AbstractModel.AbstractModel.custom_model"]], "dispatch (nnsight.models.abstractmodel.abstractmodel attribute)": [[4, "nnsight.models.AbstractModel.AbstractModel.dispatch"]], "dispatched (nnsight.models.abstractmodel.abstractmodel attribute)": [[4, "nnsight.models.AbstractModel.AbstractModel.dispatched"]], "forward() (nnsight.models.abstractmodel.abstractmodel method)": [[4, "nnsight.models.AbstractModel.AbstractModel.forward"]], "generate() (nnsight.models.abstractmodel.abstractmodel method)": [[4, "nnsight.models.AbstractModel.AbstractModel.generate"]], "invoke() (nnsight.models.abstractmodel.abstractmodel method)": [[4, "nnsight.models.AbstractModel.AbstractModel.invoke"]], "kwargs (nnsight.models.abstractmodel.abstractmodel attribute)": [[4, "nnsight.models.AbstractModel.AbstractModel.kwargs"]], "local_model (nnsight.models.abstractmodel.abstractmodel attribute)": [[4, "nnsight.models.AbstractModel.AbstractModel.local_model"]], "local_model (nnsight.models.languagemodel.languagemodel attribute)": [[4, "nnsight.models.LanguageModel.LanguageModel.local_model"]], "meta_model (nnsight.models.abstractmodel.abstractmodel attribute)": [[4, "nnsight.models.AbstractModel.AbstractModel.meta_model"]], "meta_model (nnsight.models.languagemodel.languagemodel attribute)": [[4, "nnsight.models.LanguageModel.LanguageModel.meta_model"]], "modulize() (nnsight.models.abstractmodel.abstractmodel method)": [[4, "nnsight.models.AbstractModel.AbstractModel.modulize"]], "nnsight.models": [[4, "module-nnsight.models"]], "nnsight.models.abstractmodel": [[4, "module-nnsight.models.AbstractModel"]], "nnsight.models.diffusermodel": [[4, "module-nnsight.models.DiffuserModel"]], "nnsight.models.languagemodel": [[4, "module-nnsight.models.LanguageModel"]], "repoid_path_clsname (nnsight.models.abstractmodel.abstractmodel attribute)": [[4, "nnsight.models.AbstractModel.AbstractModel.repoid_path_clsname"]], "tokenizer (nnsight.models.languagemodel.languagemodel attribute)": [[4, "nnsight.models.LanguageModel.LanguageModel.tokenizer"]], "module (class in nnsight.module)": [[5, "nnsight.module.Module"]], "backward_input (nnsight.module.module property)": [[5, "nnsight.module.Module.backward_input"]], "backward_output (nnsight.module.module property)": [[5, "nnsight.module.Module.backward_output"]], "input (nnsight.module.module attribute)": [[5, "nnsight.module.Module.input"]], "input (nnsight.module.module property)": [[5, "id0"]], "input_shape (nnsight.module.module attribute)": [[5, "nnsight.module.Module.input_shape"]], "input_type (nnsight.module.module attribute)": [[5, "nnsight.module.Module.input_type"]], "module_path (nnsight.module.module attribute)": [[5, "nnsight.module.Module.module_path"]], "nnsight.module": [[5, "module-nnsight.module"]], "output (nnsight.module.module attribute)": [[5, "nnsight.module.Module.output"]], "output (nnsight.module.module property)": [[5, "id1"]], "output_shape (nnsight.module.module attribute)": [[5, "nnsight.module.Module.output_shape"]], "output_type (nnsight.module.module attribute)": [[5, "nnsight.module.Module.output_type"]], "tracer (nnsight.module.module attribute)": [[5, "nnsight.module.Module.tracer"]], "wrap() (nnsight.module.module static method)": [[5, "nnsight.module.Module.wrap"]], "patch (class in nnsight.patching)": [[6, "nnsight.patching.Patch"]], "patcher (class in nnsight.patching)": [[6, "nnsight.patching.Patcher"]], "add() (nnsight.patching.patcher method)": [[6, "nnsight.patching.Patcher.add"]], "nnsight.patching": [[6, "module-nnsight.patching"]], "obj (nnsight.patching.patch attribute)": [[6, "nnsight.patching.Patch.obj"]], "parent (nnsight.patching.patch attribute)": [[6, "nnsight.patching.Patch.parent"]], "patch() (nnsight.patching.patch method)": [[6, "nnsight.patching.Patch.patch"]], "patches (nnsight.patching.patcher attribute)": [[6, "nnsight.patching.Patcher.patches"]], "replacement (nnsight.patching.patch attribute)": [[6, "nnsight.patching.Patch.replacement"]], "restore() (nnsight.patching.patch method)": [[6, "nnsight.patching.Patch.restore"]], "graph (class in nnsight.tracing.graph)": [[7, "nnsight.tracing.Graph.Graph"]], "node (class in nnsight.tracing.node)": [[7, "nnsight.tracing.Node.Node"]], "proxy (class in nnsight.tracing.proxy)": [[7, "nnsight.tracing.Proxy.Proxy"]], "_proxy_device (nnsight.tracing.node.node attribute)": [[7, "nnsight.tracing.Node.Node._proxy_device"]], "add() (nnsight.tracing.graph.graph method)": [[7, "nnsight.tracing.Graph.Graph.add"]], "args (nnsight.tracing.node.node attribute)": [[7, "nnsight.tracing.Node.Node.args"]], "argument_node_names (nnsight.tracing.graph.graph attribute)": [[7, "nnsight.tracing.Graph.Graph.argument_node_names"]], "compile() (nnsight.tracing.graph.graph method)": [[7, "nnsight.tracing.Graph.Graph.compile"]], "compile() (nnsight.tracing.node.node method)": [[7, "nnsight.tracing.Node.Node.compile"]], "dependencies (nnsight.tracing.node.node attribute)": [[7, "nnsight.tracing.Node.Node.dependencies"]], "destroy() (nnsight.tracing.node.node method)": [[7, "nnsight.tracing.Node.Node.destroy"]], "execute() (nnsight.tracing.node.node method)": [[7, "nnsight.tracing.Node.Node.execute"]], "fulfilled() (nnsight.tracing.node.node method)": [[7, "nnsight.tracing.Node.Node.fulfilled"]], "generation_idx (nnsight.tracing.graph.graph attribute)": [[7, "nnsight.tracing.Graph.Graph.generation_idx"]], "graph (nnsight.tracing.node.node attribute)": [[7, "nnsight.tracing.Node.Node.graph"]], "increment() (nnsight.tracing.graph.graph method)": [[7, "nnsight.tracing.Graph.Graph.increment"]], "kwargs (nnsight.tracing.node.node attribute)": [[7, "nnsight.tracing.Node.Node.kwargs"]], "listeners (nnsight.tracing.node.node attribute)": [[7, "nnsight.tracing.Node.Node.listeners"]], "meta (nnsight.tracing.node.node attribute)": [[7, "nnsight.tracing.Node.Node.meta"]], "module_proxy (nnsight.tracing.graph.graph attribute)": [[7, "nnsight.tracing.Graph.Graph.module_proxy"]], "name (nnsight.tracing.node.node attribute)": [[7, "nnsight.tracing.Node.Node.name"]], "name_idx (nnsight.tracing.graph.graph attribute)": [[7, "nnsight.tracing.Graph.Graph.name_idx"]], "nnsight.tracing": [[7, "module-nnsight.tracing"]], "nnsight.tracing.graph": [[7, "module-nnsight.tracing.Graph"]], "nnsight.tracing.node": [[7, "module-nnsight.tracing.Node"]], "nnsight.tracing.proxy": [[7, "module-nnsight.tracing.Proxy"]], "node (nnsight.tracing.proxy.proxy attribute)": [[7, "nnsight.tracing.Proxy.Proxy.node"]], "nodes (nnsight.tracing.graph.graph attribute)": [[7, "nnsight.tracing.Graph.Graph.nodes"]], "prepare_inputs() (nnsight.tracing.node.node method)": [[7, "nnsight.tracing.Node.Node.prepare_inputs"]], "prepare_proxy_values() (nnsight.tracing.node.node static method)": [[7, "nnsight.tracing.Node.Node.prepare_proxy_values"]], "proxy() (nnsight.tracing.graph.graph method)": [[7, "nnsight.tracing.Graph.Graph.proxy"]], "proxy_class (nnsight.tracing.graph.graph attribute)": [[7, "nnsight.tracing.Graph.Graph.proxy_class"]], "proxy_device (nnsight.tracing.node.node property)": [[7, "nnsight.tracing.Node.Node.proxy_device"]], "proxy_value (nnsight.tracing.node.node attribute)": [[7, "nnsight.tracing.Node.Node.proxy_value"]], "proxy_wrapper() (in module nnsight.tracing.proxy)": [[7, "nnsight.tracing.Proxy.proxy_wrapper"]], "redundant() (nnsight.tracing.node.node method)": [[7, "nnsight.tracing.Node.Node.redundant"]], "set_value() (nnsight.tracing.node.node method)": [[7, "nnsight.tracing.Node.Node.set_value"]], "swap (nnsight.tracing.graph.graph attribute)": [[7, "nnsight.tracing.Graph.Graph.swap"]], "target (nnsight.tracing.node.node attribute)": [[7, "nnsight.tracing.Node.Node.target"]], "trace() (nnsight.tracing.graph.graph static method)": [[7, "nnsight.tracing.Graph.Graph.trace"]], "validate (nnsight.tracing.graph.graph attribute)": [[7, "nnsight.tracing.Graph.Graph.validate"]], "value (nnsight.tracing.node.node attribute)": [[7, "nnsight.tracing.Node.Node.value"]], "wrap() (nnsight.tracing.graph.graph method)": [[7, "nnsight.tracing.Graph.Graph.wrap"]], "wrappermodule (class in nnsight.util)": [[8, "nnsight.util.WrapperModule"]], "apply() (in module nnsight.util)": [[8, "nnsight.util.apply"]], "cross_entropy_loss() (in module nnsight.util)": [[8, "nnsight.util.cross_entropy_loss"]], "fetch_attr() (in module nnsight.util)": [[8, "nnsight.util.fetch_attr"]], "forward() (nnsight.util.wrappermodule method)": [[8, "nnsight.util.WrapperModule.forward"]], "nnsight.util": [[8, "module-nnsight.util"]], "timed() (in module nnsight.util)": [[8, "nnsight.util.timed"]], "wrap() (in module nnsight.util)": [[8, "nnsight.util.wrap"]]}})