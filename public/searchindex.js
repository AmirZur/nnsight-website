Search.setIndex({"docnames": ["documentation", "documentation/contexts", "documentation/intervention", "documentation/models", "documentation/module", "documentation/patching", "documentation/tracing", "documentation/util", "index", "start", "tutorials", "tutorials/main_demo"], "filenames": ["documentation.rst", "documentation/contexts.rst", "documentation/intervention.rst", "documentation/models.rst", "documentation/module.rst", "documentation/patching.rst", "documentation/tracing.rst", "documentation/util.rst", "index.rst", "start.rst", "tutorials.rst", "tutorials/main_demo.ipynb"], "titles": ["Documentation", "nnsight.contexts", "nnsight.intervention", "nnsight.models", "nnsight.module", "nnsight.patching", "nnsight.tracing", "nnsight.util", "nnsight documentation", "Getting Started", "Tutorials", "Main Demo"], "terms": {"nnsight": [0, 9, 11], "model": [0, 1, 2, 4, 6, 8, 9, 10], "modul": [0, 1, 2, 3, 5, 6, 7, 8, 11], "context": [0, 2, 3, 4, 5, 11], "util": 0, "intervent": [0, 1, 3, 4], "trace": [0, 2, 3], "patch": 0, "class": [1, 2, 3, 4, 5, 6, 7], "gener": [1, 2, 3, 4, 6], "arg": [1, 2, 3, 6, 7], "block": 1, "bool": [1, 3, 7], "true": [1, 3, 7, 11], "server": 1, "fals": [1, 3, 7, 11], "kwarg": [1, 3, 6, 7], "_summary_": [1, 3, 6], "object": [1, 2, 3, 4, 5, 6, 7, 8], "thi": [1, 2, 3, 4, 6, 7, 9, 11], "i": [1, 2, 3, 4, 6, 7, 8, 9, 11], "type": [1, 2, 3, 4, 5, 6, 7], "If": [1, 2, 3, 6, 7, 9, 11], "when": [1, 2, 3, 6], "us": [1, 2, 3, 6, 7, 8, 11], "device_map": [1, 3, 11], "wait": 1, "form": [1, 2, 3, 6], "respons": [1, 6], "otherwis": [1, 4, 6], "have": [1, 2, 6, 8, 9], "manual": [1, 4], "request": [1, 4], "argument": [1, 2, 3, 6, 7], "call": [1, 2, 3, 4, 5, 6, 7], "list": [1, 2, 3, 4, 5, 6, 11], "ani": [1, 2, 3, 5, 6, 7, 11], "keyword": [1, 3, 6], "dict": [1, 3, 6, 11], "str": [1, 2, 3, 4, 6, 7], "generation_idx": [1, 6], "keep": 1, "track": [1, 3, 6, 11], "what": [1, 6], "iter": [1, 2, 3], "do": [1, 2], "specifi": [1, 6, 11], "chang": [1, 11], "invok": [1, 2, 3, 4, 11], "next": 1, "int": [1, 3, 6], "batch_siz": [1, 2], "current": [1, 2, 6], "size": [1, 2, 4, 7, 11], "invoc": [1, 3], "batch": [1, 2, 3, 7], "To": [1, 9, 11], "node": [1, 2, 4, 6], "creation": [1, 6], "prompt": [1, 3, 11], "graph": [1, 2, 3, 4, 6], "all": [1, 2, 3, 4, 6, 7, 8, 9], "user": [1, 2, 3, 4], "oper": [1, 3, 4, 6], "output": [1, 2, 3, 4, 6, 11], "desc": [1, 6], "runner": [1, 3], "abstractmodel": [1, 3, 4], "infer": [1, 3], "tracer": [1, 4], "contain": [2, 3, 8], "logic": 2, "interleav": [2, 3, 6], "comput": [2, 3, 6, 7, 11], "an": [2, 4, 5, 6, 7, 11], "The": [2, 3, 4, 5, 6, 8, 11], "interventionproxi": [2, 4], "extend": 2, "function": [2, 3, 4, 5, 6, 7, 8], "base": [2, 6], "fx": 2, "proxi": [2, 4, 6, 11], "make": [2, 11], "easier": 2, "interact": [2, 3, 6], "interven": [2, 10], "entri": [2, 6], "hook": [2, 3, 4, 6, 7], "order": [2, 3, 4, 6], "hookmodel": 2, "provid": [2, 8], "manag": [2, 3, 5], "ad": [2, 3, 6], "input": [2, 3, 4, 7, 11], "remov": [2, 6], "them": [2, 3, 4, 7], "upon": 2, "exit": [2, 11], "input_hook": 2, "option": [2, 5, 6, 7], "callabl": [2, 6, 7], "none": [2, 3, 5, 6], "output_hook": 2, "appli": [2, 3, 7, 9, 11], "regist": [2, 7], "__enter__": [2, 5], "__exit__": [2, 5], "root": [2, 3, 4, 6, 7], "access": [2, 3, 4], "torch": [2, 3, 4, 5, 6, 7, 11], "nn": [2, 3, 4, 6], "along": 2, "module_path": [2, 4], "tupl": [2, 11], "design": 2, "should": [2, 6, 7], "signatur": 2, "handl": [2, 5], "return": [2, 3, 4, 6, 7, 11], "from": [2, 3, 5, 6, 7, 11], "removablehandl": 2, "sub": [2, 3], "add": [2, 4, 5, 6], "addit": 2, "exampl": [2, 3, 4, 8, 9, 10], "save": [2, 3, 4, 11], "so": [2, 6, 11], "both": [2, 3, 6], "clone": 2, "point": [2, 6], "execut": [2, 3, 4, 6, 7, 11], "delet": 2, "complet": [2, 6, 11], "": [2, 3, 4, 6, 7, 11], "listen": [2, 6], "enabl": [2, 3], "eiffel": [2, 3, 4], "tower": [2, 3, 4], "citi": [2, 3, 4, 11], "hidden_st": [2, 4], "lm_head": [2, 3, 4], "logit": [2, 3, 4, 7, 10], "print": [2, 3, 4, 7, 11], "valu": [2, 3, 4, 6, 11], "work": [2, 11], "would": [2, 11], "had": 2, "you": [2, 3, 6, 9], "thrown": 2, "error": 2, "index": [2, 6, 11], "token": [2, 3, 7, 11], "hidden": [2, 11], "state": [2, 3, 11], "can": [2, 3, 4, 6, 11], "easili": 2, "done": 2, "idx": 2, "t": [2, 11], "0": [2, 3, 4, 6, 11], "onli": [2, 3, 4, 6, 7, 11], "first": [2, 3, 4, 6, 7, 11], "shape": [2, 4, 6, 7, 11], "collect": [2, 3, 7], "tensor": [2, 3, 4, 6, 7], "through": [2, 4, 6, 7, 11], "actual": [2, 3, 6, 11], "popul": [2, 4, 6], "updat": [2, 6, 7], "dure": [2, 4, 6, 10], "throw": 2, "method": [2, 3, 6, 7], "indic": [2, 11], "result": [2, 4, 6, 11], "properti": [2, 4, 6], "union": [2, 3, 6], "retriev": [2, 7], "tokenindex": 2, "alia": 2, "directli": [2, 3], "second": 2, "dimens": 2, "posit": [2, 3, 6, 11], "neg": 2, "ar": [2, 3, 4, 6, 7, 11], "pad": 2, "left": 2, "transform": [2, 3, 4, 7], "h": [2, 3, 4, 7], "mlp": [2, 3, 4, 11], "equival": 2, "3": [2, 3, 11], "For": [2, 9, 11], "store": [2, 6, 11], "helper": [2, 7], "paramet": [2, 3, 4, 5, 6, 7, 11], "aid": 2, "activ": [2, 3, 11], "kei": [2, 6, 8], "involv": [2, 6], "path": [2, 3, 4, 7], "check": [2, 3, 6, 8, 9], "argument_node_nam": [2, 6], "attribut": [2, 3, 4, 5, 6, 7], "exist": [2, 4], "name": [2, 3, 6], "batch_start": 2, "narrow": 2, "select": 2, "relev": [2, 11], "set": [2, 4, 6], "view": [2, 6], "oppos": 2, "copi": 2, "allow": [2, 3, 6], "subsequ": 2, "downstream": [2, 3, 4], "edit": 2, "origin": [2, 5, 11], "prevent": 2, "effect": 2, "bath": 2, "outsid": [2, 6], "preview": 2, "either": [2, 3, 6], "rel": [2, 4], "denot": [2, 4], "potenti": 2, "modifi": 2, "main": [3, 10], "packag": [3, 7, 8, 9], "which": [3, 4, 6, 7, 11], "load": [3, 10], "wrap": [3, 4, 6, 7], "here": [3, 11], "we": [3, 4, 6, 11], "gpt2": [3, 4], "huggingfac": [3, 11], "its": [3, 6], "repo": [3, 11], "id": [3, 7, 11], "languagemodel": [3, 11], "import": [3, 5, 11], "cuda": [3, 11], "In": [3, 11], "case": [3, 11], "mean": [3, 11], "underli": 3, "automodelforcausallm": 3, "unus": 3, "pass": [3, 4, 6, 7, 10], "ultim": 3, "leverag": 3, "acceler": 3, "gpu": [3, 11], "local_model": 3, "further": 3, "encapsul": 3, "out": [3, 5, 6, 8, 9, 11], "structur": [3, 11], "well": [3, 6], "meta_model": 3, "demonstr": 3, "like": [3, 9, 11], "gpt2lmheadmodel": 3, "gpt2model": 3, "wte": 3, "embed": [3, 11], "50257": 3, "768": 3, "wpe": 3, "1024": 3, "drop": 3, "dropout": [3, 11], "p": [3, 11], "1": [3, 7, 11], "inplac": [3, 11], "modulelist": [3, 4, 11], "11": [3, 11], "12": [3, 11], "x": [3, 4, 7, 11], "gpt2block": 3, "ln_1": 3, "layernorm": [3, 11], "ep": [3, 11], "1e": [3, 11], "05": [3, 11], "elementwise_affin": [3, 11], "attn": 3, "gpt2attent": 3, "c_attn": 3, "conv1d": 3, "c_proj": 3, "attn_dropout": 3, "resid_dropout": 3, "ln_2": 3, "gpt2mlp": 3, "c_fc": 3, "act": [3, 4, 6, 11], "newgeluactiv": 3, "ln_f": 3, "linear": [3, 11], "in_featur": [3, 11], "out_featur": [3, 11], "bia": [3, 11], "two": 3, "run": [3, 4, 6, 7, 10], "forward": [3, 4, 6, 7, 10], "enter": 3, "perform": [3, 4, 6, 7], "meant": [3, 4], "multi": 3, "determin": 3, "behavior": 3, "three": 3, "within": [3, 4, 7], "where": [3, 6], "accept": 3, "other": [3, 6], "It": [3, 6], "prepar": [3, 6], "languag": [3, 11], "also": [3, 4, 5, 11], "after": [3, 4, 7, 11], "over": [3, 11], "max_new_token": 3, "logits1": 3, "empir": 3, "build": 3, "logits2": 3, "direct": [3, 6], "train": 3, "mode": 3, "gradient": 3, "see": [3, 8, 9, 11], "repoid_path_model": 3, "alter": 3, "abstract": 3, "implement": [3, 6], "pytorch": 3, "wish": [3, 4], "gain": 3, "repoid_path_clsnam": 3, "hug": 3, "face": 3, "checkpoint": 3, "custom": 3, "initi": [3, 4, 5], "dispatch": 3, "ha": [3, 6, 7], "bee": 3, "yet": [3, 8, 9, 11], "custom_model": 3, "wa": [3, 11], "version": 3, "meta": [3, 4, 6], "devic": [3, 6], "_typ_": 3, "local": 3, "ran": [3, 6], "singl": [3, 6], "specif": [3, 4, 8, 11], "_run_loc": 3, "A": 3, "simpl": [3, 7], "some": [3, 5, 6, 7, 9, 11], "process": [3, 6], "_gener": 3, "tandem": 3, "limit": 3, "amount": 3, "predict": 3, "one": [3, 4, 6, 7, 11], "doc": 3, "more": [3, 6, 8, 9, 11], "inform": [3, 8, 11], "node_nam": 3, "module_nam": 3, "_description_": [3, 6], "wrapper": [3, 7], "around": 3, "config": 3, "file": 3, "repositori": 3, "pretrainedconfig": 3, "lm": 3, "pretrainedtoken": 3, "pretrainedmodel": 3, "diffusermodel": 3, "diffus": 3, "repoid_or_path": 3, "cliptoken": 3, "to_imag": 3, "latent": 3, "imag": 3, "convert": [3, 6], "entrypoint": 4, "interwoven": 4, "manipul": [4, 8, 9], "requir": 4, "correct": [4, 11], "below": 4, "show": [4, 11], "zero": [4, 11], "tree": [4, 11], "respect": 4, "string": [4, 6, 7], "repres": [4, 5, 6], "separ": [4, 7], "e": [4, 7], "reset": [4, 6], "output_shap": 4, "most": 4, "recent": 4, "nest": 4, "output_typ": 4, "dtype": 4, "input_shap": 4, "input_typ": 4, "must": 4, "get": [4, 6, 7, 8, 11], "therefor": [4, 6], "creat": [4, 6, 11], "time": [4, 7, 11], "refer": [4, 6], "alreadi": [4, 11], "static": [4, 6], "our": [4, 11], "data": [4, 6, 7, 11], "doe": [4, 11], "default_patch": 5, "default": [5, 6, 7], "patcher": 5, "obj": 5, "replac": [5, 6], "carri": [5, 6], "importlib": 5, "import_modul": 5, "self": 5, "__module__": 5, "And": 5, "setattr": 5, "__name__": 5, "restor": [5, 11], "each": [6, 11], "flow": 6, "said": 6, "thei": 6, "AND": 6, "proxy_valu": 6, "datatyp": 6, "pre": 6, "set_valu": 6, "bi": 6, "depend": 6, "same": [6, 7], "theirs": 6, "longer": [6, 11], "destroi": 6, "free": 6, "memori": 6, "re": 6, "remain": 6, "new": 6, "own": 6, "traceabl": 6, "mani": 6, "python": 6, "built": 6, "magic": 6, "__torch_function__": 6, "find": 6, "shame": 6, "proxy_class": 6, "reserv": 6, "target": [6, 7], "There": 6, "__init__": [6, 7], "compil": 6, "whatev": 6, "being": [6, 11], "multipl": 6, "Their": 6, "need": [6, 7], "map": 6, "These": [6, 11], "kick": 6, "rtn": 6, "null": 6, "never": 6, "name_idx": 6, "target_nam": 6, "number": 6, "previou": 6, "uniqu": 6, "module_proxi": 6, "given": [6, 7, 11], "pull": 6, "rais": 6, "valueerror": 6, "than": 6, "final": [6, 11], "module_0": 6, "consid": [6, 11], "increment": 6, "just": 6, "_type_": 6, "post": 6, "_proxy_devic": 6, "log": 6, "destruct": 6, "proxy_devic": 6, "lazi": 6, "value1": 6, "value2": 6, "proxy_wrapp": 6, "fn": [6, 7], "problemat": 6, "sometim": 6, "throughout": 7, "wrappermodul": 7, "element": 7, "defin": 7, "everi": 7, "overridden": 7, "subclass": 7, "although": 7, "recip": 7, "instanc": 7, "afterward": 7, "instead": 7, "sinc": [7, 11], "former": 7, "take": 7, "care": 7, "while": 7, "latter": 7, "silent": 7, "ignor": 7, "cl": 7, "member": 7, "give": [7, 11], "kind": 7, "been": [7, 8, 9], "cross_entropy_loss": 7, "target_id": 7, "shift": 7, "avg_batch": 7, "avg_token": 7, "cross": 7, "entropi": 7, "loss": 7, "n": 7, "featur": [7, 8, 9], "last": 7, "averag": 7, "across": 7, "fetch_attr": 7, "hierarchi": 7, "level": 7, "fetch": 7, "func": 7, "lggr": 7, "decor": 7, "__class__": 7, "\u025bn": [8, 9], "sa\u026at": [8, 9], "interpret": [8, 9], "intern": [8, 9, 11], "larg": 8, "link": 8, "start": [8, 11], "instal": 8, "tutori": [8, 9], "colab": [8, 9], "page": 8, "instruct": 8, "section": [8, 9], "depth": 8, "concept": 8, "background": 8, "explan": 8, "detail": [8, 11], "descript": 8, "includ": 8, "sourc": 8, "Not": [8, 9], "tool": 8, "github": [8, 9], "usag": 8, "deep": 9, "learn": 9, "pip": 9, "how": [9, 11], "d": 9, "hand": [9, 11], "experi": 9, "cover": 9, "basic": 9, "document": 9, "demo": 10, "len": 10, "pretrain": 11, "ll": 11, "eleutherai": 11, "1b": 11, "pythia": 11, "onto": 11, "2": 11, "abov": 11, "command": 11, "download": 11, "configur": 11, "weight": 11, "your": 11, "machin": 11, "even": 11, "though": 11, "still": 11, "inspect": 11, "gptneoxforcausallm": 11, "gpt_neox": 11, "gptneoxmodel": 11, "embed_in": 11, "50304": 11, "2048": 11, "emb_dropout": 11, "layer": 11, "15": 11, "16": 11, "gptneoxlay": 11, "input_layernorm": 11, "post_attention_layernorm": 11, "post_attention_dropout": 11, "post_mlp_dropout": 11, "attent": 11, "gptneoxattent": 11, "rotary_emb": 11, "gptneoxrotaryembed": 11, "query_key_valu": 11, "6144": 11, "dens": 11, "attention_dropout": 11, "gptneoxmlp": 11, "dense_h_to_4h": 11, "8192": 11, "dense_4h_to_h": 11, "geluactiv": 11, "final_layer_norm": 11, "embed_out": 11, "let": 11, "extract": 11, "residu": 11, "stream": 11, "4": 11, "john": 11, "mari": 11, "went": 11, "milk": 11, "last_hidden_st": 11, "now": 11, "aren": 11, "13": 11, "break": 11, "down": 11, "tell": 11, "modif": 11, "until": 11, "cach": 11, "want": 11, "insid": 11, "desir": 11, "5": 11, "As": 11, "probabl": 11, "move": 11, "One": 11, "techniqu": 11, "treat": 11, "decod": 11, "intermedi": 11, "crude": 11, "approxim": 11, "6": 11, "def": 11, "consist": 11, "norm": 11, "unembed": 11, "all_prob": 11, "prob": 11, "softmax": 11, "dim": 11, "append": 11, "distribut": 11, "evolv": 11, "7": 11, "plotli": 11, "express": 11, "px": 11, "mary_token": 11, "input_id": 11, "line": 11, "layer_prob": 11, "item": 11, "titl": 11, "accord": 11, "label": 11, "suggest": 11, "begin": 11, "realiz": 11, "becom": 11, "confid": 11, "answer": 11, "few": 11, "pari": 11, "countri": 11, "best": 11, "guess": 11, "franc": 11, "8": 11, "tok": 11, "zip": 11, "topk": 11, "10": 11, "f": 11, "3f": 11, "425": 11, "096": 11, "022": 11, "belgium": 11, "008": 11, "prov": 11, "007": 11, "luxem": 11, "saint": 11, "la": 11, "compon": 11, "correctli": 11, "wai": 11, "corrupt": 11, "represent": 11, "confus": 11, "certain": 11, "clean": 11, "caus": 11, "again": 11, "9": 11, "subject_idx": 11, "fourth": 11, "answer_token": 11, "002277057385072112": 11, "all_hidden_st": 11, "record": 11, "n_layer": 11, "n_token": 11, "encod": 11, "intervened_prob": 11, "_": 11, "rang": 11, "visual": 11, "token_id": 11, "squeez": 11, "token_label": 11, "enumer": 11, "fig": 11, "imshow": 11, "y": 11, "color_continuous_midpoint": 11, "color_continuous_scal": 11, "rdbu": 11, "causal": 11, "about": 11, "locat": 11, "befor": 11, "later": 11, "meng": 11, "et": 11, "al": 11, "2022": 11}, "objects": {"nnsight": [[4, 0, 0, "-", "Module"], [1, 0, 0, "-", "contexts"], [2, 0, 0, "-", "intervention"], [3, 0, 0, "-", "models"], [5, 0, 0, "-", "patching"], [6, 0, 0, "-", "tracing"], [7, 0, 0, "-", "util"]], "nnsight.Module": [[4, 1, 1, "", "Module"]], "nnsight.Module.Module": [[4, 2, 1, "", "input"], [4, 3, 1, "", "input_shape"], [4, 3, 1, "", "input_type"], [4, 3, 1, "", "module_path"], [4, 2, 1, "id1", "output"], [4, 3, 1, "", "output_shape"], [4, 3, 1, "", "output_type"], [4, 3, 1, "", "tracer"], [4, 4, 1, "", "wrap"]], "nnsight.contexts": [[1, 0, 0, "-", "Generator"], [1, 0, 0, "-", "Invoker"], [1, 0, 0, "-", "Runner"], [1, 0, 0, "-", "Tracer"]], "nnsight.contexts.Generator": [[1, 1, 1, "", "Generator"]], "nnsight.contexts.Generator.Generator": [[1, 3, 1, "", "args"], [1, 3, 1, "", "batch_size"], [1, 3, 1, "", "blocking"], [1, 3, 1, "", "generation_idx"], [1, 3, 1, "", "graph"], [1, 3, 1, "", "kwargs"], [1, 3, 1, "", "model"], [1, 3, 1, "", "output"], [1, 3, 1, "", "prompts"]], "nnsight.contexts.Runner": [[1, 1, 1, "", "Runner"]], "nnsight.contexts.Tracer": [[1, 1, 1, "", "Tracer"]], "nnsight.intervention": [[2, 1, 1, "", "HookModel"], [2, 1, 1, "", "InterventionProxy"], [2, 1, 1, "", "TokenIndexer"], [2, 5, 1, "", "intervene"]], "nnsight.intervention.HookModel": [[2, 3, 1, "", "handles"], [2, 3, 1, "", "input_hook"], [2, 3, 1, "", "model"], [2, 3, 1, "", "modules"], [2, 3, 1, "", "output_hook"]], "nnsight.intervention.InterventionProxy": [[2, 4, 1, "", "save"], [2, 2, 1, "", "shape"], [2, 2, 1, "", "t"], [2, 2, 1, "", "token"], [2, 2, 1, "", "value"]], "nnsight.models": [[3, 0, 0, "-", "AbstractModel"], [3, 0, 0, "-", "DiffuserModel"], [3, 0, 0, "-", "LanguageModel"]], "nnsight.models.AbstractModel": [[3, 1, 1, "", "AbstractModel"]], "nnsight.models.AbstractModel.AbstractModel": [[3, 3, 1, "", "alter"], [3, 3, 1, "", "args"], [3, 3, 1, "", "custom_model"], [3, 3, 1, "", "dispatched"], [3, 4, 1, "", "forward"], [3, 4, 1, "", "generate"], [3, 3, 1, "", "kwargs"], [3, 3, 1, "", "local_model"], [3, 3, 1, "", "meta_model"], [3, 4, 1, "", "modulize"], [3, 3, 1, "", "repoid_path_clsname"], [3, 3, 1, "", "tokenizer"]], "nnsight.models.DiffuserModel": [[3, 1, 1, "", "Diffuser"], [3, 1, 1, "", "DiffuserModel"]], "nnsight.models.DiffuserModel.DiffuserModel": [[3, 4, 1, "", "to_image"]], "nnsight.models.LanguageModel": [[3, 1, 1, "", "LanguageModel"]], "nnsight.models.LanguageModel.LanguageModel": [[3, 3, 1, "", "config"], [3, 3, 1, "", "local_model"], [3, 3, 1, "", "meta_model"], [3, 3, 1, "", "tokenizer"]], "nnsight.patching": [[5, 3, 1, "", "DEFAULT_PATCHER"], [5, 1, 1, "", "Patch"], [5, 1, 1, "", "Patcher"]], "nnsight.patching.Patch": [[5, 3, 1, "", "obj"], [5, 4, 1, "", "patch"], [5, 3, 1, "", "replacement"], [5, 4, 1, "", "restore"]], "nnsight.patching.Patcher": [[5, 4, 1, "", "add"], [5, 3, 1, "", "patches"]], "nnsight.tracing": [[6, 0, 0, "-", "Graph"], [6, 0, 0, "-", "Node"], [6, 0, 0, "-", "Proxy"]], "nnsight.tracing.Graph": [[6, 1, 1, "", "Graph"]], "nnsight.tracing.Graph.Graph": [[6, 4, 1, "", "add"], [6, 3, 1, "", "argument_node_names"], [6, 4, 1, "", "compile"], [6, 3, 1, "", "generation_idx"], [6, 4, 1, "", "increment"], [6, 3, 1, "", "module_proxy"], [6, 3, 1, "", "name_idx"], [6, 3, 1, "", "nodes"], [6, 4, 1, "", "proxy"], [6, 3, 1, "", "proxy_class"], [6, 4, 1, "", "rtn"], [6, 4, 1, "", "trace"], [6, 4, 1, "", "wrap"]], "nnsight.tracing.Node": [[6, 1, 1, "", "Node"]], "nnsight.tracing.Node.Node": [[6, 3, 1, "", "_proxy_device"], [6, 3, 1, "", "args"], [6, 3, 1, "", "dependencies"], [6, 4, 1, "", "destroy"], [6, 4, 1, "", "execute"], [6, 3, 1, "", "graph"], [6, 3, 1, "", "kwargs"], [6, 3, 1, "", "listeners"], [6, 3, 1, "", "meta"], [6, 3, 1, "", "name"], [6, 2, 1, "", "proxy_device"], [6, 3, 1, "", "proxy_value"], [6, 3, 1, "", "target"], [6, 4, 1, "", "update"], [6, 3, 1, "", "value"]], "nnsight.tracing.Proxy": [[6, 1, 1, "", "Proxy"], [6, 5, 1, "", "proxy_wrapper"]], "nnsight.tracing.Proxy.Proxy": [[6, 3, 1, "", "node"]], "nnsight.util": [[7, 1, 1, "", "WrapperModule"], [7, 5, 1, "", "apply"], [7, 5, 1, "", "cross_entropy_loss"], [7, 5, 1, "", "fetch_attr"], [7, 5, 1, "", "timed"], [7, 5, 1, "", "wrap"]], "nnsight.util.WrapperModule": [[7, 4, 1, "", "forward"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:property", "3": "py:attribute", "4": "py:method", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "property", "Python property"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "method", "Python method"], "5": ["py", "function", "Python function"]}, "titleterms": {"document": [0, 8], "nnsight": [1, 2, 3, 4, 5, 6, 7, 8], "context": 1, "intervent": 2, "model": [3, 11], "modul": 4, "patch": 5, "trace": 6, "util": 7, "get": 9, "start": 9, "instal": 9, "first": 9, "step": 9, "tutori": 10, "main": 11, "demo": 11, "load": 11, "run": 11, "exampl": 11, "logit": 11, "len": 11, "interven": 11, "dure": 11, "forward": 11, "pass": 11}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Documentation": [[0, "documentation"]], "nnsight.contexts": [[1, "nnsight-contexts"]], "nnsight.intervention": [[2, "module-nnsight.intervention"]], "nnsight.models": [[3, "module-nnsight.models"]], "nnsight.module": [[4, "module-nnsight.Module"]], "nnsight.patching": [[5, "module-nnsight.patching"]], "nnsight.tracing": [[6, "module-nnsight.tracing"]], "nnsight.util": [[7, "module-nnsight.util"]], "nnsight documentation": [[8, "nnsight-documentation"]], "Getting Started": [[9, "getting-started"]], "Installation": [[9, "installation"]], "First Steps": [[9, "first-steps"]], "Tutorials": [[10, "tutorials"]], "Main Demo": [[11, "Main-Demo"]], "Loading and Running Models": [[11, "Loading-and-Running-Models"]], "Example: Logit Lens": [[11, "Example:-Logit-Lens"]], "Intervening during a forward pass": [[11, "Intervening-during-a-forward-pass"]]}, "indexentries": {"generator (class in nnsight.contexts.generator)": [[1, "nnsight.contexts.Generator.Generator"]], "runner (class in nnsight.contexts.runner)": [[1, "nnsight.contexts.Runner.Runner"]], "tracer (class in nnsight.contexts.tracer)": [[1, "nnsight.contexts.Tracer.Tracer"]], "args (nnsight.contexts.generator.generator attribute)": [[1, "nnsight.contexts.Generator.Generator.args"]], "batch_size (nnsight.contexts.generator.generator attribute)": [[1, "nnsight.contexts.Generator.Generator.batch_size"]], "blocking (nnsight.contexts.generator.generator attribute)": [[1, "nnsight.contexts.Generator.Generator.blocking"]], "generation_idx (nnsight.contexts.generator.generator attribute)": [[1, "nnsight.contexts.Generator.Generator.generation_idx"]], "graph (nnsight.contexts.generator.generator attribute)": [[1, "nnsight.contexts.Generator.Generator.graph"]], "kwargs (nnsight.contexts.generator.generator attribute)": [[1, "nnsight.contexts.Generator.Generator.kwargs"]], "model (nnsight.contexts.generator.generator attribute)": [[1, "nnsight.contexts.Generator.Generator.model"]], "module": [[1, "module-nnsight.contexts"], [1, "module-nnsight.contexts.Generator"], [1, "module-nnsight.contexts.Invoker"], [1, "module-nnsight.contexts.Runner"], [1, "module-nnsight.contexts.Tracer"], [2, "module-nnsight.intervention"], [3, "module-nnsight.models"], [3, "module-nnsight.models.AbstractModel"], [3, "module-nnsight.models.DiffuserModel"], [3, "module-nnsight.models.LanguageModel"], [4, "module-nnsight.Module"], [5, "module-nnsight.patching"], [6, "module-nnsight.tracing"], [6, "module-nnsight.tracing.Graph"], [6, "module-nnsight.tracing.Node"], [6, "module-nnsight.tracing.Proxy"], [7, "module-nnsight.util"]], "nnsight.contexts": [[1, "module-nnsight.contexts"]], "nnsight.contexts.generator": [[1, "module-nnsight.contexts.Generator"]], "nnsight.contexts.invoker": [[1, "module-nnsight.contexts.Invoker"]], "nnsight.contexts.runner": [[1, "module-nnsight.contexts.Runner"]], "nnsight.contexts.tracer": [[1, "module-nnsight.contexts.Tracer"]], "output (nnsight.contexts.generator.generator attribute)": [[1, "nnsight.contexts.Generator.Generator.output"]], "prompts (nnsight.contexts.generator.generator attribute)": [[1, "nnsight.contexts.Generator.Generator.prompts"]], "hookmodel (class in nnsight.intervention)": [[2, "nnsight.intervention.HookModel"]], "interventionproxy (class in nnsight.intervention)": [[2, "nnsight.intervention.InterventionProxy"]], "tokenindexer (class in nnsight.intervention)": [[2, "nnsight.intervention.TokenIndexer"]], "handles (nnsight.intervention.hookmodel attribute)": [[2, "nnsight.intervention.HookModel.handles"]], "input_hook (nnsight.intervention.hookmodel attribute)": [[2, "nnsight.intervention.HookModel.input_hook"]], "intervene() (in module nnsight.intervention)": [[2, "nnsight.intervention.intervene"]], "model (nnsight.intervention.hookmodel attribute)": [[2, "nnsight.intervention.HookModel.model"]], "modules (nnsight.intervention.hookmodel attribute)": [[2, "nnsight.intervention.HookModel.modules"]], "nnsight.intervention": [[2, "module-nnsight.intervention"]], "output_hook (nnsight.intervention.hookmodel attribute)": [[2, "nnsight.intervention.HookModel.output_hook"]], "save() (nnsight.intervention.interventionproxy method)": [[2, "nnsight.intervention.InterventionProxy.save"]], "shape (nnsight.intervention.interventionproxy property)": [[2, "nnsight.intervention.InterventionProxy.shape"]], "t (nnsight.intervention.interventionproxy property)": [[2, "nnsight.intervention.InterventionProxy.t"]], "token (nnsight.intervention.interventionproxy property)": [[2, "nnsight.intervention.InterventionProxy.token"]], "value (nnsight.intervention.interventionproxy property)": [[2, "nnsight.intervention.InterventionProxy.value"]], "abstractmodel (class in nnsight.models.abstractmodel)": [[3, "nnsight.models.AbstractModel.AbstractModel"]], "diffuser (class in nnsight.models.diffusermodel)": [[3, "nnsight.models.DiffuserModel.Diffuser"]], "diffusermodel (class in nnsight.models.diffusermodel)": [[3, "nnsight.models.DiffuserModel.DiffuserModel"]], "languagemodel (class in nnsight.models.languagemodel)": [[3, "nnsight.models.LanguageModel.LanguageModel"]], "alter (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.alter"]], "args (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.args"]], "config (nnsight.models.languagemodel.languagemodel attribute)": [[3, "nnsight.models.LanguageModel.LanguageModel.config"]], "custom_model (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.custom_model"]], "dispatched (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.dispatched"]], "forward() (nnsight.models.abstractmodel.abstractmodel method)": [[3, "nnsight.models.AbstractModel.AbstractModel.forward"]], "generate() (nnsight.models.abstractmodel.abstractmodel method)": [[3, "nnsight.models.AbstractModel.AbstractModel.generate"]], "kwargs (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.kwargs"]], "local_model (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.local_model"]], "local_model (nnsight.models.languagemodel.languagemodel attribute)": [[3, "nnsight.models.LanguageModel.LanguageModel.local_model"]], "meta_model (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.meta_model"]], "meta_model (nnsight.models.languagemodel.languagemodel attribute)": [[3, "nnsight.models.LanguageModel.LanguageModel.meta_model"]], "modulize() (nnsight.models.abstractmodel.abstractmodel method)": [[3, "nnsight.models.AbstractModel.AbstractModel.modulize"]], "nnsight.models": [[3, "module-nnsight.models"]], "nnsight.models.abstractmodel": [[3, "module-nnsight.models.AbstractModel"]], "nnsight.models.diffusermodel": [[3, "module-nnsight.models.DiffuserModel"]], "nnsight.models.languagemodel": [[3, "module-nnsight.models.LanguageModel"]], "repoid_path_clsname (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.repoid_path_clsname"]], "to_image() (nnsight.models.diffusermodel.diffusermodel method)": [[3, "nnsight.models.DiffuserModel.DiffuserModel.to_image"]], "tokenizer (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.tokenizer"]], "tokenizer (nnsight.models.languagemodel.languagemodel attribute)": [[3, "nnsight.models.LanguageModel.LanguageModel.tokenizer"]], "module (class in nnsight.module)": [[4, "nnsight.Module.Module"]], "input (nnsight.module.module property)": [[4, "nnsight.Module.Module.input"]], "input_shape (nnsight.module.module attribute)": [[4, "nnsight.Module.Module.input_shape"]], "input_type (nnsight.module.module attribute)": [[4, "nnsight.Module.Module.input_type"]], "module_path (nnsight.module.module attribute)": [[4, "nnsight.Module.Module.module_path"]], "nnsight.module": [[4, "module-nnsight.Module"]], "output (nnsight.module.module attribute)": [[4, "id0"], [4, "nnsight.Module.Module.output"]], "output (nnsight.module.module property)": [[4, "id1"]], "output_shape (nnsight.module.module attribute)": [[4, "nnsight.Module.Module.output_shape"]], "output_type (nnsight.module.module attribute)": [[4, "nnsight.Module.Module.output_type"]], "tracer (nnsight.module.module attribute)": [[4, "nnsight.Module.Module.tracer"]], "wrap() (nnsight.module.module static method)": [[4, "nnsight.Module.Module.wrap"]], "default_patcher (in module nnsight.patching)": [[5, "nnsight.patching.DEFAULT_PATCHER"]], "patch (class in nnsight.patching)": [[5, "nnsight.patching.Patch"]], "patcher (class in nnsight.patching)": [[5, "nnsight.patching.Patcher"]], "add() (nnsight.patching.patcher method)": [[5, "nnsight.patching.Patcher.add"]], "nnsight.patching": [[5, "module-nnsight.patching"]], "obj (nnsight.patching.patch attribute)": [[5, "nnsight.patching.Patch.obj"]], "patch() (nnsight.patching.patch method)": [[5, "nnsight.patching.Patch.patch"]], "patches (nnsight.patching.patcher attribute)": [[5, "nnsight.patching.Patcher.patches"]], "replacement (nnsight.patching.patch attribute)": [[5, "nnsight.patching.Patch.replacement"]], "restore() (nnsight.patching.patch method)": [[5, "nnsight.patching.Patch.restore"]], "graph (class in nnsight.tracing.graph)": [[6, "nnsight.tracing.Graph.Graph"]], "node (class in nnsight.tracing.node)": [[6, "nnsight.tracing.Node.Node"]], "proxy (class in nnsight.tracing.proxy)": [[6, "nnsight.tracing.Proxy.Proxy"]], "_proxy_device (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node._proxy_device"]], "add() (nnsight.tracing.graph.graph method)": [[6, "nnsight.tracing.Graph.Graph.add"]], "args (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.args"]], "argument_node_names (nnsight.tracing.graph.graph attribute)": [[6, "nnsight.tracing.Graph.Graph.argument_node_names"]], "compile() (nnsight.tracing.graph.graph method)": [[6, "nnsight.tracing.Graph.Graph.compile"]], "dependencies (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.dependencies"]], "destroy() (nnsight.tracing.node.node method)": [[6, "nnsight.tracing.Node.Node.destroy"]], "execute() (nnsight.tracing.node.node method)": [[6, "nnsight.tracing.Node.Node.execute"]], "generation_idx (nnsight.tracing.graph.graph attribute)": [[6, "nnsight.tracing.Graph.Graph.generation_idx"]], "graph (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.graph"]], "increment() (nnsight.tracing.graph.graph method)": [[6, "nnsight.tracing.Graph.Graph.increment"]], "kwargs (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.kwargs"]], "listeners (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.listeners"]], "meta (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.meta"]], "module_proxy (nnsight.tracing.graph.graph attribute)": [[6, "nnsight.tracing.Graph.Graph.module_proxy"]], "name (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.name"]], "name_idx (nnsight.tracing.graph.graph attribute)": [[6, "nnsight.tracing.Graph.Graph.name_idx"]], "nnsight.tracing": [[6, "module-nnsight.tracing"]], "nnsight.tracing.graph": [[6, "module-nnsight.tracing.Graph"]], "nnsight.tracing.node": [[6, "module-nnsight.tracing.Node"]], "nnsight.tracing.proxy": [[6, "module-nnsight.tracing.Proxy"]], "node (nnsight.tracing.proxy.proxy attribute)": [[6, "nnsight.tracing.Proxy.Proxy.node"]], "nodes (nnsight.tracing.graph.graph attribute)": [[6, "nnsight.tracing.Graph.Graph.nodes"]], "proxy() (nnsight.tracing.graph.graph method)": [[6, "nnsight.tracing.Graph.Graph.proxy"]], "proxy_class (nnsight.tracing.graph.graph attribute)": [[6, "nnsight.tracing.Graph.Graph.proxy_class"]], "proxy_device (nnsight.tracing.node.node property)": [[6, "nnsight.tracing.Node.Node.proxy_device"]], "proxy_value (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.proxy_value"]], "proxy_wrapper() (in module nnsight.tracing.proxy)": [[6, "nnsight.tracing.Proxy.proxy_wrapper"]], "rtn() (nnsight.tracing.graph.graph static method)": [[6, "nnsight.tracing.Graph.Graph.rtn"]], "target (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.target"]], "trace() (nnsight.tracing.graph.graph static method)": [[6, "nnsight.tracing.Graph.Graph.trace"]], "update() (nnsight.tracing.node.node static method)": [[6, "nnsight.tracing.Node.Node.update"]], "value (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.value"]], "wrap() (nnsight.tracing.graph.graph method)": [[6, "nnsight.tracing.Graph.Graph.wrap"]], "wrappermodule (class in nnsight.util)": [[7, "nnsight.util.WrapperModule"]], "apply() (in module nnsight.util)": [[7, "nnsight.util.apply"]], "cross_entropy_loss() (in module nnsight.util)": [[7, "nnsight.util.cross_entropy_loss"]], "fetch_attr() (in module nnsight.util)": [[7, "nnsight.util.fetch_attr"]], "forward() (nnsight.util.wrappermodule method)": [[7, "nnsight.util.WrapperModule.forward"]], "nnsight.util": [[7, "module-nnsight.util"]], "timed() (in module nnsight.util)": [[7, "nnsight.util.timed"]], "wrap() (in module nnsight.util)": [[7, "nnsight.util.wrap"]]}})