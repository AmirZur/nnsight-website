Search.setIndex({"docnames": ["documentation", "documentation/contexts", "documentation/intervention", "documentation/models", "documentation/module", "documentation/patching", "documentation/tracing", "documentation/util", "index", "start", "tutorials", "tutorials/main_demo"], "filenames": ["documentation.rst", "documentation/contexts.rst", "documentation/intervention.rst", "documentation/models.rst", "documentation/module.rst", "documentation/patching.rst", "documentation/tracing.rst", "documentation/util.rst", "index.rst", "start.rst", "tutorials.rst", "tutorials/main_demo.ipynb"], "titles": ["Documentation", "nnsight.contexts", "nnsight.intervention", "nnsight.models", "nnsight.module", "nnsight.patching", "nnsight.tracing", "nnsight.util", "nnsight", "Getting Started", "Tutorials", "Main Demo"], "terms": {"nnsight": [0, 9, 11], "model": [0, 1, 2, 4, 6, 8, 9, 10], "modul": [0, 1, 2, 3, 5, 6, 7, 8, 11], "context": [0, 2, 3, 4, 5, 8, 11], "util": 0, "intervent": [0, 1, 3, 4, 8], "trace": [0, 1, 2, 3], "patch": 0, "The": [1, 2, 3, 4, 5, 6, 11], "contain": [1, 2, 3], "logic": [1, 2], "manag": [1, 2, 3, 5], "run": [1, 3, 4, 6, 7, 10], "primari": [1, 3], "two": [1, 3], "class": [1, 2, 3, 4, 5, 6, 7], "involv": [1, 2, 6], "here": [1, 3, 11], "ar": [1, 2, 3, 4, 6, 7, 11], "tracer": [1, 4], "invok": [1, 2, 3, 4, 11], "creat": [1, 4, 6, 11], "graph": [1, 2, 3, 4, 6], "around": [1, 3], "meta_model": [1, 3], "an": [1, 2, 3, 4, 5, 6, 7, 11], "abstractmodel": [1, 3, 4], "track": [1, 3, 6, 11], "oper": [1, 3, 4, 6, 11], "perform": [1, 3, 4, 6, 7, 11], "input": [1, 2, 3, 4, 7, 11], "output": [1, 2, 3, 4, 6, 11], "said": [1, 6], "expos": 1, "attribut": [1, 2, 3, 4, 5, 6, 7], "which": [1, 3, 4, 6, 7, 11], "when": [1, 2, 3, 6], "access": [1, 2, 3, 4, 8], "ad": [1, 2, 3, 6], "comput": [1, 2, 3, 6, 7, 11], "To": [1, 9, 11], "do": [1, 2], "thi": [1, 2, 3, 4, 6, 7, 9, 11], "thei": [1, 6], "need": [1, 6, 7], "know": 1, "about": [1, 11], "current": [1, 2, 6], "object": [1, 2, 3, 4, 5, 6, 7], "so": [1, 2, 6, 11], "each": [1, 6, 11], "": [1, 2, 3, 4, 6, 7, 11], "i": [1, 2, 3, 4, 6, 7, 8, 9, 11], "set": [1, 2, 4, 6, 8], "also": [1, 3, 4, 5, 11], "keep": 1, "batch_siz": [1, 2], "most": [1, 4], "recent": [1, 4], "gener": [1, 2, 3, 4, 6], "index": [1, 2, 6, 11], "multi": [1, 3], "iter": [1, 2, 3], "all": [1, 2, 3, 4, 6, 7], "made": 1, "dure": [1, 2, 4, 6, 10], "its": [1, 3, 6, 8], "batched_input": 1, "should": [1, 2, 6, 7], "format": 1, "where": [1, 3, 6], "batch": [1, 2, 3, 7], "allow": [1, 2, 3, 6], "togeth": 1, "thing": 1, "consist": [1, 11], "If": [1, 2, 3, 6, 7, 9, 11], "differ": 1, "valid": [1, 6], "both": [1, 2, 3], "becom": [1, 11], "same": [1, 6, 7], "easi": 1, "In": [1, 3, 11], "case": [1, 3, 11], "languagemodel": [1, 3, 11], "regardless": 1, "whether": 1, "string": [1, 4, 6, 7], "prompt": [1, 3, 11], "pre": [1, 6], "process": [1, 6], "dictionari": 1, "id": [1, 3, 7, 8, 11], "onli": [1, 2, 3, 4, 6, 7, 8, 11], "On": 1, "exit": [1, 2, 11], "us": [1, 2, 3, 6, 7, 11], "inform": [1, 3, 6, 11], "provid": [1, 2], "carri": [1, 5, 6], "out": [1, 3, 5, 6, 9, 11], "execut": [1, 2, 3, 4, 6, 7, 11], "updat": [1, 2, 6, 7], "result": [1, 2, 4, 6, 11], "what": [1, 6], "actual": [1, 2, 3, 6, 11], "accept": [1, 3], "parent": [1, 6], "appropri": 1, "respect": [1, 4], "enter": [1, 3], "some": [1, 5, 6, 7, 9, 11], "leverag": [1, 3], "prepar": [1, 3, 6], "version": [1, 3, 6], "size": [1, 2, 4, 7, 11], "It": [1, 3, 6], "meta": [1, 3, 4, 6], "through": [1, 2, 3, 4, 6, 7, 11], "dtype": [1, 4], "base": [1, 2, 6], "characterist": 1, "come": 1, "implement": [1, 3, 6], "can": [1, 2, 3, 4, 6, 11], "_gener": [1, 3], "_forward": [1, 3], "method": [1, 2, 3, 6, 7, 11], "runner": [1, 3, 11], "featur": [1, 7, 8, 9], "rich": 1, "built": [1, 6], "within": [1, 3, 4, 7, 11], "add": [1, 2, 4, 5, 6], "new": [1, 6], "eventu": 1, "like": [1, 3, 8, 9, 11], "ha": [1, 3, 6, 7], "ndif": 1, "remot": 1, "server": 1, "assum": 1, "arg": [1, 2, 3, 6, 7], "bool": [1, 3, 6, 7], "fals": [1, 3, 7, 11], "block": [1, 8], "true": [1, 3, 6, 7, 11], "kwarg": [1, 3, 6, 7], "given": [1, 6, 7, 11], "_run_loc": 1, "exampl": [1, 2, 3, 4, 9, 10], "below": [1, 4], "show": [1, 4, 11], "gpt2": [1, 3, 4], "save": [1, 2, 3, 4, 11], "them": [1, 2, 3, 4, 7], "print": [1, 2, 3, 4, 7, 11], "valu": [1, 2, 3, 4, 6, 11], "after": [1, 3, 7, 11], "eiffel": [1, 2, 3, 4], "tower": [1, 2, 3, 4], "citi": [1, 2, 3, 4, 11], "hidden_st": [1, 2, 4], "lm_head": [1, 2, 3, 4], "logit": [1, 2, 3, 4, 7, 10], "zero": [1, 4, 11], "forward": [1, 3, 4, 6, 7, 10], "transform": [1, 2, 3, 4, 7, 8], "h": [1, 2, 3, 4, 7], "0": [1, 2, 3, 4, 6, 11], "otherwis": [1, 4, 6], "type": [1, 2, 3, 4, 5, 6, 7], "work": [1, 2, 11], "option": [1, 6, 7], "hang": 1, "until": [1, 11], "job": 1, "complet": [1, 2, 6, 11], "return": [1, 2, 3, 4, 6, 7, 11], "you": [1, 2, 6, 9, 11], "retriev": [1, 2, 7], "run_loc": 1, "local_model": [1, 3], "chosen": 1, "th": 1, "later": [1, 11], "posit": [1, 2, 3, 6, 11], "argument": [1, 2, 3, 6, 7], "pass": [1, 3, 4, 6, 7, 8, 10], "function": [1, 2, 3, 4, 5, 6, 7], "list": [1, 2, 3, 4, 5, 6, 11], "ani": [1, 2, 3, 5, 6, 7, 8, 11], "keyword": [1, 3, 6], "dict": [1, 3, 6, 11], "str": [1, 2, 3, 4, 6, 7], "proxi": [1, 2, 4, 6, 11], "int": [1, 3, 6], "generation_idx": [1, 6], "idx": [1, 2], "__exit__": [1, 2, 5], "scan": 1, "meant": [1, 3], "tandem": [1, 3], "initi": [1, 3, 4, 5], "post": [1, 6], "from": [1, 2, 3, 5, 6, 7, 8, 11], "_prepare_input": 1, "_scan": 1, "order": [1, 2, 3, 4, 6], "potenti": [1, 2], "well": [1, 6], "correctli": [1, 11], "free": [1, 6], "wise": 1, "mai": 1, "want": [1, 11], "turn": 1, "loop": 1, "make": [1, 2, 11], "get": [1, 4, 6, 7, 8, 11], "shape": [1, 2, 4, 6, 7, 11], "error": [1, 2, 6], "call": [1, 2, 3, 4, 5, 6, 7, 11], "have": [1, 2, 6], "first": [1, 2, 3, 4, 6, 7, 11], "default": [1, 3, 5, 6, 7], "next": 1, "increment": [1, 6], "1": [1, 3, 7, 11], "none": [1, 2, 3, 5, 6], "design": [1, 2], "subsequ": [1, 2], "appli": [1, 2, 3, 7, 9, 11], "paramet": [1, 2, 3, 4, 5, 6, 7, 11], "how": [1, 4, 9, 11], "mani": [1, 6], "onc": 1, "save_al": 1, "module_path": [1, 2, 4], "kei": [1, 2, 3, 6, 8], "interleav": [2, 3, 6], "interventionproxi": [2, 4], "extend": 2, "fx": 2, "easier": 2, "user": [2, 3, 4], "interact": [2, 3, 6], "interven": [2, 10], "entri": [2, 6], "hook": [2, 3, 4, 6, 7], "hookmodel": 2, "remov": [2, 6], "upon": 2, "input_hook": 2, "callabl": [2, 6, 7], "output_hook": 2, "regist": [2, 7], "__enter__": [2, 5], "root": [2, 3, 4, 6, 7], "torch": [2, 3, 4, 5, 6, 7, 11], "nn": [2, 3, 4, 6], "along": 2, "tupl": [2, 11], "signatur": 2, "handl": [2, 5], "removablehandl": 2, "node": [2, 4, 6], "sub": [2, 3], "addit": 2, "clone": 2, "point": [2, 6, 8], "delet": 2, "listen": [2, 6], "enabl": [2, 3, 8], "would": [2, 11], "had": 2, "thrown": 2, "token": [2, 3, 7, 11], "hidden": [2, 11], "state": [2, 3, 11], "easili": 2, "done": 2, "t": [2, 11], "collect": [2, 7], "tensor": [2, 3, 4, 6, 7], "popul": [2, 4, 6], "throw": 2, "indic": [2, 11], "properti": [2, 4, 6], "union": [2, 3, 6], "tokenindex": 2, "alia": 2, "directli": [2, 3], "second": 2, "dimens": 2, "neg": 2, "pad": [2, 11], "left": 2, "mlp": [2, 3, 4, 11], "equival": 2, "3": [2, 3, 11], "For": [2, 11], "store": [2, 6, 11], "helper": [2, 7], "aid": 2, "activ": [2, 3, 8, 11], "form": [2, 3, 6], "path": [2, 3, 4, 7], "check": [2, 3, 6, 9], "argument_node_nam": [2, 6], "exist": [2, 4], "name": [2, 3, 6], "batch_start": 2, "narrow": 2, "select": 2, "relev": [2, 11], "view": [2, 6], "oppos": 2, "copi": 2, "downstream": [2, 3, 4], "edit": 2, "origin": [2, 5, 11], "prevent": 2, "effect": 2, "bath": 2, "outsid": [2, 6], "preview": 2, "either": [2, 6], "rel": [2, 4], "denot": [2, 4], "modifi": 2, "main": [3, 10], "load": [3, 10], "wrap": [3, 4, 6, 7], "we": [3, 4, 6, 11], "huggingfac": [3, 8, 11], "repo": [3, 8, 11], "import": [3, 5, 11], "device_map": [3, 11], "cuda": [3, 11], "declar": 3, "entail": 3, "underli": [3, 11], "automodelforcausallm": 3, "unus": 3, "acceler": 3, "packag": [3, 7, 8, 9], "gpu": [3, 11], "local": 3, "encompass": 3, "displai": 3, "structur": [3, 11], "abil": 3, "itself": 3, "gpt2lmheadmodel": 3, "gpt2model": 3, "wte": 3, "embed": [3, 11], "50257": 3, "768": 3, "wpe": 3, "1024": 3, "drop": 3, "dropout": [3, 11], "p": [3, 11], "inplac": [3, 11], "modulelist": [3, 4, 11], "11": [3, 11], "12": [3, 11], "x": [3, 4, 7, 11], "gpt2block": 3, "ln_1": 3, "layernorm": [3, 11], "ep": [3, 11], "1e": [3, 11], "05": [3, 11], "elementwise_affin": [3, 11], "attn": 3, "gpt2attentionalt": 3, "c_attn": 3, "conv1d": 3, "c_proj": 3, "attn_dropout": 3, "resid_dropout": 3, "queri": 3, "wrappermodul": [3, 7], "ln_2": 3, "gpt2mlp": 3, "c_fc": 3, "act": [3, 4, 6, 11], "newgeluactiv": 3, "ln_f": 3, "linear": [3, 11], "in_featur": [3, 11], "out_featur": [3, 11], "bia": [3, 11], "determin": 3, "behavior": 3, "three": 3, "other": [3, 6], "invoc": 3, "languag": [3, 11], "over": [3, 11], "max_new_token": 3, "logits1": 3, "empir": 3, "build": 3, "logits2": 3, "direct": [3, 6, 11], "infer": 3, "see": [3, 11], "repoid_path_model": 3, "dispatch": 3, "alter": 3, "abstract": 3, "pytorch": 3, "wish": [3, 4], "gain": 3, "repoid_path_clsnam": 3, "hug": 3, "face": 3, "checkpoint": 3, "custom": 3, "bee": 3, "yet": [3, 11], "init": 3, "custom_model": 3, "wa": [3, 11], "devic": [3, 6], "ran": [3, 6], "specif": [3, 4, 11], "ultim": 3, "A": [3, 6], "simpl": [3, 7], "doc": 3, "more": [3, 6, 9, 11], "limit": 3, "amount": 3, "predict": 3, "one": [3, 4, 6, 7, 11], "node_nam": 3, "module_nam": 3, "_summary_": 3, "_description_": [3, 6], "wrapper": [3, 7], "config": 3, "file": 3, "repositori": [3, 9], "pretrainedconfig": 3, "lm": 3, "pretrainedtoken": 3, "pretrainedmodel": 3, "diffusermodel": 3, "diffus": 3, "entrypoint": 4, "interwoven": 4, "manipul": [4, 8, 9], "requir": 4, "correct": [4, 11], "tree": [4, 11], "repres": [4, 5, 6], "separ": [4, 7], "e": [4, 6, 7], "reset": [4, 6], "output_shap": 4, "nest": 4, "output_typ": 4, "input_shap": 4, "input_typ": 4, "must": [4, 6], "manual": 4, "therefor": [4, 6], "request": 4, "time": [4, 7, 11], "refer": [4, 6], "alreadi": [4, 11], "static": [4, 6], "our": [4, 11], "data": [4, 6, 7, 11], "doe": [4, 11], "default_patch": 5, "patcher": 5, "obj": 5, "replac": [5, 6], "importlib": 5, "import_modul": 5, "self": 5, "__module__": 5, "And": 5, "setattr": 5, "__name__": 5, "restor": [5, 11], "flow": 6, "AND": 6, "proxy_valu": 6, "datatyp": 6, "set_valu": 6, "bi": 6, "depend": 6, "convert": 6, "respons": 6, "similarli": 6, "ceas": 6, "destroi": 6, "memori": 6, "re": [6, 11], "remain": 6, "own": 6, "traceabl": 6, "python": 6, "magic": 6, "__torch_function__": 6, "find": 6, "shame": 6, "proxy_class": 6, "reserv": 6, "target": [6, 7], "There": 6, "singl": 6, "__init__": [6, 7], "compil": 6, "whatev": 6, "being": [6, 11], "multipl": 6, "Their": 6, "map": 6, "These": [6, 11], "kick": 6, "rtn": 6, "null": 6, "never": 6, "possibl": 6, "etc": 6, "name_idx": 6, "target_nam": 6, "number": 6, "previou": 6, "uniqu": 6, "module_proxi": 6, "pull": 6, "rais": 6, "valueerror": 6, "than": [6, 11], "final": [6, 11], "module_0": 6, "consid": [6, 11], "specifi": [6, 11], "just": 6, "_type_": 6, "desc": 6, "action": 6, "whole": 6, "_proxy_devic": 6, "log": 6, "destruct": 6, "proxy_devic": 6, "lazi": 6, "creation": 6, "proxy_upd": 6, "value1": 6, "value2": 6, "proxy_wrapp": 6, "fn": [6, 7], "problemat": 6, "sometim": 6, "throughout": 7, "element": 7, "defin": 7, "everi": 7, "overridden": 7, "subclass": 7, "although": 7, "recip": 7, "instanc": 7, "afterward": 7, "instead": 7, "sinc": [7, 11], "former": 7, "take": 7, "care": 7, "while": 7, "latter": 7, "silent": 7, "ignor": 7, "cl": 7, "member": 7, "give": [7, 11], "kind": 7, "been": 7, "cross_entropy_loss": 7, "target_id": 7, "shift": 7, "avg_batch": 7, "avg_token": 7, "cross": 7, "entropi": 7, "loss": 7, "n": 7, "last": 7, "averag": 7, "across": 7, "fetch_attr": 7, "hierarchi": 7, "level": 7, "fetch": 7, "func": 7, "lggr": 7, "decor": 7, "__class__": 7, "interpret": [8, 9], "neural": 8, "network": 8, "\u025bn": [8, 9], "sa\u026at": [8, 9], "intern": [8, 9, 11], "larg": 8, "start": [8, 11], "tutori": [8, 9], "document": 8, "integr": 8, "weight": [8, 11], "gradient": 8, "intuit": 8, "up": 8, "coupl": 8, "line": [8, 11], "code": 8, "interoper": 8, "grad": 8, "train": 8, "lora": 8, "probe": 8, "deep": 9, "learn": 9, "pip": 9, "section": 9, "colab": 9, "d": 9, "hand": [9, 11], "experi": 9, "cover": 9, "basic": 9, "demo": 10, "len": 10, "pretrain": 11, "ll": 11, "eleutherai": 11, "1b": 11, "pythia": 11, "onto": 11, "2": 11, "abov": 11, "command": 11, "download": 11, "configur": 11, "your": 11, "machin": 11, "even": 11, "though": 11, "still": 11, "inspect": 11, "gptneoxforcausallm": 11, "gpt_neox": 11, "gptneoxmodel": 11, "embed_in": 11, "50304": 11, "2048": 11, "emb_dropout": 11, "layer": 11, "15": 11, "16": 11, "gptneoxlay": 11, "input_layernorm": 11, "post_attention_layernorm": 11, "post_attention_dropout": 11, "post_mlp_dropout": 11, "attent": 11, "gptneoxattent": 11, "rotary_emb": 11, "gptneoxrotaryembed": 11, "query_key_valu": 11, "6144": 11, "dens": 11, "attention_dropout": 11, "gptneoxmlp": 11, "dense_h_to_4h": 11, "8192": 11, "dense_4h_to_h": 11, "geluactiv": 11, "final_layer_norm": 11, "embed_out": 11, "let": 11, "extract": 11, "residu": 11, "stream": 11, "4": 11, "john": 11, "mari": 11, "went": 11, "milk": 11, "last_hidden_st": 11, "now": 11, "aren": 11, "39": 11, "gptneoxtokenizerfast": 11, "pleas": 11, "note": 11, "fast": 11, "__call__": 11, "faster": 11, "encod": 11, "text": 11, "follow": 11, "13": 11, "break": 11, "down": 11, "tell": 11, "modif": 11, "detail": 11, "mean": 11, "cach": 11, "insid": 11, "desir": 11, "5": 11, "As": 11, "probabl": 11, "move": 11, "One": 11, "techniqu": 11, "treat": 11, "decod": 11, "intermedi": 11, "crude": 11, "approxim": 11, "6": 11, "def": 11, "norm": 11, "unembed": 11, "all_prob": 11, "prob": 11, "softmax": 11, "dim": 11, "append": 11, "distribut": 11, "evolv": 11, "7": 11, "plotli": 11, "express": 11, "px": 11, "mary_token": 11, "input_id": 11, "layer_prob": 11, "item": 11, "titl": 11, "accord": 11, "label": 11, "suggest": 11, "begin": 11, "realiz": 11, "confid": 11, "answer": 11, "few": 11, "pari": 11, "countri": 11, "best": 11, "guess": 11, "franc": 11, "8": 11, "chang": 11, "tok": 11, "zip": 11, "topk": 11, "10": 11, "f": 11, "3f": 11, "425": 11, "096": 11, "022": 11, "belgium": 11, "008": 11, "prov": 11, "007": 11, "luxem": 11, "saint": 11, "la": 11, "compon": 11, "wai": 11, "corrupt": 11, "represent": 11, "confus": 11, "certain": 11, "clean": 11, "caus": 11, "again": 11, "9": 11, "subject_idx": 11, "fourth": 11, "answer_token": 11, "longer": 11, "002277057385072112": 11, "all_hidden_st": 11, "record": 11, "n_layer": 11, "n_token": 11, "intervened_prob": 11, "_": 11, "rang": 11, "visual": 11, "token_id": 11, "squeez": 11, "token_label": 11, "enumer": 11, "fig": 11, "imshow": 11, "y": 11, "color_continuous_midpoint": 11, "color_continuous_scal": 11, "rdbu": 11, "causal": 11, "locat": 11, "befor": 11, "meng": 11, "et": 11, "al": 11, "2022": 11}, "objects": {"nnsight": [[1, 0, 0, "-", "contexts"], [2, 0, 0, "-", "intervention"], [3, 0, 0, "-", "models"], [4, 0, 0, "-", "module"], [5, 0, 0, "-", "patching"], [6, 0, 0, "-", "tracing"], [7, 0, 0, "-", "util"]], "nnsight.contexts": [[1, 0, 0, "-", "Invoker"], [1, 0, 0, "-", "Runner"], [1, 0, 0, "-", "Tracer"]], "nnsight.contexts.Invoker": [[1, 1, 1, "", "Invoker"]], "nnsight.contexts.Invoker.Invoker": [[1, 2, 1, "", "args"], [1, 2, 1, "", "input"], [1, 2, 1, "", "kwargs"], [1, 3, 1, "", "next"], [1, 3, 1, "", "save_all"], [1, 2, 1, "", "scan"], [1, 2, 1, "", "tracer"]], "nnsight.contexts.Runner": [[1, 1, 1, "", "Runner"]], "nnsight.contexts.Runner.Runner": [[1, 2, 1, "", "blocking"], [1, 2, 1, "", "generation"], [1, 3, 1, "", "run_local"], [1, 2, 1, "", "server"]], "nnsight.contexts.Tracer": [[1, 1, 1, "", "Tracer"]], "nnsight.contexts.Tracer.Tracer": [[1, 2, 1, "", "args"], [1, 2, 1, "", "batch_size"], [1, 2, 1, "", "batched_input"], [1, 2, 1, "", "generation_idx"], [1, 2, 1, "", "graph"], [1, 2, 1, "", "kwargs"], [1, 2, 1, "", "model"], [1, 2, 1, "", "output"]], "nnsight.intervention": [[2, 1, 1, "", "HookModel"], [2, 1, 1, "", "InterventionProxy"], [2, 1, 1, "", "TokenIndexer"], [2, 5, 1, "", "intervene"]], "nnsight.intervention.HookModel": [[2, 2, 1, "", "handles"], [2, 2, 1, "", "input_hook"], [2, 2, 1, "", "model"], [2, 2, 1, "", "modules"], [2, 2, 1, "", "output_hook"]], "nnsight.intervention.InterventionProxy": [[2, 3, 1, "", "save"], [2, 4, 1, "", "shape"], [2, 4, 1, "", "t"], [2, 4, 1, "", "token"], [2, 4, 1, "", "value"]], "nnsight.models": [[3, 0, 0, "-", "AbstractModel"], [3, 0, 0, "-", "DiffuserModel"], [3, 0, 0, "-", "LanguageModel"]], "nnsight.models.AbstractModel": [[3, 1, 1, "", "AbstractModel"]], "nnsight.models.AbstractModel.AbstractModel": [[3, 2, 1, "", "alter"], [3, 2, 1, "", "args"], [3, 2, 1, "", "custom_model"], [3, 2, 1, "", "dispatch"], [3, 2, 1, "", "dispatched"], [3, 3, 1, "", "forward"], [3, 3, 1, "", "generate"], [3, 2, 1, "", "kwargs"], [3, 2, 1, "", "local_model"], [3, 2, 1, "", "meta_model"], [3, 3, 1, "", "modulize"], [3, 2, 1, "", "repoid_path_clsname"]], "nnsight.models.DiffuserModel": [[3, 1, 1, "", "Diffuser"], [3, 1, 1, "", "DiffuserModel"]], "nnsight.models.LanguageModel": [[3, 1, 1, "", "LanguageModel"]], "nnsight.models.LanguageModel.LanguageModel": [[3, 2, 1, "", "config"], [3, 2, 1, "", "local_model"], [3, 2, 1, "", "meta_model"], [3, 2, 1, "", "tokenizer"]], "nnsight.module": [[4, 1, 1, "", "Module"]], "nnsight.module.Module": [[4, 4, 1, "", "input"], [4, 2, 1, "", "input_shape"], [4, 2, 1, "", "input_type"], [4, 2, 1, "", "module_path"], [4, 4, 1, "id1", "output"], [4, 2, 1, "", "output_shape"], [4, 2, 1, "", "output_type"], [4, 2, 1, "", "tracer"], [4, 3, 1, "", "wrap"]], "nnsight.patching": [[5, 2, 1, "", "DEFAULT_PATCHER"], [5, 1, 1, "", "Patch"], [5, 1, 1, "", "Patcher"]], "nnsight.patching.Patch": [[5, 2, 1, "", "obj"], [5, 3, 1, "", "patch"], [5, 2, 1, "", "replacement"], [5, 3, 1, "", "restore"]], "nnsight.patching.Patcher": [[5, 3, 1, "", "add"], [5, 2, 1, "", "patches"]], "nnsight.tracing": [[6, 0, 0, "-", "Graph"], [6, 0, 0, "-", "Node"], [6, 0, 0, "-", "Proxy"]], "nnsight.tracing.Graph": [[6, 1, 1, "", "Graph"]], "nnsight.tracing.Graph.Graph": [[6, 3, 1, "", "add"], [6, 2, 1, "", "argument_node_names"], [6, 3, 1, "", "compile"], [6, 2, 1, "", "generation_idx"], [6, 3, 1, "", "increment"], [6, 2, 1, "", "module_proxy"], [6, 2, 1, "", "name_idx"], [6, 2, 1, "", "nodes"], [6, 3, 1, "", "proxy"], [6, 2, 1, "", "proxy_class"], [6, 3, 1, "", "rtn"], [6, 3, 1, "", "trace"], [6, 2, 1, "", "validate"], [6, 3, 1, "", "wrap"]], "nnsight.tracing.Node": [[6, 1, 1, "", "Node"]], "nnsight.tracing.Node.Node": [[6, 2, 1, "", "_proxy_device"], [6, 2, 1, "", "args"], [6, 2, 1, "", "dependencies"], [6, 3, 1, "", "destroy"], [6, 3, 1, "", "execute"], [6, 2, 1, "", "graph"], [6, 2, 1, "", "kwargs"], [6, 2, 1, "", "listeners"], [6, 2, 1, "", "meta"], [6, 2, 1, "", "name"], [6, 4, 1, "", "proxy_device"], [6, 2, 1, "", "proxy_value"], [6, 2, 1, "", "target"], [6, 2, 1, "", "value"]], "nnsight.tracing.Proxy": [[6, 1, 1, "", "Proxy"], [6, 5, 1, "", "proxy_wrapper"]], "nnsight.tracing.Proxy.Proxy": [[6, 2, 1, "", "node"], [6, 3, 1, "", "proxy_update"]], "nnsight.util": [[7, 1, 1, "", "WrapperModule"], [7, 5, 1, "", "apply"], [7, 5, 1, "", "cross_entropy_loss"], [7, 5, 1, "", "fetch_attr"], [7, 5, 1, "", "timed"], [7, 5, 1, "", "wrap"]], "nnsight.util.WrapperModule": [[7, 3, 1, "", "forward"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute", "3": "py:method", "4": "py:property", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "method", "Python method"], "4": ["py", "property", "Python property"], "5": ["py", "function", "Python function"]}, "titleterms": {"document": 0, "nnsight": [1, 2, 3, 4, 5, 6, 7, 8], "context": 1, "intervent": 2, "model": [3, 11], "modul": 4, "patch": 5, "trace": 6, "util": 7, "get": 9, "start": 9, "instal": 9, "first": 9, "step": 9, "tutori": 10, "main": 11, "demo": 11, "load": 11, "run": 11, "exampl": 11, "logit": 11, "len": 11, "interven": 11, "dure": 11, "forward": 11, "pass": 11}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 58}, "alltitles": {"Documentation": [[0, "documentation"]], "nnsight.contexts": [[1, "module-nnsight.contexts"]], "nnsight.intervention": [[2, "module-nnsight.intervention"]], "nnsight.models": [[3, "module-nnsight.models"]], "nnsight.module": [[4, "module-nnsight.module"]], "nnsight.patching": [[5, "module-nnsight.patching"]], "nnsight.tracing": [[6, "module-nnsight.tracing"]], "nnsight.util": [[7, "module-nnsight.util"]], "nnsight": [[8, "nnsight"]], "Getting Started": [[9, "getting-started"]], "Installation": [[9, "installation"]], "First Steps": [[9, "first-steps"]], "Tutorials": [[10, "tutorials"]], "Main Demo": [[11, "Main-Demo"]], "Loading and Running Models": [[11, "Loading-and-Running-Models"]], "Example: Logit Lens": [[11, "Example:-Logit-Lens"]], "Intervening during a forward pass": [[11, "Intervening-during-a-forward-pass"]]}, "indexentries": {"invoker (class in nnsight.contexts.invoker)": [[1, "nnsight.contexts.Invoker.Invoker"]], "runner (class in nnsight.contexts.runner)": [[1, "nnsight.contexts.Runner.Runner"]], "tracer (class in nnsight.contexts.tracer)": [[1, "nnsight.contexts.Tracer.Tracer"]], "args (nnsight.contexts.invoker.invoker attribute)": [[1, "nnsight.contexts.Invoker.Invoker.args"]], "args (nnsight.contexts.tracer.tracer attribute)": [[1, "nnsight.contexts.Tracer.Tracer.args"]], "batch_size (nnsight.contexts.tracer.tracer attribute)": [[1, "nnsight.contexts.Tracer.Tracer.batch_size"]], "batched_input (nnsight.contexts.tracer.tracer attribute)": [[1, "nnsight.contexts.Tracer.Tracer.batched_input"]], "blocking (nnsight.contexts.runner.runner attribute)": [[1, "nnsight.contexts.Runner.Runner.blocking"]], "generation (nnsight.contexts.runner.runner attribute)": [[1, "nnsight.contexts.Runner.Runner.generation"]], "generation_idx (nnsight.contexts.tracer.tracer attribute)": [[1, "nnsight.contexts.Tracer.Tracer.generation_idx"]], "graph (nnsight.contexts.tracer.tracer attribute)": [[1, "nnsight.contexts.Tracer.Tracer.graph"]], "input (nnsight.contexts.invoker.invoker attribute)": [[1, "nnsight.contexts.Invoker.Invoker.input"]], "kwargs (nnsight.contexts.invoker.invoker attribute)": [[1, "nnsight.contexts.Invoker.Invoker.kwargs"]], "kwargs (nnsight.contexts.tracer.tracer attribute)": [[1, "nnsight.contexts.Tracer.Tracer.kwargs"]], "model (nnsight.contexts.tracer.tracer attribute)": [[1, "nnsight.contexts.Tracer.Tracer.model"]], "module": [[1, "module-nnsight.contexts"], [1, "module-nnsight.contexts.Invoker"], [1, "module-nnsight.contexts.Runner"], [1, "module-nnsight.contexts.Tracer"], [2, "module-nnsight.intervention"], [3, "module-nnsight.models"], [3, "module-nnsight.models.AbstractModel"], [3, "module-nnsight.models.DiffuserModel"], [3, "module-nnsight.models.LanguageModel"], [4, "module-nnsight.module"], [5, "module-nnsight.patching"], [6, "module-nnsight.tracing"], [6, "module-nnsight.tracing.Graph"], [6, "module-nnsight.tracing.Node"], [6, "module-nnsight.tracing.Proxy"], [7, "module-nnsight.util"]], "next() (nnsight.contexts.invoker.invoker method)": [[1, "nnsight.contexts.Invoker.Invoker.next"]], "nnsight.contexts": [[1, "module-nnsight.contexts"]], "nnsight.contexts.invoker": [[1, "module-nnsight.contexts.Invoker"]], "nnsight.contexts.runner": [[1, "module-nnsight.contexts.Runner"]], "nnsight.contexts.tracer": [[1, "module-nnsight.contexts.Tracer"]], "output (nnsight.contexts.tracer.tracer attribute)": [[1, "nnsight.contexts.Tracer.Tracer.output"]], "run_local() (nnsight.contexts.runner.runner method)": [[1, "nnsight.contexts.Runner.Runner.run_local"]], "save_all() (nnsight.contexts.invoker.invoker method)": [[1, "nnsight.contexts.Invoker.Invoker.save_all"]], "scan (nnsight.contexts.invoker.invoker attribute)": [[1, "nnsight.contexts.Invoker.Invoker.scan"]], "server (nnsight.contexts.runner.runner attribute)": [[1, "nnsight.contexts.Runner.Runner.server"]], "tracer (nnsight.contexts.invoker.invoker attribute)": [[1, "nnsight.contexts.Invoker.Invoker.tracer"]], "hookmodel (class in nnsight.intervention)": [[2, "nnsight.intervention.HookModel"]], "interventionproxy (class in nnsight.intervention)": [[2, "nnsight.intervention.InterventionProxy"]], "tokenindexer (class in nnsight.intervention)": [[2, "nnsight.intervention.TokenIndexer"]], "handles (nnsight.intervention.hookmodel attribute)": [[2, "nnsight.intervention.HookModel.handles"]], "input_hook (nnsight.intervention.hookmodel attribute)": [[2, "nnsight.intervention.HookModel.input_hook"]], "intervene() (in module nnsight.intervention)": [[2, "nnsight.intervention.intervene"]], "model (nnsight.intervention.hookmodel attribute)": [[2, "nnsight.intervention.HookModel.model"]], "modules (nnsight.intervention.hookmodel attribute)": [[2, "nnsight.intervention.HookModel.modules"]], "nnsight.intervention": [[2, "module-nnsight.intervention"]], "output_hook (nnsight.intervention.hookmodel attribute)": [[2, "nnsight.intervention.HookModel.output_hook"]], "save() (nnsight.intervention.interventionproxy method)": [[2, "nnsight.intervention.InterventionProxy.save"]], "shape (nnsight.intervention.interventionproxy property)": [[2, "nnsight.intervention.InterventionProxy.shape"]], "t (nnsight.intervention.interventionproxy property)": [[2, "nnsight.intervention.InterventionProxy.t"]], "token (nnsight.intervention.interventionproxy property)": [[2, "nnsight.intervention.InterventionProxy.token"]], "value (nnsight.intervention.interventionproxy property)": [[2, "nnsight.intervention.InterventionProxy.value"]], "abstractmodel (class in nnsight.models.abstractmodel)": [[3, "nnsight.models.AbstractModel.AbstractModel"]], "diffuser (class in nnsight.models.diffusermodel)": [[3, "nnsight.models.DiffuserModel.Diffuser"]], "diffusermodel (class in nnsight.models.diffusermodel)": [[3, "nnsight.models.DiffuserModel.DiffuserModel"]], "languagemodel (class in nnsight.models.languagemodel)": [[3, "nnsight.models.LanguageModel.LanguageModel"]], "alter (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.alter"]], "args (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.args"]], "config (nnsight.models.languagemodel.languagemodel attribute)": [[3, "nnsight.models.LanguageModel.LanguageModel.config"]], "custom_model (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.custom_model"]], "dispatch (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.dispatch"]], "dispatched (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.dispatched"]], "forward() (nnsight.models.abstractmodel.abstractmodel method)": [[3, "nnsight.models.AbstractModel.AbstractModel.forward"]], "generate() (nnsight.models.abstractmodel.abstractmodel method)": [[3, "nnsight.models.AbstractModel.AbstractModel.generate"]], "kwargs (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.kwargs"]], "local_model (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.local_model"]], "local_model (nnsight.models.languagemodel.languagemodel attribute)": [[3, "nnsight.models.LanguageModel.LanguageModel.local_model"]], "meta_model (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.meta_model"]], "meta_model (nnsight.models.languagemodel.languagemodel attribute)": [[3, "nnsight.models.LanguageModel.LanguageModel.meta_model"]], "modulize() (nnsight.models.abstractmodel.abstractmodel method)": [[3, "nnsight.models.AbstractModel.AbstractModel.modulize"]], "nnsight.models": [[3, "module-nnsight.models"]], "nnsight.models.abstractmodel": [[3, "module-nnsight.models.AbstractModel"]], "nnsight.models.diffusermodel": [[3, "module-nnsight.models.DiffuserModel"]], "nnsight.models.languagemodel": [[3, "module-nnsight.models.LanguageModel"]], "repoid_path_clsname (nnsight.models.abstractmodel.abstractmodel attribute)": [[3, "nnsight.models.AbstractModel.AbstractModel.repoid_path_clsname"]], "tokenizer (nnsight.models.languagemodel.languagemodel attribute)": [[3, "nnsight.models.LanguageModel.LanguageModel.tokenizer"]], "module (class in nnsight.module)": [[4, "nnsight.module.Module"]], "input (nnsight.module.module property)": [[4, "nnsight.module.Module.input"]], "input_shape (nnsight.module.module attribute)": [[4, "nnsight.module.Module.input_shape"]], "input_type (nnsight.module.module attribute)": [[4, "nnsight.module.Module.input_type"]], "module_path (nnsight.module.module attribute)": [[4, "nnsight.module.Module.module_path"]], "nnsight.module": [[4, "module-nnsight.module"]], "output (nnsight.module.module attribute)": [[4, "id0"], [4, "nnsight.module.Module.output"]], "output (nnsight.module.module property)": [[4, "id1"]], "output_shape (nnsight.module.module attribute)": [[4, "nnsight.module.Module.output_shape"]], "output_type (nnsight.module.module attribute)": [[4, "nnsight.module.Module.output_type"]], "tracer (nnsight.module.module attribute)": [[4, "nnsight.module.Module.tracer"]], "wrap() (nnsight.module.module static method)": [[4, "nnsight.module.Module.wrap"]], "default_patcher (in module nnsight.patching)": [[5, "nnsight.patching.DEFAULT_PATCHER"]], "patch (class in nnsight.patching)": [[5, "nnsight.patching.Patch"]], "patcher (class in nnsight.patching)": [[5, "nnsight.patching.Patcher"]], "add() (nnsight.patching.patcher method)": [[5, "nnsight.patching.Patcher.add"]], "nnsight.patching": [[5, "module-nnsight.patching"]], "obj (nnsight.patching.patch attribute)": [[5, "nnsight.patching.Patch.obj"]], "patch() (nnsight.patching.patch method)": [[5, "nnsight.patching.Patch.patch"]], "patches (nnsight.patching.patcher attribute)": [[5, "nnsight.patching.Patcher.patches"]], "replacement (nnsight.patching.patch attribute)": [[5, "nnsight.patching.Patch.replacement"]], "restore() (nnsight.patching.patch method)": [[5, "nnsight.patching.Patch.restore"]], "graph (class in nnsight.tracing.graph)": [[6, "nnsight.tracing.Graph.Graph"]], "node (class in nnsight.tracing.node)": [[6, "nnsight.tracing.Node.Node"]], "proxy (class in nnsight.tracing.proxy)": [[6, "nnsight.tracing.Proxy.Proxy"]], "_proxy_device (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node._proxy_device"]], "add() (nnsight.tracing.graph.graph method)": [[6, "nnsight.tracing.Graph.Graph.add"]], "args (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.args"]], "argument_node_names (nnsight.tracing.graph.graph attribute)": [[6, "nnsight.tracing.Graph.Graph.argument_node_names"]], "compile() (nnsight.tracing.graph.graph method)": [[6, "nnsight.tracing.Graph.Graph.compile"]], "dependencies (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.dependencies"]], "destroy() (nnsight.tracing.node.node method)": [[6, "nnsight.tracing.Node.Node.destroy"]], "execute() (nnsight.tracing.node.node method)": [[6, "nnsight.tracing.Node.Node.execute"]], "generation_idx (nnsight.tracing.graph.graph attribute)": [[6, "nnsight.tracing.Graph.Graph.generation_idx"]], "graph (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.graph"]], "increment() (nnsight.tracing.graph.graph method)": [[6, "nnsight.tracing.Graph.Graph.increment"]], "kwargs (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.kwargs"]], "listeners (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.listeners"]], "meta (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.meta"]], "module_proxy (nnsight.tracing.graph.graph attribute)": [[6, "nnsight.tracing.Graph.Graph.module_proxy"]], "name (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.name"]], "name_idx (nnsight.tracing.graph.graph attribute)": [[6, "nnsight.tracing.Graph.Graph.name_idx"]], "nnsight.tracing": [[6, "module-nnsight.tracing"]], "nnsight.tracing.graph": [[6, "module-nnsight.tracing.Graph"]], "nnsight.tracing.node": [[6, "module-nnsight.tracing.Node"]], "nnsight.tracing.proxy": [[6, "module-nnsight.tracing.Proxy"]], "node (nnsight.tracing.proxy.proxy attribute)": [[6, "nnsight.tracing.Proxy.Proxy.node"]], "nodes (nnsight.tracing.graph.graph attribute)": [[6, "nnsight.tracing.Graph.Graph.nodes"]], "proxy() (nnsight.tracing.graph.graph method)": [[6, "nnsight.tracing.Graph.Graph.proxy"]], "proxy_class (nnsight.tracing.graph.graph attribute)": [[6, "nnsight.tracing.Graph.Graph.proxy_class"]], "proxy_device (nnsight.tracing.node.node property)": [[6, "nnsight.tracing.Node.Node.proxy_device"]], "proxy_update() (nnsight.tracing.proxy.proxy static method)": [[6, "nnsight.tracing.Proxy.Proxy.proxy_update"]], "proxy_value (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.proxy_value"]], "proxy_wrapper() (in module nnsight.tracing.proxy)": [[6, "nnsight.tracing.Proxy.proxy_wrapper"]], "rtn() (nnsight.tracing.graph.graph static method)": [[6, "nnsight.tracing.Graph.Graph.rtn"]], "target (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.target"]], "trace() (nnsight.tracing.graph.graph static method)": [[6, "nnsight.tracing.Graph.Graph.trace"]], "validate (nnsight.tracing.graph.graph attribute)": [[6, "nnsight.tracing.Graph.Graph.validate"]], "value (nnsight.tracing.node.node attribute)": [[6, "nnsight.tracing.Node.Node.value"]], "wrap() (nnsight.tracing.graph.graph method)": [[6, "nnsight.tracing.Graph.Graph.wrap"]], "wrappermodule (class in nnsight.util)": [[7, "nnsight.util.WrapperModule"]], "apply() (in module nnsight.util)": [[7, "nnsight.util.apply"]], "cross_entropy_loss() (in module nnsight.util)": [[7, "nnsight.util.cross_entropy_loss"]], "fetch_attr() (in module nnsight.util)": [[7, "nnsight.util.fetch_attr"]], "forward() (nnsight.util.wrappermodule method)": [[7, "nnsight.util.WrapperModule.forward"]], "nnsight.util": [[7, "module-nnsight.util"]], "timed() (in module nnsight.util)": [[7, "nnsight.util.timed"]], "wrap() (in module nnsight.util)": [[7, "nnsight.util.wrap"]]}})